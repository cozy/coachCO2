!function(e){function t(t){for(var n,i,c=t[0],l=t[1],s=t[2],d=0,m=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&m.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,s||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,c=1;c<a.length;c++){var l=a[c];0!==r[l]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={1:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;o.push([3,0]),a()}({0:function(e,t){},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},2:function(e,t){},"2maa":function(e){e.exports=JSON.parse('{"nav":{"trips":"Trips","analysis":"Analysis","modes":"Modes of transport","purposes":"Purposes of travel","settings":"Settings"},"folder":{"administrative":"Administrative","coachco2":"Coach CO2"},"devices":{"select":"Select a device","label":"Data source"},"settings":{"services":"Services","debug":"Demo & debug mode"},"trips":{"default":"default","trips":"Trips","from":"Trips from","modes":{"AIR_OR_HSR":"Plane","BICYCLING_ELECTRIC":"Electric bike","BICYCLING":"Bike","BUS_ELECTRIC":"Electric bus","BUS":"Bus","CAR_ELECTRIC":"Electric car","CAR":"Car","IN_VEHICLE":"Vehicle","CARPOOL_ELECTRIC":"Electric carpooling","CARPOOL":"Carpooling","MOTO_INF_250":"Moto < 250cm3","MOTO_SUP_250":"Moto > 250cm3","SCOOTER_ELECTRIC":"Electric scooter","MOPED":"Moped","SUBWAY":"Subway","TRAIN":"Train","UNKNOWN":"Unknown","WALKING":"Walking","ON_FOOT":"Walking","RUNNING":"Running","categories":{"BICYCLING_CATEGORY":"Bike, scooter","CAR_CATEGORY":"Car, motorcycle, moped","PUBLIC_TRANSPORT_CATEGORY":"Transports en commun"}},"purposes":{"COMMUTE":"Going to or from work","WORK":"Profressional travel","SHOPPING":"Going shopping","PERSONAL_MED":"Personal travel","PICK_DROP":"Pick & drop someone","SPORT":"Going to or from sport","EXERCISE":"Physical activity / sport","ENTERTAINMENT":"Going out, leisure","TRAVEL":"Travel","OTHER_PURPOSE":"Unknown"},"duration":"Duration","distance":"Distance","calories":"Calories","co2":"CO2"},"contactToPlace":{"saveStartPlace":"Save the starting point?","saveEndPlace":"Save the arrival point?","tooltip":"To automate this categorisation in the future, save this address in a contact record","submit":"Save","delete":"Delete","cancel":"Cancel","dismiss":"No, thanks","contact":"Save as contact","label":"Label","noLabel":"No label","custom":"Customised","customLabel":"Custom label","home":"Home","work":"Work","error":"Specify which contact to save the address under","addSuccess":"The addresses have been registered","removeSuccess":"The addresses have been deleted","atHome":"At home","lat":"lat.","long":"long."},"loadMore":"Load more trips","tripEdit":{"selectMode":"Modify the transportation mode","modeTooltip":"The CO2 values in grams per kilometre (g/km) displayed may not always be representative of reality and may vary. It is important to take the CO2 values displayed with caution and to consider them as a general indication rather than an accurate representation of reality. Driving conditions, driver behaviour and other factors can lead to significant variations from the laboratory values, making it difficult to make a true comparison between different vehicles in terms of CO2 emissions.","selectPurpose":"Modify the travel purpose"},"purpose":"Reason for travel","recurring":{"title":"Recurrence","recurringTrip":"Recurring trip","occasionalTrip":"Occasional trip","confirmDialog":{"title":"Attribute this reason to similar trips?","content":"By answering yes, this trip will be defined as recurring and will be used as a reference to automate the qualification of your similar trips.","confirm":"Yes","decline":"No"},"tooltip":"If this trip is recurring, similar trips will automatically be referenced with the same reason."},"analysis":{"mode":"CO2 emissions","purpose":"CO2 emissions","travels":"%{smart_count} travel |||| %{smart_count} travel","emittedCO2":"emitted CO2"},"export":{"label":"Export","filename":"%{today} - Trips %{accountLabel}.csv","button":"Export trips in CSV","modal":{"button":{"close":"Close","viewInDrive":"View in Drive"},"title":"Exporting","content":{"done":"The \\"%{filename}\\" file was created in the \\"Drive%{pathAppDir}\\" folder of your Cozy.","progress":"The export of your trips is in progress, please wait..."}}},"emptyContent":{"welcome":{"title":"Welcome to your CO2 Coach","text":"This application is currently being tested. It will allow you to record your journeys and view your CO2 emissions.","action":"Let\'s go!"},"installKonnector":{"title":"Welcome to your CO2 Coach","text":"Before using the application, you must first install and configure the OpenPath connector in your Cozy."},"installApp":{"title":"Detect your movements\\nwith the Cozy Cloud app","text":"Install the Cozy Cloud application on your mobile phone to record all your journeys, understand their impact in terms of CO2 emissions, keep track of your journeys by bike, etc.","action":"Install the app"},"GPSStandby":{"title":"Location detected","text":"Your first travel will be posted here about two hours after you make it."},"changeAccount":{"title":"No travel","text":"No travel has yet been detected from the selected data source.","action":"Changing the data source"}},"manifest":{"short_description":"Keep track of your trips and analyze their impact on the environment.","long_description":"CoachCO2 is a self data application developed within the framework of the **territory of La Rochelle** and the [Agremob](https://agremob.com/) program.\\n\\n&nbsp;\\n\\nIts ambition is to **help you** :\\n- to **become aware of the issues** related to mobility,\\n- to **question your travel habits**,\\n- and **find more sustainable alternatives** (yes it is possible!).\\n\\nAll this in complete confidentiality, as always in your Cozy: **only you have the right to access your data**, and you have the control to share it with whomever you want, whenever and if YOU want.\\n\\nIts objective is also to **enable the emergence of new ecomobility projects or offers** thanks to the expertise of the program\'s partner structures.\\n\\n&nbsp;\\n\\nToday this application forms a duo with **the mobile application TraceMob** whose connector, also present in the store of your Personal Cloud, collects and saves your mobility tracks at home.\\n\\nTomorrow **other sensors will complete your data**. The application, itself under development, is today focused on mobility, tomorrow other sources of CO2 may extend its scope.\\n\\n&nbsp;\\n\\n[Agremob](https://agremob.com/) makes this application **a common good** that can be used beyond the borders of the La Rochelle agglomeration. If your Cozy\'s host does not offer it in its own store, contact them!","permissions":{"apps":{"description":"Required by the cozy-bar to display the icons of the apps"},"settings":{"description":"Required by the cozy-bar to display Claudy and know which applications are coming soon"},"accounts":{"description":"Required to get konnector account"},"files":{"description":"Required to access the files for saved your export of trips"},"geojson-timeseries":{"description":"Required to display geojson timeseries"},"coachco2.settings":{"description":"Used to manage your Coach CO2 settings"}}},"dacc":{"settings":{"anonymous_participation":"Participate anonymously in the calculation of average CO2 emissions","showAlerter":"Show DACC alerter"},"tripsCard":{"label":"Compare your emissions to the average of other users of the application?","discard":"No, thank you","accept":"Compare"},"compareDialog":{"title":"Compare anonymously","primaryText":"In order to average the emissions of users, and because your Cozy has made a promise to you to never disclose your data without your explicit request, it will ask you for the right to send this data.","secondaryText":"This data will be aggregated and anonymous and will not contain any identifiers or locations.","action":"I understood"},"permissionsDialog":{"title":"Request for permissions","primaryText":"The CO2 Coach application requires the following permissions from your Cozy:","secondaryText":"Once authorized, the permissions can be modified in the settings","why_asking":"Why ask me for these permissions?","export_outside":"Exporting out of Cozy","anonymized_emissions":"My anonymized CO2 emissions","anonymized_bikegoal_progression":"My anonymized progression","accept":"Always allow","refuse":"Refuse"},"reasonsDialog":{"title":"Reasons for permissions","content":"Because your Cozy has made a promise to you to never disclose your private data, it will always ask you for the right to let an application send it out."}},"vericalBarChart":{"title":"CO2 emissions","legend":{"yours":"Your emissions","average":"Average users of the app"}},"bikeGoal":{"title":"Bike to work","yearly_goal_progression":"%{days}/%{daysToReach} days \\nper year","goal_progression":"%{days}/%{daysToReach} days","my_progression":"My yearly progression","average_progression":"Avg. progress of my organisation","achievement_certificate":"Certificate of achievement","goal":"Objective","goals":"Objectives","days":"days","about":{"title":"About the goal","intro":{"title":"Introduction","content":"In order to encourage the use of alternative and sustainable modes of transport, the sustainable mobility package came into force on 10 May 2020.\\n\\nEmployees and agents who choose an alternative and sustainable mode of transport for their home-to-work journey will be able to receive a sum from their employer if the latter implements this scheme."},"how_trips_detected":{"title":"How are my trips detected?","content":"Your home-to-work journeys by bike will be automatically detected on the basis of your timetable and your speed.\\n\\nIf a journey is not automatically classified as a “Journey to and from work“, open the details of the journey and change the reason for the journey.\\n\\nIf the mode of transport for a journey is not automatically detected as “bike“, open the journey details and change the mode of transport to “bike“."},"once_goal_reach":{"title":"What to do once the goal is reached?","optional":"Last step","content":"Once you\'ve reached your target, you can congratulate yourself! You\'ll then be able to generate a certificate of honour that you can send to your employer."}},"deactivate":{"deactivate":"Deactivate","title":"Do you really want to stop participating in the goal?","content":"You can always choose to participate again from the application settings.","stop_participate":"No longer participating","cancel":"Cancel"},"alert":{"success":{"text":"Congratulations, you have achieved the “Bike to Work” goal 🎉","action":"Benefit from my %{bountyAmount}€ package"},"title":"Be part of the change: cycle to work!","text":"Track your trips and generate a certificate for your employer if they offer the Sustainable Mobility Package (SMP) bonus.","actions":{"participate":"Participate","discard":"No, thank you"}},"edit":{"modify":"Modify","title":"Modify the goal","firstname":"Firstname","lastname":"Lastname","daysToReach":"Days to reach","compare_progress":"Compare my progress with that of my organisation","cancel":"Cancel","submit":"Ok","required":"This field is required"},"settings":{"participation":"Participate to the goal “Bike to work”","showAlerter":"Bike goal: Show bike goals alerter","hideOnboarding":"Bike goal: Hide bike goal onboarding","sendToDACC":"Bike goal: activate DACC","showAlerterSuccess":"Bike goal: Show the bike goal success alert"},"onboarding":{"title":"Objective: To cycle to work","actions":{"finish":"Finish","previous":"Previous","next":"Next"},"steps":{"naming":{"title":"Lastname and firstname","nameLegend":"Fill in the following details to generate a certificate of achievement in your name:"},"daysToReach":{"title":"Set yourself a goal","legend":"Set a number of days for your home-to-work journeys by bike or scooter and track your progress with your CO2 Coach.\\n\\nOnce you\'ve reached your target, you\'ll receive an alert and a certificate of achievement to send to your employer.","error":"Set a more realistic goal. Enter a value greater than 0."},"comparison":{"comparisonLegend":"You can display the average progress of the members of your organisation %{source} who are participating in the objective. To do this, you will be asked to participate in the creation of this average.\\n\\nYour progress data will be aggregated and sent anonymously, and will not contain any identifiers or locations.","compare":"Compare my progression","doNotCompare":"Do not compare my progression"}}},"certificateGeneration":{"title":"Congratulations, you have achieved the “Bike to Work“ goal","content":"A certificate has been generated as proof of your success for the year %{year}. Forward it now by email to your employer to receive %{bountyAmount}€ !","actions":{"show":"Certificate - Bike to work.pdf","generate":"Generate a certificate","regenerate":"Generate a new certificate","understood":"Understood"}}},"geolocationTracking":{"locationRefusedDialog":{"description":"Your Cozy needs access to additional data in order to help you analyze your movements. This data will NEVER be transmitted to anyone without your explicit request.\\n\\nYou will be redirected to the app\'s settings to authorize it to ALWAYS access your phone\'s position, even when the app is not in use, and PHYSICAL ACTIVITY, movement and shape data.."},"installOpenPathKonnectorDialog":{"description":"This feature requires the OpenPath connector to be installed","cancel":"Cancel","install":"Install"},"settings":{"enable":"Memorise my journeys","sendLogs":"Send Geoloc logs","forceUploadData":"Force Upload Data","copyIdentifier":"Copy OpenPATH Identifier","createdOn":"created on"}},"Modes":{"DefaultDialog":{"primary":"Set as default transport for this category?","secondary":"The transport mode will automatically be selected as default for all future trips detected for this transport type.","actions":{"save":"Save","cancel":"Cancel"}}},"PDF":{"name":"Certificate - Cycling to work (%{year}).pdf","title":"Certificate on honor\\n of the success of the objective\\n of the Sustainable Mobility Package","date":"%{currentDateFormatted} at %{currentTimeFormatted}","recipient":"Employer : %{sourceIdentity}","paragraph01":"I, %{username}, certify on my honor that I have achieved the %{daysToReach} days sustainable mobility package objective by traveling from home to work by bike from January 1 to %{year}.","paragraph02":"In addition to this certificate, I provide my employer with any useful proof of actual use of the bicycle, such as invoice or payment statements, insurance or maintenance of my bicycle.","paragraph03":"Made to serve and assert what is right.","signature":"Signature : %{username}"}}')},3:function(e,t,a){a("MQ8b"),a("jI5P"),e.exports=a("nXPL")},4:function(e,t){},5:function(e,t){},"5z4W":function(e,t){e.exports={name:"Coach CO2",slug:"coachco2",icon:"icon.svg",categories:[],version:"0.11.0",licence:"AGPL-3.0",editor:"Cozy Cloud",source:"https://github.com/cozy/coachCO2.git@build",developer:{name:"Cozy Cloud",url:"https://cozy.io"},default_locale:"fr",langs:["fr","en"],routes:{"/":{folder:"/",index:"index.html",public:!1}},permissions:{apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},accounts:{description:"Required to get konnector account",type:"io.cozy.accounts",verbs:["GET","POST","PUT"]},konnectors:{description:"Required to create your mobility konnector account and to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.konnectors",verbs:["GET"]},triggers:{description:"Required to create your mobility konnector account and to display additional information in the viewer and for the notification service",type:"io.cozy.triggers",verbs:["GET","POST"]},files:{description:"Required to access the files for saved your export of trips",type:"io.cozy.files",verbs:["ALL"]},sharings:{description:"Required to have access to the sharings in realtime",type:"io.cozy.sharings",verbs:["ALL"]},"geojson-timeseries":{description:"Required to display geojson timeseries",type:"io.cozy.timeseries.geojson"},"coachco2.settings":{description:"Used to manage your Coach CO2 settings",type:"io.cozy.coachco2.settings",verbs:["GET","POST","PUT"]},jobs:{description:"Used in services to start other services",type:"io.cozy.jobs",verbs:["POST"]},dacc:{type:"cc.cozycloud.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized CO2 contributions"},"dacc-dev":{type:"cc.cozycloud.dacc.dev_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized CO2 contributions, for developement purposes"},contacts:{type:"io.cozy.contacts.*",verbs:["GET","POST","PUT","DELETE"],description:"Used to link contacts to geojson timeseries and sharing documents"}},services:{timeseriesWithoutAggregateMigration:{type:"node",file:"services/timeseriesWithoutAggregateMigration/coachco2.js",trigger:"@event io.cozy.timeseries.geojson:CREATED,UPDATED",debounce:"1m"},daccMonthlyCO2:{type:"node",file:"services/daccMonthlyCO2/coachco2.js",trigger:"@monthly on the 1"},daccBikeGoal:{type:"node",file:"services/daccBikeGoal/coachco2.js",trigger:"@daily"},recurringPurposes:{type:"node",file:"services/recurringPurposes/coachco2.js",trigger:"@event io.cozy.timeseries.geojson:CREATED",debounce:"2m"}}}},6:function(e,t){},7:function(e,t){},"7SaY":function(e,t,a){},"7z1u":function(e,t,a){var n={"./_lib/build_formatting_tokens_reg_exp/index.js":"5XOE","./ar/build_distance_in_words_locale/index.js":"qs6D","./ar/build_format_locale/index.js":"80pQ","./ar/index.js":"n4NV","./be/build_distance_in_words_locale/index.js":"b7Vp","./be/build_format_locale/index.js":"STnx","./be/index.js":"ka/z","./bg/build_distance_in_words_locale/index.js":"fyh8","./bg/build_format_locale/index.js":"STBG","./bg/index.js":"BBHR","./ca/build_distance_in_words_locale/index.js":"4d8B","./ca/build_format_locale/index.js":"a88X","./ca/index.js":"Nz94","./cs/build_distance_in_words_locale/index.js":"70Ht","./cs/build_format_locale/index.js":"R/Ak","./cs/index.js":"oAfY","./da/build_distance_in_words_locale/index.js":"HjC7","./da/build_format_locale/index.js":"G0Zw","./da/index.js":"CJpN","./de/build_distance_in_words_locale/index.js":"DD2N","./de/build_format_locale/index.js":"pnJo","./de/index.js":"eBmD","./el/build_distance_in_words_locale/index.js":"tFqT","./el/build_format_locale/index.js":"twcE","./el/index.js":"m1rb","./en/build_distance_in_words_locale/index.js":"bjbr","./en/build_format_locale/index.js":"EW2Y","./en/index.js":"VkMk","./eo/build_distance_in_words_locale/index.js":"ujJO","./eo/build_format_locale/index.js":"S5Gq","./eo/index.js":"nn7U","./es/build_distance_in_words_locale/index.js":"h+mB","./es/build_format_locale/index.js":"Q4jc","./es/index.js":"4yJR","./fi/build_distance_in_words_locale/index.js":"Fpie","./fi/build_format_locale/index.js":"LTnX","./fi/index.js":"G/Qn","./fil/build_distance_in_words_locale/index.js":"VRy5","./fil/build_format_locale/index.js":"syEd","./fil/index.js":"k8V/","./fr/build_distance_in_words_locale/index.js":"nJeE","./fr/build_format_locale/index.js":"DeP4","./fr/index.js":"+owv","./hr/build_distance_in_words_locale/index.js":"Fs/O","./hr/build_format_locale/index.js":"ZlNX","./hr/index.js":"Kj+b","./hu/build_distance_in_words_locale/index.js":"8okG","./hu/build_format_locale/index.js":"lk8B","./hu/index.js":"+KHA","./id/build_distance_in_words_locale/index.js":"50BR","./id/build_format_locale/index.js":"18Vb","./id/index.js":"anKN","./is/build_distance_in_words_locale/index.js":"qUeK","./is/build_format_locale/index.js":"IcCt","./is/index.js":"4QE/","./it/build_distance_in_words_locale/index.js":"PCcA","./it/build_format_locale/index.js":"V71f","./it/index.js":"qK4z","./ja/build_distance_in_words_locale/index.js":"5vSx","./ja/build_format_locale/index.js":"CAsz","./ja/index.js":"XcQu","./ko/build_distance_in_words_locale/index.js":"jKsw","./ko/build_format_locale/index.js":"UEmh","./ko/index.js":"zOJj","./mk/build_distance_in_words_locale/index.js":"fcCd","./mk/build_format_locale/index.js":"re9F","./mk/index.js":"FDmM","./nb/build_distance_in_words_locale/index.js":"aEqN","./nb/build_format_locale/index.js":"pNMw","./nb/index.js":"mR4k","./nl/build_distance_in_words_locale/index.js":"7u2d","./nl/build_format_locale/index.js":"3riD","./nl/index.js":"06P9","./pl/build_distance_in_words_locale/index.js":"rygU","./pl/build_format_locale/index.js":"july","./pl/index.js":"vOlg","./pt/build_distance_in_words_locale/index.js":"sLR+","./pt/build_format_locale/index.js":"ZP65","./pt/index.js":"vSZg","./ro/build_distance_in_words_locale/index.js":"eJyG","./ro/build_format_locale/index.js":"fLwW","./ro/index.js":"OuEP","./ru/build_distance_in_words_locale/index.js":"KjgK","./ru/build_format_locale/index.js":"Tqgg","./ru/index.js":"T3Gn","./sk/build_distance_in_words_locale/index.js":"38t1","./sk/build_format_locale/index.js":"myxh","./sk/index.js":"In70","./sl/build_distance_in_words_locale/index.js":"Mhi5","./sl/build_format_locale/index.js":"yfgk","./sl/index.js":"D9r0","./sr/build_distance_in_words_locale/index.js":"I8h+","./sr/build_format_locale/index.js":"0FXG","./sr/index.js":"lQaB","./sv/build_distance_in_words_locale/index.js":"z6xu","./sv/build_format_locale/index.js":"jmSq","./sv/index.js":"SMJc","./th/build_distance_in_words_locale/index.js":"qHE1","./th/build_format_locale/index.js":"+W4l","./th/index.js":"5DsP","./tr/build_distance_in_words_locale/index.js":"0z6Z","./tr/build_format_locale/index.js":"NK/q","./tr/index.js":"OevD","./zh_cn/build_distance_in_words_locale/index.js":"SBqD","./zh_cn/build_format_locale/index.js":"219J","./zh_cn/index.js":"QhI5","./zh_tw/build_distance_in_words_locale/index.js":"7Fp2","./zh_tw/build_format_locale/index.js":"l09L","./zh_tw/index.js":"TDp1"};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id="7z1u"},8:function(e,t){},"8Bbg":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return r}));var n=Boolean(window.location.hostname.endsWith("cozy.localhost")||window.location.hostname.endsWith("cozy.tools"));function r(t){if("serviceWorker"in navigator){if(new URL(e.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="/service-worker.js";n?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):o(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):o(e,t)}))}}function o(e,t){navigator.serviceWorker.register(e).then((function(e){e.update()})).catch((function(e){console.error("Error during service worker registration:",e)}))}}).call(this,a("JtWf"))},"8IOV":function(e,t,a){e.exports={"cozy-leaflet-markers":"cozy-leaflet-markers--3tOnD","cozy-leaflet-markers-end":"cozy-leaflet-markers-end--G0e6q","cozy-leaflet-markers-start":"cozy-leaflet-markers-start--1JdEL"}},9:function(e,t){},DZbK:function(e,t,a){e.exports=a.p+"Courgette.ttf"},Ev3x:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"j",(function(){return c})),a.d(t,"h",(function(){return l})),a.d(t,"c",(function(){return s})),a.d(t,"i",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return m}));var n="io.cozy.apps",r="io.cozy.files",o="io.cozy.timeseries.geojson",i="io.cozy.accounts",c="io.cozy.coachco2.settings",l="io.cozy.jobs",s="io.cozy.contacts",u="io.cozy.konnectors",d="cc.cozycloud.dacc_v2",m="cc.cozycloud.dacc.dev_v2";t.k={timeseries:{doctype:o,attributes:{},relationships:{startPlaceContact:{type:"has-one",doctype:s},endPlaceContact:{type:"has-one",doctype:s}}},files:{doctype:r,attributes:{},relationships:{}},settings:{doctype:c,attributes:{},relationships:{}}}},Hsuv:function(e){e.exports=JSON.parse('{"nav":{"trips":"Déplacements","analysis":"Analyses","modes":"Modes de transport","purposes":"Motifs de déplacement","settings":"Paramètres"},"folder":{"administrative":"Administratif","coachco2":"Coach CO2"},"devices":{"select":"Sélectionnez un appareil","label":"Source des données"},"settings":{"services":"Services","debug":"Mode démo & débug"},"trips":{"trips":"Déplacements","from":"Déplacements de","modes":{"default":"défaut","AIR_OR_HSR":"Avion","BICYCLING_ELECTRIC":"Vélo électrique","BICYCLING":"Vélo","BUS_ELECTRIC":"Bus électrique","BUS":"Bus","CAR_ELECTRIC":"Voiture électrique","CAR":"Voiture","IN_VEHICLE":"Véhicule","CARPOOL_ELECTRIC":"Covoiturage électrique","CARPOOL":"Covoiturage","MOTO_INF_250":"Moto < 250cm3","MOTO_SUP_250":"Moto > 250cm3","SCOOTER_ELECTRIC":"Trottinette électrique","MOPED":"Cyclomoteur","SUBWAY":"Métro","TRAIN":"Train","UNKNOWN":"Non reconnu","WALKING":"Marche","ON_FOOT":"Marche","RUNNING":"Course","categories":{"BICYCLING_CATEGORY":"Vélo, trotinette","CAR_CATEGORY":"Voiture, moto, scooter","PUBLIC_TRANSPORT_CATEGORY":"Transports en commun"}},"purposes":{"COMMUTE":"Aller-retour au travail","WORK":"Déplacement professionel","SHOPPING":"Aller faire les courses","PERSONAL_MED":"Déplacement personnel","PICK_DROP":"Déposer quelqu\'un","SPORT":"Aller-retour au sport","EXERCISE":"Activité physique / sportive","ENTERTAINMENT":"Sortie, loisirs","TRAVEL":"Voyage","OTHER_PURPOSE":"Indéfini"},"duration":"Durée","distance":"Distance","calories":"Calories","co2":"CO2"},"contactToPlace":{"saveStartPlace":"Enregistrer le point de départ ?","saveEndPlace":"Enregistrer le point d\'arrivée ?","tooltip":"Pour automatiser cette catégorisation à l\'avenir, enregistrer cette adresse dans une fiche contact","submit":"Enregistrer","delete":"Supprimer","cancel":"Annuler","dismiss":"Non, merci","contact":"Enregistrer dans une fiche contact","label":"Libellé","noLabel":"Aucun libellé","custom":"Personnalisé","customLabel":"Libellé personnalisé","home":"Domicile","work":"Travail","error":"Préciser sous quel contact enregistrer l\'adresse","addSuccess":"Les adresses ont bien été enregistrées","removeSuccess":"Les adresses ont bien été supprimées","atHome":"Chez moi","lat":"lat.","long":"long."},"loadMore":"Charger plus de trajets","tripEdit":{"selectMode":"Modifier le mode de transport","modeTooltip":"Les valeurs de CO2 en grammes par kilomètre (g/km) affichées peuvent parfois ne pas être représentatives de la réalité et peuvent varier. Il est important de prendre les valeurs de CO2 affichées avec précaution et de les considérer comme une indication générale plutôt qu\'une représentation précise de la réalité. Les conditions de conduite, le comportement du conducteur et d\'autres facteurs peuvent entraîner des variations significatives par rapport aux valeurs de laboratoire, ce qui rend difficile la comparaison réelle entre différents véhicules en termes d\'émissions de CO2.","selectPurpose":"Modifier le motif du déplacement"},"purpose":"Motif du déplacement","recurring":{"title":"Récurrence","recurringTrip":"Déplacement habituel","occasionalTrip":"Déplacement occasionnel","confirmDialog":{"title":"Attribuer ce motif aux déplacements similaires ?","content":"En répondant oui, ce déplacement sera défini comme habituel et servira de référence pour automatiser la qualification de vos déplacement similaires.","confirm":"Oui","decline":"Non"},"tooltip":"Si ce déplacement est habituel, les déplacements similaires seront automatiquement référencés avec le même motif."},"analysis":{"mode":"Émissions de CO2","purpose":"Émissions de CO2","travels":"%{smart_count} déplacement |||| %{smart_count} déplacements","emittedCO2":"CO2 émis"},"export":{"label":"Export","filename":"%{today} - Déplacements %{accountLabel}.csv","button":"Exporter les déplacements en CSV","modal":{"button":{"close":"Fermer","viewInDrive":"Voir dans Drive"},"title":"Exportation","content":{"done":"Le fichier \\"%{filename}\\" a été créé dans le dossier \\"Drive%{pathAppDir}\\" de votre Cozy.","progress":"L’export de vos déplacements est en cours, merci de patienter..."}}},"emptyContent":{"welcome":{"title":"Bienvenue sur votre Coach CO2","text":"Cette application est en phase expérimentale. Elle vous permettra d\'enregistrer vos déplacements et de visualiser vos émissions de CO2.","action":"C\'est parti !"},"installKonnector":{"title":"Bienvenue sur votre Coach CO2","text":"Avant d\'utiliser l\'application, vous devez tout d\'abord installer et configurer le connecteur OpenPath dans votre Cozy."},"installApp":{"title":"Détecter vos déplacements\\navec l\'app Cozy Cloud","text":"Installer l\'application Cozy Cloud sur votre mobile pour enregistrer tous vos déplacements, en comprendre l\'impact en émission de CO2, comptabiliser vos trajets en vélo, etc.","action":"Installer l\'app"},"GPSStandby":{"title":"Localisation détectée","text":"Votre premier trajet sera affichés ici environ deux heures après que vous l\'ayez effectué."},"changeAccount":{"title":"Aucun déplacement","text":"Aucun déplacement n’a encore été détecté depuis la source de données sélectionnée.","action":"Changer la source de données"}},"manifest":{"short_description":"Conservez l\'historique de vos déplacements et analysez leurs impacts sur l\'environnement.","long_description":"CoachCO2 est une application de self data développée dans le cadre du **territoire de la Rochelle** et du programme [Agremob](https://agremob.com/).\\n\\n&nbsp;\\n\\nElle a pour ambition de **vous aider** :\\n- à **prendre conscience des enjeux** liés à la mobilité,\\n- à **questionner vos habitudes** de déplacements,\\n- et **trouver des alternatives** plus durables (oui c’est possible !).\\n\\nCeci en toute confidentialité, comme toujours dans votre Cozy : **vous êtes le seul à avoir le droit d\'accéder à vos données**, et vous avez le contrôle de les partager avec qui vous vous voulez, quand et si VOUS le souhaitez.\\n\\nSon objectif est aussi de **permettre l’émergence de nouveaux projets ou offres d’écomobilité** grâce à l’expertise de structures partenaires du programme.\\n\\n&nbsp;\\n\\nAujourd\'hui cette application forme un duo avec **l\'application mobile TraceMob** dont le connecteur, présent aussi dans le store de votre Cloud Personnel, collecte et sauvegarde vos traces de mobilité chez vous.\\n\\nDemain **d\'autres capteurs compléteront vos données**. L\'application, elle-même en cours de développement, est aujourd\'hui tournée vers la mobilité, demain d\'autres sources de CO2 pourront étendre son champ d\'action.\\n\\n&nbsp;\\n\\n[Agremob](https://agremob.com/) fait de cette application **un bien commun** utilisable au-delà des frontières de l\'agglomération de la Rochelle. Si l\'hébergeur de votre Cozy ne la propose pas dans son propre store, contactez-le !","permissions":{"apps":{"description":"Utilisé par la cozy-bar pour afficher les icônes des applications"},"settings":{"description":"Utilisé par le cozy-bar pour afficher Claudy et savoir quelles applications sont à venir"},"accounts":{"description":"Utilisé pour obtenir un compte konnector"},"files":{"description":"Utilisé pour accéder aux fichiers de sauvegarde de votre exportation de voyages"},"geojson-timeseries":{"description":"Utilisé pour afficher les séries temporelles geojson"},"coachco2.settings":{"description":"Utilisé pour gérer les paramètres de votre Coach CO2"}}},"dacc":{"settings":{"anonymous_participation":"Participer anonymement au calcul des émissions moyennes de CO2","showAlerter":"Emission CO2 : afficher l\'alerter DACC sur la homepage"},"tripsCard":{"label":"Comparez vos émissions à la moyenne des autres utilisateurs de l’application ?","discard":"Non, merci","accept":"Comparer"},"compareDialog":{"title":"Comparez-vous anonymement","primaryText":"Afin de constituer la moyenne des émissions des utilisateurs, et parce que votre Cozy vous a fait la promesse de ne jamais divulguer vos données sans votre demande explicite, il va vous demander le droit d\'envoyer cette donnée.","secondaryText":"Ces données seront agrégées et anonymes, elles ne contiendront aucun identifiant ni lieux.","action":"J\'ai compris"},"permissionsDialog":{"title":"Demande de permissions","primaryText":"L’application Coach CO2 demande les permissions suivantes à votre Cozy :","secondaryText":"Une fois autorisées, les permissions pourront être modifiées dans les paramètres","why_asking":"Pourquoi me demander ces permissions ?","export_outside":"Exporter hors du Cozy","anonymized_emissions":"Mes émissions de CO2 anonymisées","anonymized_bikegoal_progression":"Ma progression de façon anonyme","accept":"Toujours autoriser","refuse":"Refuser"},"reasonsDialog":{"title":"Motifs de permissions","content":"Parce que votre Cozy vous a fait la promesse de ne jamais divulguer vos données privées, il vous demandera toujours le droit de laisser une application les envoyer à l\'extérieur."}},"vericalBarChart":{"title":"Émissions de CO2","legend":{"yours":"Vos émissions","average":"Moyennes des utilisateurs de l\'app"}},"bikeGoal":{"title":"Aller au travail à vélo","yearly_goal_progression":"%{days}/%{daysToReach} jours \\npar an","goal_progression":"%{days}/%{daysToReach} jours","my_progression":"Ma progression annuelle","average_progression":"Progression moy. de mon organisation","achievement_certificate":"Attestation de réussite","goal":"Objectif","goals":"Objectifs","days":"jours","about":{"title":"À propos de l’objectif","intro":{"title":"Introduction","content":"Afin d’encourager le recours à des modes de transports alternatifs et durables, la mise en œuvre du forfait mobilités durables est entré en vigueur le 10 mai 2020.\\n\\nAinsi les collaborateurs et agent qui font le choix d\'un mode de transport alternatif et durable pour leur trajet domicile-travail pourront recevoir une somme de leur employeur si celui-ci met en place ce dispositif."},"how_trips_detected":{"title":"Comment sont détectés mes trajets ?","content":"Vos trajets domicile-travail à vélo seront automatiquement détectés à partir de vos horaires et de votre vitesse.\\n\\nSi un trajet n’est pas automatiquement qualifié en “Aller-retour au travail”, ouvrez le détail du trajet et modifiez le motif du déplacement.\\n\\nSi le mode de transport d’un trajet n’est pas automatiquement détecté en “vélo”, ouvrez le détail du trajet et modifiez le mode de transport en “vélo”."},"once_goal_reach":{"title":"Que faire une fois l’objectif atteint ?","optional":"Dernière étape","content":"Une fois l\'objectif atteint, vous pourrez vous en féliciter ! Et il vous sera alors possible de générer une attestation sur l\'honneur que vous pourrez transmettre à votre employeur."}},"deactivate":{"deactivate":"Désactiver","title":"Souhaitez-vous vraiment ne plus participer à l’objectif ?","content":"Vous pourrez toujours choisir d’y participer à nouveau depuis les paramètres de l’application.","stop_participate":"Ne plus participer","cancel":"Annuler"},"alert":{"success":{"text":"Félicitations, vous avez atteint l’objectif “Aller travailler à vélo” 🎉","action":"Bénéficier de mon forfait de %{bountyAmount}€"},"title":"Soyez acteur du changement, allez travailler à vélo !","text":"Suivez vos trajets et générez une attestation à destination de votre employeur s\'il propose la prime Forfait Mobilité Durable (FMD).","actions":{"participate":"Participer","discard":"non, merci"}},"edit":{"modify":"Modifier","title":"Modifier l\'objectif","firstname":"Prénom","lastname":"Nom","daysToReach":"Objectif à atteindre","compare_progress":"Comparer ma progression avec celle de mon organisation","cancel":"Annuler","submit":"Ok","required":"Ce champ est obligatoire"},"settings":{"participation":"Participer à l\'objectif “Aller au travail à vélo”","showAlerter":"Objectif vélo : afficher l\'infobulle de participation sur la homepage","hideOnboarding":"Objectif vélo : masquer l\'onboarding","sendToDACC":"Objectif vélo : activer le DACC","showAlerterSuccess":"Objectif vélo : forcer l\'affichage de l\'alerte de succès sur la homepage"},"onboarding":{"title":"Objectif : Aller travailler à vélo","actions":{"finish":"Terminer","previous":"Précédent","next":"Suivant"},"steps":{"naming":{"title":"Nom et prénom","nameLegend":"Renseigner les informations suivantes afin de générer l’attestation de réussite à votre nom :"},"daysToReach":{"title":"Fixez-vous un objectif","legend":"Définissez un nombre de jours à vélo ou trottinette pour vos trajets domicile-travail et suivez votre avancement avec votre Coach CO2.\\n\\nUne fois votre objectif atteint, vous recevrez une alerte ainsi qu’une attestation de réussite à transmettre à votre employeur.","error":"Définissez un objectif plus réaliste. Entrer une valeur supérieure à 0."},"comparison":{"comparisonLegend":"Il vous est possible d’afficher la progression moyenne des membres de votre organisation %{source} qui participent à l’objectif. Pour cela, il vous sera demandé de participer également à la constitution de cette moyenne.\\n\\nVos données de progression seront agrégées et envoyées anonymement, elles ne contiendront aucun identifiant ni lieux.","compare":"Comparer ma progression","doNotCompare":"Ne pas comparer ma progression"}}},"certificateGeneration":{"title":"Félicitations, vous avez atteint l’objectif “Aller travailler à vélo”","content":"Une attestation a été générée pour attester de votre succès pour l’année %{year}. Transférez-la dès maintenant par email à votre employeur pour recevoir %{bountyAmount}€ !","actions":{"show":"Certificat - Aller travailler à vélo.pdf","generate":"Générer une attestation","regenerate":"Générer une nouvelle attestation","understood":"J\'ai compris"}}},"geolocationTracking":{"locationRefusedDialog":{"description":"Votre Cozy a besoin d\'accéder à des données supplémentaires afin de vous aider à analyser vos déplacements. Elles ne seront JAMAIS transmises à qui que ce soit sans votre demande explicite.\\n\\nVous allez être redirigé vers les paramètres de l\'app afin de l\'autoriser à TOUJOURS accéder à la position de votre téléphone, donc aussi lorsque l\'app n\'est pas utilisée, et au données d\'ACTIVITÉ PHYSIQUE, mouvements et formes."},"installOpenPathKonnectorDialog":{"description":"Cette fonctionnalité demande l\'installation du connecteur OpenPath","cancel":"Annuler","install":"Installer"},"settings":{"enable":"Mémoriser mes déplacements","sendLogs":"Envoyer les logs de Geoloc","forceUploadData":"Forcer l\'upload des données","copyIdentifier":"Copier l\'identifiant OpenPATH","createdOn":"créé le"}},"Modes":{"DefaultDialog":{"primary":"Définir comme transport par défaut pour cette catégorie ?","secondary":"Le mode de transport sera automatiquement sélectionné comme par défaut pour tous les futurs trajets détectés pour ce type de transport.","actions":{"save":"Enregistrer","cancel":"Annuler"}}},"PDF":{"name":"Attestation - Aller travailler à vélo (%{year}).pdf","title":"Attestation sur l\'honneur\\n de le réussite de l\'objectif\\n du forfait mobilités durables","date":"Le %{currentDateFormatted} à %{currentTimeFormatted}","recipient":"Employeur : %{sourceIdentity}","paragraph01":"Je soussigné(e) %{username} certifie sur l’honneur avoir atteint l\'objectif forfait mobilités durables de %{daysToReach} jours en effectuant mes déplacements du domicile vers mon travail en vélo du 1er janvier au 31 décembre %{year}.","paragraph02":"En plus de cette attestation, je tiens à disposition de mon employeur tout justificatif utile d\'utilisation effective du vélo comme les relevés de facture ou de paiement, d’assurances ou d’entretien de mon vélo.","paragraph03":"Fait pour servir et valoir ce que de droit.","signature":"Signature : %{username}"}}')},IvPY:function(e,t,a){"use strict";a.d(t,"f",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"j",(function(){return o})),a.d(t,"k",(function(){return i})),a.d(t,"m",(function(){return c})),a.d(t,"n",(function(){return l})),a.d(t,"v",(function(){return s})),a.d(t,"w",(function(){return u})),a.d(t,"q",(function(){return d})),a.d(t,"r",(function(){return m})),a.d(t,"W",(function(){return p})),a.d(t,"Y",(function(){return f})),a.d(t,"kb",(function(){return b})),a.d(t,"U",(function(){return v})),a.d(t,"tb",(function(){return g})),a.d(t,"vb",(function(){return y})),a.d(t,"yb",(function(){return h})),a.d(t,"Ab",(function(){return E})),a.d(t,"H",(function(){return O})),a.d(t,"Z",(function(){return j})),a.d(t,"ib",(function(){return C})),a.d(t,"h",(function(){return x})),a.d(t,"t",(function(){return w})),a.d(t,"gb",(function(){return k})),a.d(t,"Cb",(function(){return _})),a.d(t,"y",(function(){return D})),a.d(t,"lb",(function(){return P})),a.d(t,"wb",(function(){return T})),a.d(t,"bb",(function(){return S})),a.d(t,"E",(function(){return M})),a.d(t,"rb",(function(){return A})),a.d(t,"D",(function(){return N})),a.d(t,"cb",(function(){return L})),a.d(t,"ab",(function(){return R})),a.d(t,"G",(function(){return F})),a.d(t,"Bb",(function(){return I})),a.d(t,"fb",(function(){return B})),a.d(t,"eb",(function(){return G})),a.d(t,"db",(function(){return z})),a.d(t,"c",(function(){return q})),a.d(t,"mb",(function(){return Z})),a.d(t,"J",(function(){return U})),a.d(t,"e",(function(){return Q})),a.d(t,"d",(function(){return H})),a.d(t,"b",(function(){return Y})),a.d(t,"l",(function(){return V})),a.d(t,"V",(function(){return W})),a.d(t,"X",(function(){return K})),a.d(t,"s",(function(){return J})),a.d(t,"u",(function(){return X})),a.d(t,"p",(function(){return $})),a.d(t,"o",(function(){return ee})),a.d(t,"g",(function(){return te})),a.d(t,"i",(function(){return ae})),a.d(t,"jb",(function(){return ne})),a.d(t,"T",(function(){return re})),a.d(t,"zb",(function(){return oe})),a.d(t,"xb",(function(){return ie})),a.d(t,"C",(function(){return ce})),a.d(t,"R",(function(){return le})),a.d(t,"Q",(function(){return se})),a.d(t,"P",(function(){return ue})),a.d(t,"S",(function(){return de})),a.d(t,"qb",(function(){return me})),a.d(t,"K",(function(){return pe})),a.d(t,"F",(function(){return fe})),a.d(t,"N",(function(){return be})),a.d(t,"M",(function(){return ve})),a.d(t,"L",(function(){return ge})),a.d(t,"O",(function(){return ye})),a.d(t,"pb",(function(){return he})),a.d(t,"ob",(function(){return Ee})),a.d(t,"nb",(function(){return Oe})),a.d(t,"x",(function(){return je})),a.d(t,"B",(function(){return Ce})),a.d(t,"z",(function(){return xe})),a.d(t,"A",(function(){return we})),a.d(t,"ub",(function(){return ke})),a.d(t,"I",(function(){return _e})),a.d(t,"hb",(function(){return De})),a.d(t,"sb",(function(){return Pe}));var n="coachco2",r="AIR_OR_HSR",o="BICYCLING_ELECTRIC",i="BICYCLING",c="BUS_ELECTRIC",l="BUS",s="CAR_ELECTRIC",u="CAR",d="CARPOOL_ELECTRIC",m="CARPOOL",p="MOTO_INF_250",f="MOTO_SUP_250",b="SCOOTER_ELECTRIC",v="MOPED",g="SUBWAY",y="TRAIN",h="UNKNOWN",E="WALKING",O="IN_VEHICLE",j="ON_FOOT",C="RUNNING",x={name:"BICYCLING_CATEGORY",modes:[i,o,b]},w={name:"CAR_CATEGORY",modes:[u,s,m,d,p,f,v]},k={name:"PUBLIC_TRANSPORT_CATEGORY",modes:[l,c,y,g]},_="WORK",D="COMMUTE",P="SHOPPING",T="TRAVEL",S="PERSONAL_MED",M="EXERCISE",A="SPORT",N="ENTERTAINMENT",L="PICK_DROP",R="OTHER_PURPOSE",F="home",I="work",B=.258,G=.187,z=.152,q=[B,G,z],Z=1e3,U=3500,Q=[.00173,.00529,.0248],H=[.0025,.0022,.0041,.00472,.00298],Y=[.146,.137,.129],V=.0217,W=.0604,K=.165,J=.192,X=.0198,$=.0099,ee=.096,te=0,ae=0,ne=0,re=.064,oe=0,ie=0,ce=74.25,le=2,se=3.5,ue=5,de=7,me=3,pe=5,fe=6.5,be=5.8,ve=8,ge=10,ye=15.8,he=15,Ee=22.4,Oe=25.6,je={tripId:"Trip_Id",tripStartDisplayName:"Trip_Start_Display_Name",tripArrivalDisplayName:"Trip_Arrival_Display_Name",tripPurpose:"Trip_Purpose",tripStartDate:"Trip_Start_Date",tripEndDate:"Trip_End_Date",sectionStartDate:"Section_Start_Date",sectionEndDate:"Section_End_Date",sectionDuration:"Section_Duration",sectionDistance:"Section_Distance",sectionMode:"Section_Mode",sectionCoordinates:"Section_Coordinates",sectionDistances:"Section_Distances",sectionTimestamps:"Section_Timestamps",sectionSpeeds:"Section_Speeds"},Ce="co2-emissions-monthly",xe=Object.freeze({is_tracemob_expe:!0}),we="bike-goal-yearly",ke="timeseriesWithoutAggregateMigration",_e=12,De="recurringPurposes",Pe=50},J3iu:function(e,t){e.exports="/img/icon.aa5e3ec7c4ab374b229f92d96f796ca6.svg"},"PG+o":function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var n=a("HZZ/"),r=a.n(n),o=a("hJxD"),i=a.n(o),c=a("IvPY"),l=a("Ev3x"),s=(a("8XZk"),function(){var e=r()(i.a.mark((function e(t,a){var n,r,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},r=n.fields,e.next=3,t.collection(l.h).create("service",{name:a,slug:c.f,fields:r});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())}).call(this,a("JtWf"))},VDMD:function(e,t){e.exports="/img/background.ada7027117d5bc0de6d2c11f52c6e096.png"},eUFy:function(e,t,a){var n={"./en":"2maa","./en.json":"2maa","./fr":"Hsuv","./fr.json":"Hsuv"};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id="eUFy"},iC3e:function(e,t,a){var n={"./en.json":"5dwM","./fr.json":"eW7n","./nl_NL.json":"w7vk"};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id="iC3e"},kyG8:function(e,t,a){e.exports={"CertificateGeneration-root":"CertificateGeneration-root--wWT2w"}},nXPL:function(e,t,a){"use strict";a.r(t);a("k37E"),a("QLHQ"),a("7SaY");var n=a("ivGQ"),r=a.n(n),o=a("iOQm"),i=a("UdSB"),c=a.n(i),l=a("XkwL"),s=a.n(l),u=a("J58c"),d=a.n(u),m=a("Ev3x");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b=function(e){var t=e.client,a=e.setting,n=e.account;return t.save(f(f({},a),{},{account:n,_type:m.j}))},v=function(e){var t,a=null==e||null===(t=e.aggregation)||void 0===t?void 0:t.sections;if(!a)return e;var n=a.sort((function(e,t){return new Date(e.startDate).getTime()-new Date(t.startDate).getTime()})),r=f({},e);return r.aggregation.sections=n,r},g=a("xEu0"),y=a.n(g),h=function(e,t,a){var n=Object(g.useClient)();if(e.isLoading||t.isLoading)return null;if(null===a){var r=e.data[0];if(r)return r.account;var o=t.data[0];return o?(b({client:n,setting:r,account:o}),o):null}return a},E=a("HZZ/"),O=a.n(E),j=a("hJxD"),C=a.n(j),x=a("L7Xp"),w=a("0d4v"),k=a("rfej"),_=a("6aJT"),D=a("HmmB"),P=a("IvPY");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var M=function(e){var t=e.accountId,a=e.limitBy;return{definition:Object(g.Q)(m.g).where({"cozyMetadata.sourceAccount":t}).partialIndex({aggregation:{$exists:!0}}).select(["cozyMetadata.sourceAccount","startDate","endDate","aggregation"]).indexFields(["cozyMetadata.sourceAccount","startDate","endDate"]).sortBy([{"cozyMetadata.sourceAccount":"desc"},{startDate:"desc"},{endDate:"desc"}]).limitBy(a),options:{as:"".concat(m.g,"/sourceAccount/").concat(t,"/limitedBy/").concat(a),fetchPolicy:y.a.fetchPolicies.olderThan(3e4)}}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.limit,r=void 0===n?1e3:n,o=Object(k.a)(e)||null,i=Object(x.a)(e)||null,c=e?"".concat(o.getFullYear(),"-").concat(o.getMonth()):"noDate",l=Object(g.Q)(m.g).where(S({"cozyMetadata.sourceAccount":t},e&&{startDate:{$gte:o.toISOString(),$lte:i.toISOString()}})).partialIndex({aggregation:{$exists:!0}}).select(["aggregation","cozyMetadata.sourceAccount","startDate","endDate"]).indexFields(["cozyMetadata.sourceAccount","startDate"]).limitBy(r);return{definition:l,options:{as:"".concat(m.g,"/sourceAccount/").concat(t,"/date/").concat(c,"/limitedBy/").concat(r),fetchPolicy:y.a.fetchPolicies.olderThan(3e4),enabled:Boolean(e)&&Boolean(t)}}},N=function(e,t){var a=e.accountId,n=e.date,r=void 0===n?null:n,o={"cozyMetadata.sourceAccount":a};if(r){var i=Object(_.a)(new Date(r)).toISOString(),c=Object(w.a)(new Date(r)).toISOString();o.startDate={$gte:i,$lte:c}}else o.startDate={$gt:null};return{definition:Object(g.Q)(m.g).where(o).partialIndex({"aggregation.purpose":P.y,"aggregation.modes":{$in:[P.k,P.j,P.kb]}}).select(["startDate","endDate","aggregation","aggregation.modes","aggregation.purpose","cozyMetadata.sourceAccount"]).indexFields(["cozyMetadata.sourceAccount","startDate"]).sortBy([{"cozyMetadata.sourceAccount":"desc"},{startDate:"desc"}]).limitBy(1e3),options:{as:"".concat(m.g,"/sourceAccount/").concat(a,"/BikeCommute/"),fetchPolicy:y.a.fetchPolicies.olderThan(1e8),enabled:t}}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.limit,a=void 0===t?100:t,n=e.withOnlyLogin,r=void 0===n||n,o=Object(g.Q)(m.a).partialIndex({account_type:{$or:["tracemob","openpath"]}}).limitBy(a);return r&&o.select(["auth.login","account_type"]),{definition:o,options:{as:"".concat(m.a,"/account_type/limitedBy/").concat(a,"/withOnlyLogin/").concat(r),fetchPolicy:y.a.fetchPolicies.olderThan(3e4)}}},R=function(){return{definition:Object(g.Q)(m.j),options:{as:m.j,fetchPolicy:y.a.fetchPolicies.olderThan(1e8)}}},F=["data"],I=["data"],B=Object(n.createContext)(),G=function(){var e=Object(n.useContext)(B);if(!e)throw new Error("useAccountContext must be used within a AccountProvider");return e},z=function(e){return e.auth.login},q=function(e){var t=e.children,a=Object(n.useState)(null),o=s()(a,2),i=o[0],l=o[1],u=Object(g.useClient)(),d=R(),m=Object(g.useQuery)(d.definition,d.options),p=m.data,f=c()(m,F),v=Object(g.isQueryLoading)(f),y=L(),E=Object(g.useQuery)(y.definition,y.options),O=E.data,j=c()(E,I),C=Object(g.isQueryLoading)(j),x=h({data:p,isLoading:v},{data:O,isLoading:C},i),w=v||C,k=Object(n.useCallback)((function(e){b({client:u,setting:p[0],account:e}),l(e)}),[u,p]),_=Object(n.useMemo)((function(){return{accounts:O,account:i,setAccount:k,isAccountLoading:w}}),[O,w,i,k]);return Object(n.useEffect)((function(){(null==x?void 0:x._id)!==(null==i?void 0:i._id)&&l(x)}),[x,i]),r.a.createElement(B.Provider,{value:_},t)},Z=a("CE71"),U=a("/s+K"),Q=a("pSj2"),H=a("Aaol"),Y=function(e){var t=e.setShowOpenPathKonnectorDialog,a=Object(H.e)().t,n=Object(g.useClient)(),o="/discover/openpath?type=konnector",i=new URL(n.getStackClient().uri),c=n.getInstanceOptions().subdomain;return r.a.createElement(Q.a,{open:!0,content:a("geolocationTracking.installOpenPathKonnectorDialog.description"),actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{variant:"secondary",label:a("geolocationTracking.installOpenPathKonnectorDialog.cancel"),onClick:function(){t(!1)}}),r.a.createElement(Z.a,{app:{slug:"store"},nativePath:o,href:Object(g.generateWebLink)({pathname:"/",cozyUrl:i.origin,slug:"store",hash:o,subDomainType:c})},(function(e){var t=e.onClick,n=e.href;return r.a.createElement(U.a,{variant:"primary",label:a("geolocationTracking.installOpenPathKonnectorDialog.install"),onClick:t,href:n})}))),onClose:function(){return t(!1)}})},V=a("Kv7L"),W=a("8ZpT"),K=a.n(W),J=a("LJzA"),X=a("DIBL"),$=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u,d;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.t,r=t.lang,o=t.deviceName,i={definition:Object(g.Q)("io.cozy.konnectors").getById("openpath"),options:{as:"".concat(m.i,"/openpath"),fetchPolicy:y.a.fetchPolicies.olderThan(3e4)}},e.next=4,a.query(i.definition,i.options);case 4:return c=e.sent,l=c.data.attributes,s=new J.a(a,null,l),e.next=9,ee({client:a,t:n,lang:r,deviceName:o});case 9:return u=e.sent,d=Object(X.a)(),e.next=13,s.createAccountSilently({konnector:l,vaultClient:null,cipherId:null,trigger:null,account:null,userCredentials:{login:u,password:d,providerId:"1"}});case 13:return e.abrupt("return",{login:u,password:d});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.t,r=t.lang,o=t.deviceName,i=o,s=o,c={definition:Object(g.Q)(m.a).where({"auth.login":s}).partialIndex({account_type:{$or:["tracemob","openpath"]}}).indexFields(["auth.login"]).select(["auth.login","account_type"]),options:{as:"".concat(m.a,"/account_type/login/").concat(s)}},e.next=5,a.query(c.definition,c.options);case 5:if(l=e.sent,0!==l.data.length){e.next=9;break}return e.abrupt("return",i);case 9:return e.abrupt("return","".concat(o," ").concat(n("geolocationTracking.settings.createdOn")," ").concat((new Date).toLocaleDateString(r)));case 10:case"end":return e.stop()}var s}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=O()(C.a.mark((function e(t,a){var n,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==t?void 0:t.call("getGeolocationTrackingStatus");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={enabled:!1};case 5:n=e.t0,r=n.enabled,a(r);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ae=function(){var e=O()(C.a.mark((function e(t,a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==t?void 0:t.call("setGeolocationTracking",!1);case 2:return e.next=4,te(t,a);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ne=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u,d,m;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.lang,r=t.t,o=t.webviewIntent,i=t.setIsGeolocationTrackingEnabled,c=t.setShowOpenPathKonnectorDialog,e.next=3,null==o?void 0:o.call("getGeolocationTrackingId");case 3:if(null!==e.sent){e.next=30;break}return e.next=7,null==o?void 0:o.call("getDeviceInfo");case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0={deviceName:null};case 10:if(l=e.t0,!(s=l.deviceName)){e.next=30;break}return e.prev=13,e.next=16,$({client:a,t:r,lang:n,deviceName:s});case 16:d=e.sent,u=d.password,e.next=28;break;case 20:if(e.prev=20,e.t1=e.catch(13),m=JSON.parse(e.t1.message),"Application is not installed"!==m.errors[0].detail){e.next=27;break}c(!0),e.next=28;break;case 27:throw e.t1;case 28:return e.next=30,null==o?void 0:o.call("setGeolocationTrackingId",u);case 30:return e.next=32,null==o?void 0:o.call("setGeolocationTracking",!0);case 32:return e.next=34,te(o,i);case 34:case"end":return e.stop()}}),e,null,[[13,20]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u,d;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.client,n=t.lang,r=t.t,o=t.setIsGeolocationTrackingEnabled,i=t.permissions,c=t.webviewIntent,l=t.setShowLocationRequestableDialog,s=t.setShowLocationRefusedDialog,u=t.setShowOpenPathKonnectorDialog,e.t1=i,e.t1){e.next=6;break}return e.next=5,null==c?void 0:c.call("checkPermissions","geolocationTracking");case 5:e.t1=e.sent;case 6:if(e.t0=e.t1,e.t0){e.next=9;break}e.t0={};case 9:if(!(d=e.t0).granted){e.next=15;break}return e.next=13,ne({client:a,lang:n,t:r,webviewIntent:c,setIsGeolocationTrackingEnabled:o,setShowOpenPathKonnectorDialog:u});case 13:e.next=16;break;case 15:d.canRequest?l(!0):s(!0);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=Object(V.isFlagshipApp)()&&K()("coachco2.GPSMemory.enabled"),ie=function(){var e=O()(C.a.mark((function e(t,a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe){e.next=13;break}return e.prev=1,e.next=4,null==t?void 0:t.call("isAvailable","geolocationTracking");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=!1;case 7:n=e.t0,a(n),e.next=13;break;case 11:e.prev=11,e.t1=e.catch(1);case 13:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,a){return e.apply(this,arguments)}}(),ce=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.webviewIntent,n=t.client,r=t.lang,o=t.t,i=t.setIsGeolocationTrackingEnabled,c=t.setShowLocationRequestableDialog,l=t.setShowLocationRefusedDialog,s=t.setShowOpenPathKonnectorDialog,e.next=3,null==a?void 0:a.call("requestPermissions","geolocationTracking");case 3:return u=e.sent,e.next=6,re({client:n,lang:r,t:o,setIsGeolocationTrackingEnabled:i,permissions:u,webviewIntent:a,setShowLocationRequestableDialog:c,setShowLocationRefusedDialog:l,setShowOpenPathKonnectorDialog:s});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=a("HROS"),se=a("ZOg5"),ue=Object(n.createContext)(),de=function(){var e=Object(n.useContext)(ue);if(!e)throw new Error("useGeolocationTracking must be used within a GeolocationTrackingProvider");return e},me=function(e){var t=e.children,a=Object(le.useWebviewIntent)(),o=Object(g.useClient)(),i=Object(H.e)(),c=i.t,l=i.lang,u=Object(n.useState)(!1),d=s()(u,2),m=d[0],p=d[1],f=Object(n.useState)(!1),b=s()(f,2),v=b[0],y=b[1],h=Object(n.useState)(!1),E=s()(h,2),j=E[0],x=E[1],w=Object(n.useState)(!1),k=s()(w,2),_=k[0],D=k[1],P=Object(n.useState)(!1),T=s()(P,2),S=T[0],M=T[1];Object(n.useEffect)((function(){ie(a,p),te(a,y)}),[a]);var A=Object(n.useMemo)((function(){return{isGeolocationTrackingAvailable:m,isGeolocationTrackingEnabled:v,disableGeolocationTracking:function(){return ae(a,y)},checkPermissionsAndEnableTrackingOrShowDialog:function(e){return re({permissions:e,client:o,lang:l,t:c,setIsGeolocationTrackingEnabled:y,webviewIntent:a,setShowLocationRequestableDialog:x,setShowLocationRefusedDialog:D,setShowOpenPathKonnectorDialog:M})}}}),[m,v,a,o,l,c]);return r.a.createElement(ue.Provider,{value:A},t,j&&r.a.createElement(se.a,{onAllow:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(!1),!Object(V.isAndroid)()){e.next=6;break}return e.next=4,ce({webviewIntent:a,client:o,lang:l,t:c,setIsGeolocationTrackingEnabled:y,setShowLocationRequestableDialog:x,setShowLocationRefusedDialog:D,setShowOpenPathKonnectorDialog:M});case 4:e.next=8;break;case 6:return e.next=8,ne({client:o,lang:l,t:c,webviewIntent:a,setIsGeolocationTrackingEnabled:y,setShowOpenPathKonnectorDialog:M});case 8:case"end":return e.stop()}}),e)}))),onClose:function(){x(!1)}}),_&&r.a.createElement(se.a,{onAllow:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!1),e.next=3,a.call("openAppOSSettings");case 3:case"end":return e.stop()}}),e)}))),onClose:function(){D(!1)},description:c("geolocationTracking.locationRefusedDialog.description")}),S&&r.a.createElement(Y,{setShowOpenPathKonnectorDialog:M}))},pe=Object(n.createContext)(),fe=function(){var e=Object(n.useContext)(pe);if(!e)throw new Error("useSelectDatesContext must be used within a SelectDatesProvider");return e},be=function(e){var t=e.children,a=Object(n.useState)(null),o=s()(a,2),i=o[0],c=o[1],l=Object(n.useMemo)((function(){return{selectedDate:i,setSelectedDate:c}}),[i]);return r.a.createElement(pe.Provider,{value:l},t)},ve=a("vTbG"),ge=a("Rx+m"),ye=a("5LIP"),he=a("0Lot"),Ee=a("BqmN"),Oe=Object(he.a)({disableGlobal:!0}),je=function(e){var t=e.client,a=e.lang,n=e.polyglot,o=e.children;return r.a.createElement(le.WebviewIntentProvider,null,r.a.createElement(Ee.b,{generateClassName:Oe},r.a.createElement(g.CozyProvider,{client:t},r.a.createElement(g.RealTimeQueries,{doctype:m.g}),r.a.createElement(g.RealTimeQueries,{doctype:m.j}),r.a.createElement(g.RealTimeQueries,{doctype:m.f}),r.a.createElement(g.RealTimeQueries,{doctype:m.c}),r.a.createElement(q,null,r.a.createElement(be,null,r.a.createElement(H.b,{lang:a,polyglot:n},r.a.createElement(ye.a,{className:"u-w-100"},r.a.createElement(ge.a,null,r.a.createElement(ve.a,null,r.a.createElement(me,null,o))))))))))},Ce=a("mZuE"),xe=a("6Vpj"),we=a("+rdD"),ke=a("6WJ3"),_e=a("HYTT"),De=a("Su4X"),Pe=a("Gyqq"),Te=a("d5dM"),Se=Object(Pe.e)(xe.b),Me=function(){var e=Object(H.e)().t;return r.a.createElement(Te.a,null,r.a.createElement(Pe.d,null,r.a.createElement(Pe.b,null,r.a.createElement(Se,{to:"/trips"},r.a.createElement(Pe.a,{icon:ke.a}),r.a.createElement(Pe.c,null,e("nav.trips")))),r.a.createElement(Pe.b,null,r.a.createElement(Se,{to:"/analysis"},r.a.createElement(Pe.a,{icon:_e.a}),r.a.createElement(Pe.c,null,e("nav.analysis")))),r.a.createElement(Pe.b,{secondary:!0},r.a.createElement(Se,{to:"/analysis/modes"},r.a.createElement(Pe.c,null,e("nav.modes")))),r.a.createElement(Pe.b,{secondary:!0},r.a.createElement(Se,{to:"/analysis/purposes"},r.a.createElement(Pe.c,null,r.a.createElement(we.a,{whiteSpace:"nowrap"},e("nav.purposes"))))),r.a.createElement(Pe.b,null,r.a.createElement(Se,{to:"/settings"},r.a.createElement(Pe.a,{icon:De.a}),r.a.createElement(Pe.c,null,e("nav.settings"))))))},Ae=a("9Y1u"),Ne=a("WY6r"),Le=a("N8wp"),Re=function(){var e=Object(H.e)().t;return r.a.createElement(Ne.b,null,r.a.createElement(Me,null),r.a.createElement(Ne.c,null,r.a.createElement(Ne.a,null,r.a.createElement(Ce.b,null))),r.a.createElement(Le.a,{t:e}),r.a.createElement(Ae.a,null))},Fe=a("LGLP"),Ie=a.n(Fe),Be=a("VDMD"),Ge=a.n(Be),ze=a("ii0b"),qe=a.n(ze),Ze=a("QGb3"),Ue=a.n(Ze),Qe=a("qmdU"),He=a("0r57"),Ye=a("8wm5"),Ve=a("C+aL"),We=a.n(Ve),Ke=a("/yh+"),Je=a.n(Ke),Xe=a("3UCn"),$e=a.n(Xe),et=a("wXrU"),tt=a.n(et),at=a("XA6X"),nt=a.n(at),rt=a("PpCK"),ot=a.n(rt),it=a("nVpl"),ct=a.n(it),lt=a("FpXT"),st=a.n(lt),ut=a("efAt"),dt=a.n(ut),mt=a("Jb16"),pt=a.n(mt),ft=a("gSRL"),bt=a.n(ft),vt=a("DWnN");function gt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function yt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ht=function(e){return"start"===e?"startPlaceContact":"end"===e?"endPlaceContact":null},Et=function(e){var t,a,n=e.contact,r=e.timeserie,o=e.type;return{address:null==n||null===(t=n.address)||void 0===t?void 0:t.find((function(e,t){var n,i,c;if(e.id===(null===(n=r.relationships[ht(o)])||void 0===n||null===(i=n.data)||void 0===i||null===(c=i.metadata)||void 0===c?void 0:c.addressId))return a=t,e})),index:a}},Ot=function(e){var t,a,n,r=e.contact,o=e.timeserie,i=e.type;return null===(t=Et({contact:r,timeserie:o,type:i}))||void 0===t||null===(a=t.address)||void 0===a||null===(n=a.geo)||void 0===n?void 0:n.cozyCategory},jt=function(e){var t,a,n=e.contact,r=e.timeserie,o=e.type;return null===(t=Et({contact:n,timeserie:r,type:o}))||void 0===t||null===(a=t.address)||void 0===a?void 0:a.type},Ct=function(e,t){return e[ht(t)]},xt=function(e,t){var a;return!(null===(a=Ct(e,t))||void 0===a||!a.data)},wt=function(e){var t,a=e.timeserie,n=e.type,r=e.t,o=null===(t=Ct(a,n))||void 0===t?void 0:t.data;if(!o)return null;var i=!!o.me,c=Ot({timeserie:a,type:n,contact:o}),l=jt({timeserie:a,type:n,contact:o}),s=Object(vt.getDisplayName)(o);return c===P.G&&i?r("contactToPlace.atHome"):l?i?l:"".concat(s," (").concat(l,")"):s},kt=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.timeserie,r=t.type,o=t.t,i=t.contact,c=Et({contact:i,timeserie:n,type:r}),l=c.address,pt()(i.address,(function(e){return e.id&&e.id===l.id})),e.next=5,a.save(i);case 5:return e.next=7,Ct(n,r).remove();case 7:return s=e.sent,u=s.data,bt()(u,"relationships.".concat(ht(r),".data.metadata.addressId")),nt()(u,"aggregation.automaticTitle",Ia(yt(yt({},u),{},{startPlaceContact:n.startPlaceContact,endPlaceContact:n.endPlaceContact}),o)),e.next=13,a.save(u);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_t=function(e){var t=e.contact,a=e.addressId,n=e.label,r=e.timeserie,o=e.type,i=e.category;return yt(yt({},t),{},{address:[].concat(Ue()(t.address||[]),[{id:a,type:n,formattedAddress:Wa(r,o),geo:{geo:Ka(r,o),cozyCategory:i}}])})},Dt=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u,d,m,p,f;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.contact,r=t.timeserie,o=t.type,i=t.label,c=t.category,l=t.t,s=Object(X.a)(),u=_t({contact:n,addressId:s,label:i,timeserie:r,type:o,category:c}),e.next=5,a.save(u);case 5:return d=e.sent,m=d.data,e.next=9,Ct(r,o).add(m);case 9:return p=e.sent,f=p.data,nt()(f,"relationships.".concat(ht(o),".data.metadata"),{addressId:s}),nt()(f,"aggregation.automaticTitle",Ia(yt(yt({},f),{},{startPlaceContact:r.startPlaceContact,endPlaceContact:r.endPlaceContact}),l)),e.next=15,a.save(f);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pt=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.contact,r=t.timeserie,o=t.type,i=t.label,c=t.category,l=t.t,s=Et({contact:n,timeserie:r,type:o}),u=s.index,nt()(n,"address[".concat(u,"].type"),i),nt()(n,"address[".concat(u,"].geo.cozyCategory"),c),e.next=6,a.save(n);case 6:return nt()(r,"aggregation.automaticTitle",Ia(r,l)),e.next=9,a.save(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tt=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u,d;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.type,r=t.timeserie,o=t.contact,i=t.label,c=t.isSameContact,l=t.category,s=t.t,u=Et({contact:o,timeserie:r,type:n}),d=u.address,e.abrupt("return",c&&d?Pt({client:a,contact:o,timeserie:r,type:n,label:i,isSameContact:c,category:l,t:s}):Dt({client:a,contact:o,timeserie:r,type:n,label:i,category:l,t:s}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),St=a("rUPj"),Mt=a.n(St),At=a("QVGT"),Nt=a("rinC"),Lt=a("uywR"),Rt=a("eBtv"),Ft=a("Dzzq"),It=a("6CkU"),Bt=a("x9kU"),Gt=a("Dt6a"),zt=a("tLIM"),qt=a("GLkt"),Zt=a("Npr/"),Ut=a("t+nR"),Qt=a("4+jE"),Ht=a("P6yu"),Yt=a("XAJ7"),Vt=a("B7lc"),Wt=a("P/GF"),Kt=a("I46i"),Jt=a("KeZy"),Xt=a("u/Gg"),$t=a("Ins2"),ea=a("B6UP"),ta=a("keV2"),aa=a("6+xZ"),na=[P.a,P.j,P.k,P.m,P.n,P.v,P.w,P.H,P.q,P.r,P.W,P.Y,P.kb,P.U,P.tb,P.vb,P.Ab,P.Z,P.ib,P.yb],ra=function e(t){switch(t){case P.a:return Vt.a;case P.j:return Bt.a;case P.k:return At.a;case P.m:return Nt.a;case P.w:case P.H:return Lt.a;case P.n:return Nt.a;case P.v:case P.q:return Gt.a;case P.r:return Rt.a;case P.W:case P.Y:return Ut.a;case P.kb:return zt.a;case P.U:return Zt.a;case P.tb:return Xt.a;case P.vb:return $t.a;case P.Ab:case P.Z:case P.ib:return ta.a;case P.yb:return ea.a;default:return Mt()("info","Unknown mode ".concat(t),"pickModeIcon"),e(P.yb)}},oa=function e(t){switch(t){case P.a:return"#F05759";case P.j:return"#B3BF26";case P.k:return"#15CACD";case P.kb:return"#84C6AA";case P.m:return"#F85AA8";case P.n:return"#BA5AE8";case P.v:return"#FC881C";case P.w:case P.H:return"#FF7B5E";case P.q:return"#80A5E1";case P.r:return"#1CAAE8";case P.W:return"#C78542";case P.Y:return"#C8A76F";case P.U:return"#E3BE7D";case P.tb:return"#8978FF";case P.vb:return"#F1B61E";case P.yb:return"#A4A7AC";case P.Ab:case P.Z:case P.ib:return"#21B930";default:return Mt()("info","Unknown mode ".concat(t),"modeToColor"),e(P.yb)}},ia=[P.y,P.Cb,P.lb,P.bb,P.cb,P.rb,P.E,P.D,P.wb,P.ab],ca=function e(t){switch(t){case P.y:return It.a;case P.Cb:return aa.a;case P.lb:return Kt.a;case P.wb:return Qt.a;case P.bb:return Yt.a;case P.E:return qt.a;case P.D:return Ft.a;case P.cb:return Wt.a;case P.rb:return Jt.a;case P.ab:return Ht.a;default:return Mt()("info","Unknown purpose ".concat(t),"pickPurposeIcon"),e(P.ab)}},la=function e(t){switch(t){case P.y:return"#BA5AE8";case P.Cb:return"#8978FF";case P.lb:return"#FF7B5E";case P.wb:return"#15CACD";case P.bb:return"#1CAAE8";case P.E:return"#21B930";case P.D:return"#F85AA8";case P.cb:return"#C78542";case P.rb:return"#B3BF26";case P.ab:return"#A4A7AC";default:return Mt()("info","Unknown purpose ".concat(t),"purposeToColor"),e(P.ab)}},sa=function(e){var t=function(e){return parseFloat((e.reduce((function(e,t){return e+t}),0)/e.length).toFixed(5))};switch(e){case P.a:return t(P.c);case P.j:return P.i;case P.k:return P.g;case P.m:return P.l;case P.n:return t(P.b);case P.v:return P.u;case P.w:case P.H:return P.s;case P.q:return P.p;case P.r:return P.o;case P.W:return P.V;case P.Y:return P.X;case P.kb:return P.jb;case P.U:return P.T;case P.tb:return t(P.d);case P.vb:return t(P.e);case P.yb:return P.xb;case P.Ab:case P.Z:case P.ib:return P.zb;default:return P.xb}},ua=function(e){return 1e3*parseFloat(e)},da=function(e){return e===P.a?"(".concat(ua(P.db),"~").concat(ua(P.fb),") g/km"):"".concat(ma(e)," g/km")},ma=function(e){return Math.round(ua(sa(e)))},pa=function e(t){switch(t){case P.a:case P.Ab:case P.Z:case P.ib:case P.yb:return null;case P.j:case P.k:case P.kb:return P.h.name;case P.m:case P.n:case P.tb:case P.vb:return P.gb.name;case P.v:case P.w:case P.H:case P.q:case P.r:case P.W:case P.Y:case P.U:return P.t.name;default:return Mt()("info","Unknown mode ".concat(t),"modeToCategory"),e(P.yb)}},fa=a("e0b0"),ba=a.n(fa),va=function(e){var t="m",a=e;return e>1e3&&(t="km",a=e/1e3),"".concat(Math.round(a)," ").concat(t)},ga=function(e){return"".concat(Math.round(100*e)/100," kg")},ya=function(e,t){var a=["fr","en"].includes(t)?t:"en";return ba()(1e3*e,{delimiter:" ",largest:2,round:!0,units:["h","m"],language:a,languages:{fr:{d:function(){return"j"},h:function(){return"h"},m:function(){return"min"},s:function(){return"s"},ms:function(){return"ms"}},en:{d:function(){return"d"},h:function(){return"h"},m:function(){return"min"},s:function(){return"s"},ms:function(){return"ms"}}}})},ha=function(e){var t=e.f,a=e.lang,n=e.date;return t(n,"fr"===a?"HH[h]mm":"HH:mm")},Ea=function(e){return 3.6*(e.reduce((function(e,t){return e+t}),0)/e.length)},Oa=function(e){var t=0,a=e.distance/1e3;switch(e.mode){case P.a:if(a<=P.mb){t+=a*P.fb;break}a<=P.J?t+=a*P.eb:t+=a*P.db;break;case P.j:t+=a*P.i;break;case P.k:t+=a*P.g;break;case P.m:t+=a*P.l;break;case P.n:t+=a*sa(P.n);break;case P.v:t+=a*P.u;break;case P.w:case P.H:t+=a*P.s;break;case P.q:t+=a*P.p;break;case P.r:t+=a*P.o;break;case P.W:t+=a*P.V;break;case P.Y:t+=a*P.X;break;case P.kb:t+=a*P.jb;break;case P.U:t+=a*P.T;break;case P.tb:t+=a*sa(P.tb);break;case P.vb:t+=a*sa(P.vb);break;case P.yb:t+=a*P.xb;break;case P.Ab:case P.ib:case P.Z:t+=a*P.zb}return t},ja=function(e){var t,a=e.averageSpeed,n=e.duration/60;switch(e.mode){case P.Ab:case P.Z:case P.ib:t=a<=P.qb?P.R:a<=P.K?P.Q:a<=P.F?P.P:P.S;break;case P.k:t=a<=P.pb?P.N:a<=P.ob?P.M:a<=P.nb?P.L:P.O}return t?function(e,t){return e*P.C*3.5/200*t}(t,n):0},Ca=a("euuj"),xa=a.n(Ca),wa=function(e){return Je()(e,"properties.manual_purpose")},ka=function(e){var t;return null==e||null===(t=e.properties)||void 0===t?void 0:t.automatic_purpose},_a=function(e){return Je()(e,"properties.start_place.data.properties.display_name")},Da=function(e){return Je()(e,"properties.end_place.data.properties.display_name")},Pa=function(e,t){var a=(t||{}).defaultTransportModeByGroup,n=Je()(e,"properties.sensed_mode","").toUpperCase(),r=n.split("PREDICTEDMODETYPES.")[1]||n.split("MOTIONTYPES.")[1],o=na.includes(r),i=na.find((function(e){return(null==a?void 0:a[pa(r)])===e}));return!!i&&i||o&&r||P.yb},Ta=xa()((function(e,t){return e.features.filter((function(e){return"FeatureCollection"===e.type})).flatMap((function(e){return function(e,t){return e.features.map((function(e){var a=Je()(e,"properties.start_fmt_time"),n=Je()(e,"properties.end_fmt_time"),r=Je()(e,"properties.speeds");return{id:e.id,mode:Pa(e,t),coordinates:Je()(e,"geometry.coordinates"),timestamps:Je()(e,"properties.timestamps"),distance:Je()(e,"properties.distance"),distances:Je()(e,"properties.distances"),duration:Je()(e,"properties.duration"),startDate:a?new Date(a):a,endDate:n?new Date(n):n,speeds:r,avgSpeed:r?Ea(r):void 0}}))}(e,t)}))})),Sa=function(e){return new Date(e.properties.start_fmt_time)},Ma=function(e){return new Date(e.properties.end_fmt_time)};function Aa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Na(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Aa(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Aa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function La(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return Ra(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ra(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw o}}}}function Ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}g.models.geo.geodesicDistance;var Fa=function(e){return e.flatMap((function(t,a){return t.series.map((function(t){return function(e){var t=e.features,a=e.properties,n=$e()(t,(function(e){return e.id}));return tt()({},e,{properties:{start_place:{data:n[a.start_place.$oid]},end_place:{data:n[a.end_place.$oid]}}})}(Na(Na({},t),{},{timeserieId:e[a]._id}))}))}))},Ia=function(e,t){var a,n,r,o,i,c,l=wt({timeserie:e,type:"start",t:t}),s=wt({timeserie:e,type:"end",t:t}),u=(null===(a=Ya(e))||void 0===a||null===(n=a.split(","))||void 0===n||null===(r=n[1])||void 0===r?void 0:r.trim())||"",d=(null===(o=Va(e))||void 0===o||null===(i=o.split(","))||void 0===i||null===(c=i[1])||void 0===c?void 0:c.trim())||"";if(l||s){var m=l||Ya(e),p=s||Va(e);return"".concat(m," > ").concat(p)}return(u||d)&&u!==d?"".concat(u," > ").concat(d).trim():Va(e)},Ba=function(e){var t=0;return e.forEach((function(e){var a;t+=(null===(a=e.aggregation)||void 0===a?void 0:a.totalCO2)||0})),t},Ga=function(e,t){var a=st()(e),n=e[t],r=0===n.timeseries.length&&0===n.totalCO2,o=ot()(a.filter((function(e){return r?e[0]!==t&&e[1].totalCO2>0:e[1].totalCO2>0})),(function(e){return e[1].totalCO2})).reverse(),i=ot()(a.filter((function(e){return r?e[0]!==t&&0===e[1].totalCO2:0===e[1].totalCO2})),(function(e){return e[1].timeseries.length})).reverse();return Na(Na(Na({},We()(o)),We()(i)),r&&d()({},t,n))},za=function(e){var t=function(e){var t=na.reduce((function(e,t){return Na(Na({},e),{},d()({},t,{timeseries:[],totalCO2:0}))}),{});return e.forEach((function(e){e.aggregation.sections.forEach((function(a){var n=t[a.mode].timeseries;n.some((function(t){return t.id===e.id}))||n.push(e),t[a.mode].totalCO2+=a.CO2}))})),t}(e);return Ga(t,P.yb)},qa=function(e){var t=Je()(e,"aggregation.purpose","").toUpperCase();return ia.includes(t)&&t||P.ab},Za=function(e){var t=function(e){var t=ia.reduce((function(e,t){return Na(Na({},e),{},d()({},t,{timeseries:[],totalCO2:0}))}),{});return e.forEach((function(e){var a=qa(e),n=t[a].timeseries;n.some((function(t){return t.id===e.id}))||n.push(e),t[a].totalCO2+=e.aggregation.totalCO2})),t}(e);return Ga(t,P.ab)},Ua=function(e){return e.startDate?new Date(e.startDate):null},Qa=function(e){return e.endDate?new Date(e.endDate):null},Ha=function(e,t){return"start"===t?Ua(e):"end"===t?Qa(e):null},Ya=function(e){return Je()(e,"aggregation.startPlaceDisplayName")||Je()(e.series[0],"features[0].properties.display_name")},Va=function(e){return Je()(e,"aggregation.endPlaceDisplayName")||Je()(e.series[0],"features[1].properties.display_name")},Wa=function(e,t){return"start"===t?Ya(e):"end"===t?Va(e):null},Ka=function(e,t){var a=Xa(e);return Ue()(a.properties["".concat(t,"_loc")].coordinates)},Ja=function(e){var t=e.timeserie,a=e.type,n=e.t;return"".concat(n("contactToPlace.lat"),": ")+Ka(t,a).reverse().toString().replace(",",", ".concat(n("contactToPlace.long"),": "))},Xa=function(e){return Je()(e,"series[0]")},$a=function(e,t){var a=Je()(e,"aggregation.automaticTitle");if(!a)return null;if(!t)return a;var n=a.split(">"),r=s()(n,2),o=r[0],i=r[1];return o.length>12&&i?"".concat(o.slice(0,12).trim(),"... > ").concat(i.trim()):a},en=function(e){var t=Ua(e),a=Qa(e);return Object(He.a)(a,t)},tn=function(e){return va(e.aggregation.totalDistance)},an=function(e){var t=function(e){return Je()(e,"aggregation.totalCO2","")}(e);return ga(t)},nn=function(e){var t,a=function(e){return Je()(e,"aggregation.totalCalories","")}(e);return t=a,"".concat(Math.round(t)," kcal")},rn=function(e,t){var a=t(Ua(e),"dddd D MMMM YYYY");return a.charAt(0).toUpperCase()+a.slice(1)},on=function(e,t){var a;if(null==e||null===(a=e.series)||void 0===a||!a[0])throw new Error("Timeserie is malformed");var n=Na({},e);return nt()(n,"series[0].properties.automatic_purpose",t),nt()(n,"aggregation.recurring",!0),ln(n)},cn=function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isRecurringTrip,o=void 0===r?null:r;if(null==e||null===(a=e.series)||void 0===a||!a[0])throw new Error("Timeserie is malformed");var i=Na({},e);return nt()(i,"series[0].properties.manual_purpose",t.toUpperCase()),null!==o&&nt()(i,"aggregation.recurring",o),ln(i)},ln=function(e){var t,a=e.series[0],n=null!=e&&null!==(t=e.aggregation)&&void 0!==t&&t.recurring&&ka(a)||wa(a);return n?Na(Na({},e),{},{aggregation:Na(Na({},e.aggregation),{},{purpose:n})}):e},sn=function(e,t){var a=function(e,t){var a,n=0,r=La(e.aggregation.sections);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.mode===t&&(n+=o.CO2)}}catch(i){r.e(i)}finally{r.f()}return n}(e,t);return ga(a)},un=function(e){var t=0,a=Ue()(e).sort((function(e,t){return Ua(e)-Ua(t)}));return a.forEach((function(e,n){if(0===n)t++;else{var r=Ua(e),o=a[n-1],i=Ua(o),c=Object(Qe.a)(i,12);r.toDateString()===i.toDateString()||r<c||t++}})),t},dn=function(e,t){return e.filter((function(e){return new Date(e.startDate).getFullYear().toString()===t}))},mn=function(e){var t,a,n,r,o,i,c,l,s,u;return{lon:null==e||null===(t=e.series)||void 0===t||null===(a=t[0])||void 0===a||null===(n=a.properties)||void 0===n||null===(r=n.start_loc)||void 0===r||null===(o=r.coordinates)||void 0===o?void 0:o[0],lat:null==e||null===(i=e.series)||void 0===i||null===(c=i[0])||void 0===c||null===(l=c.properties)||void 0===l||null===(s=l.start_loc)||void 0===s||null===(u=s.coordinates)||void 0===u?void 0:u[1]}},pn=function(e){var t,a,n,r,o,i,c,l,s,u;return{lon:null==e||null===(t=e.series)||void 0===t||null===(a=t[0])||void 0===a||null===(n=a.properties)||void 0===n||null===(r=n.end_loc)||void 0===r||null===(o=r.coordinates)||void 0===o?void 0:o[0],lat:null==e||null===(i=e.series)||void 0===i||null===(c=i[0])||void 0===c||null===(l=c.properties)||void 0===l||null===(s=l.end_loc)||void 0===s||null===(u=s.coordinates)||void 0===u?void 0:u[1]}},fn=function(e){var t,a,n=null==e||null===(t=e[0].bikeGoal)||void 0===t?void 0:t.daysToReach,r=null===(a=K()("coachco2.bikegoal.settings"))||void 0===a?void 0:a.daysToReach;return n||r||100},bn=function(){var e,t=null===(e=K()("coachco2.bikegoal.settings"))||void 0===e?void 0:e.bountyAmount;if(!t)throw new Error('Flag "coachco2.bikegoal.settings" must be used');return t},vn=function(){var e,t,a=null===(e=K()("coachco2.bikegoal.settings"))||void 0===e?void 0:e.sourceIdentity;return{sourceType:null===(t=K()("coachco2.bikegoal.settings"))||void 0===t?void 0:t.sourceType,sourceIdentity:a}},gn=function(e,t){return!(!e||0===e.length)&&un(e)>=fn(t)},yn=function(e,t){if(!e||0===e.length)return 0;var a=un(e),n=fn(t);return a<n?a:n},hn=function(e){var t=fn(e),a=.5>t?t:.5;return Math.round(a/t*100)},En=a("gQ+z"),On=["timeseries","sendToDACC","size"],jn=["data"],Cn=function(e){var t=e.timeseries,a=e.sendToDACC,n=e.size,o=c()(e,On),i=R(),l=Object(g.useQuery)(i.definition,i.options),s=l.data,u=c()(l,jn);if(Object(g.isQueryLoading)(u))return null;var d=function(e,t){if(!e)return 100;var a=yn(e),n=fn(t);return Math.round(a/n*100)}(t,s),m=function(e){switch(e){case"medium":return"3rem";case"small":return"2.5rem";default:return"4.5rem"}}(n);return r.a.createElement(En.a,Ie()({size:n,primaryProps:{value:d,color:"#BA5AE8"}},a&&{secondaryProps:{value:hn(s),color:"#BA5AE83D"}},o),r.a.createElement(we.a,{fontSize:m},"🚴"))};Cn.propTypes={className:qe.a.string,timeseries:qe.a.arrayOf(qe.a.object)};var xn=Cn,wn=a("kyG8"),kn=a.n(wn),_n=a("i0pn"),Dn=a("DZbK"),Pn=a.n(Dn),Tn=a("vVt6"),Sn=a.n(Tn),Mn=a("v5t+"),An=a.n(Mn),Nn=function(){return r.a.createElement(_n.h,{viewBox:"0 0 409 757"},r.a.createElement(_n.f,{d:"M386.752 16.07C386.752 22.7658 392.18 28.1938 398.876 28.1938C403.363 28.1938 407 31.8309 407 36.3175L407 720.682C407 725.169 403.363 728.806 398.876 728.806C392.18 728.806 386.752 734.234 386.752 740.93L386.752 743.903C386.752 750.032 381.784 755 375.656 755L33.3444 755C27.2158 755 22.2475 750.032 22.2475 743.903L22.2475 740.93C22.2475 734.234 16.8195 728.806 10.1237 728.806C5.63715 728.806 2 725.169 2 720.682L2.00003 36.3175C2.00003 31.8309 5.63718 28.1938 10.1238 28.1938C16.8195 28.1938 22.2476 22.7658 22.2476 16.07L22.2476 13.0969C22.2476 6.96822 27.2158 1.99998 33.3444 1.99998L375.656 2C381.784 2 386.752 6.96825 386.752 13.0969L386.752 16.07Z",fill:"white",stroke:"#297EF2",strokeWidth:"4"}),r.a.createElement(_n.f,{d:"M386.926 8.8584C395.21 8.8584 401.926 15.5741 401.926 23.8584L401.926 736.142C401.926 742.77 396.553 748.142 389.926 748.142L19.0743 748.142C12.4468 748.142 7.07429 742.77 7.07429 736.142L7.07431 20.8584C7.07431 14.231 12.4469 8.85838 19.0743 8.85838L386.926 8.8584Z",stroke:"#297EF2",strokeWidth:"2"}),r.a.createElement(_n.c,{cx:"404.951",cy:"5.23875",ry:"5.23875",rx:"4.04951",fill:"#297EF2"}),r.a.createElement(_n.c,{cx:"404.951",cy:"751.761",ry:"5.23875",rx:"4.04951",fill:"#297EF2"}),r.a.createElement(_n.c,{cx:"4.04962",cy:"5.23875",ry:"5.23875",rx:"4.04951",fill:"#297EF2"}),r.a.createElement(_n.c,{cx:"4.04962",cy:"751.761",ry:"5.23875",rx:"4.04951",fill:"#297EF2"}))},Ln=function(){return r.a.createElement(_n.h,{width:"72",height:"72",viewBox:"0 0 72 72"},r.a.createElement(_n.f,{d:"M31.2945 5.16468C33.8194 2.39335 38.1806 2.39335 40.7055 5.16468C42.3805 7.00311 44.9728 7.6977 47.3426 6.94307C50.9149 5.8055 54.6918 7.98608 55.4928 11.6486C56.0241 14.0782 57.9218 15.9759 60.3514 16.5072C64.0139 17.3082 66.1945 21.0851 65.0569 24.6574C64.3023 27.0272 64.9969 29.6195 66.8353 31.2945C69.6067 33.8194 69.6067 38.1806 66.8353 40.7055C64.9969 42.3805 64.3023 44.9728 65.0569 47.3426C66.1945 50.9149 64.0139 54.6918 60.3514 55.4928C57.9218 56.0241 56.0241 57.9218 55.4928 60.3514C54.6918 64.0139 50.9149 66.1945 47.3426 65.0569C44.9728 64.3023 42.3805 64.9969 40.7055 66.8353C38.1806 69.6067 33.8194 69.6067 31.2945 66.8353C29.6195 64.9969 27.0272 64.3023 24.6574 65.0569C21.0851 66.1945 17.3082 64.0139 16.5072 60.3514C15.9759 57.9218 14.0782 56.0241 11.6486 55.4928C7.98608 54.6918 5.8055 50.9149 6.94307 47.3426C7.6977 44.9728 7.00311 42.3805 5.16468 40.7055C2.39335 38.1806 2.39335 33.8194 5.16468 31.2945C7.00311 29.6195 7.6977 27.0272 6.94307 24.6574C5.8055 21.0851 7.98608 17.3082 11.6486 16.5072C14.0782 15.9759 15.9759 14.0782 16.5072 11.6486C17.3082 7.98608 21.0851 5.8055 24.6574 6.94307C27.0272 7.6977 29.6195 7.00311 31.2945 5.16468Z",fill:"#297EF2"}),r.a.createElement(_n.a,{cx:"36",cy:"36",r:"26",fill:"white"}),r.a.createElement(_n.f,{d:"M33.8789 46.515C34.1467 46.4481 34.4182 46.611 34.4852 46.8789L34.9852 48.8789C34.9953 48.9194 35.0002 48.9601 35.0002 49.0001H37C37 48.9601 37.0049 48.9194 37.015 48.8789L37.515 46.8789C37.582 46.611 37.8535 46.4481 38.1214 46.515C38.3893 46.582 38.5522 46.8535 38.4852 47.1214L38.0001 49.0617V51.0001C38.0001 51.5524 37.5524 52.0001 37.0001 52.0001H35.0001C34.4478 52.0001 34.0001 51.5524 34.0001 51.0001V49.0617L33.515 47.1214C33.4481 46.8535 33.611 46.582 33.8789 46.515Z",fill:"#297EF2"}),r.a.createElement(_n.f,{d:"M34 47C33.4477 47 32.9798 46.5318 32.6829 46.0661C32.1387 45.2125 30.95 44.2886 29.5553 43.2046C26.3288 40.6968 22 37.3322 22 32C22 25.3726 28.268 20 36 20V47H34Z",fill:"#297EF2"}),r.a.createElement(_n.f,{d:"M36 47H34.2857C34.2857 45.882 33.4127 44.6945 32.3173 43.2046C30.4736 40.6968 28 37.3322 28 32C28 25.3726 31.5817 20 36 20V47Z",fill:"#579EFF"}),r.a.createElement(_n.f,{d:"M38 47C38.5523 47 39.0202 46.5318 39.3171 46.0661C39.8613 45.2125 41.05 44.2886 42.4447 43.2046C45.6712 40.6968 50 37.3322 50 32C50 25.3726 43.732 20 36 20V47H38Z",fill:"#B3D3FF"}),r.a.createElement(_n.f,{d:"M36 47H37.7143C37.7143 45.882 38.5873 44.6945 39.6827 43.2046C41.5264 40.6968 44 37.3322 44 32C44 25.3726 40.4183 20 36 20V47Z",fill:"#91BFFF"}),r.a.createElement(_n.a,{cx:"36",cy:"36",r:"23",stroke:"#297EF2",strokeWidth:"2"}))},Rn=function(){return r.a.createElement(_n.h,{width:"74",height:"32",viewBox:"0 0 74 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement(_n.f,{fillRule:"evenodd",clipRule:"evenodd",d:"M57.1068 13.6515L58.8382 18.2742L60.4808 13.6515H62.3782L59.6788 20.5655C59.1822 21.8522 58.3415 22.5275 57.3102 22.5275C56.7628 22.5275 56.1002 22.3622 55.6548 22.1202L56.0488 20.8468C56.3675 21.0242 56.6988 21.1388 56.9155 21.1388C57.2708 21.1388 57.5522 21.0242 57.6928 20.7822L57.9222 20.2982L55.1835 13.6515H57.1068ZM45.1202 13.5208C47.0682 13.5208 48.6982 15.0868 48.6982 16.9588C48.6982 18.8308 47.0682 20.4095 45.1202 20.4095C43.1588 20.4095 41.5162 18.8308 41.5162 16.9588C41.5162 15.0868 43.1588 13.5208 45.1202 13.5208ZM37.9802 11.3335C39.3042 11.3335 40.5268 11.8948 41.3802 12.7988L40.0182 14.0208C39.5082 13.4355 38.7828 13.0408 37.9802 13.0408C36.5162 13.0408 35.2675 14.3395 35.2675 15.8542C35.2675 17.3822 36.5162 18.6815 37.9808 18.6815C38.7828 18.6815 39.5082 18.2868 40.0182 17.7008L41.3802 18.9242C40.5268 19.8148 39.3042 20.3882 37.9802 20.3882C35.4728 20.3882 33.3335 18.3122 33.3335 15.8548C33.3335 13.3975 35.4735 11.3335 37.9802 11.3335ZM54.7055 13.6522V14.9642L51.3948 18.6562H54.7315V20.2348H48.9762V18.9235L52.2868 15.2302H49.0655V13.6522H54.7055ZM45.1188 15.0868C44.1255 15.0868 43.2988 15.9402 43.2988 16.9588C43.2988 17.9782 44.1255 18.8435 45.1188 18.8435C46.1002 18.8435 46.9275 17.9782 46.9275 16.9588C46.9275 15.9402 46.1008 15.0868 45.1195 15.0868H45.1188Z",fill:"#297EF2"}),r.a.createElement(_n.f,{d:"M20.0002 26.6668C25.8912 26.6668 30.6668 21.8912 30.6668 16.0002C30.6668 10.1091 25.8912 5.3335 20.0002 5.3335C14.1091 5.3335 9.3335 10.1091 9.3335 16.0002C9.3335 21.8912 14.1091 26.6668 20.0002 26.6668Z",fill:"#297EF2"}),r.a.createElement(_n.f,{fillRule:"evenodd",clipRule:"evenodd",d:"M22.2092 17.0408C22.1026 17.2075 21.8666 17.2568 21.7032 17.1475C21.6899 17.1395 21.6759 17.1302 21.6632 17.1208C21.1886 17.4928 20.6039 17.6955 19.9966 17.6955C19.3906 17.6955 18.8079 17.4935 18.3339 17.1222C18.3219 17.1315 18.3092 17.1402 18.2966 17.1482C18.1292 17.2575 17.8966 17.2055 17.7906 17.0422C17.6839 16.8775 17.7306 16.6542 17.8946 16.5435C18.0372 16.4502 18.0472 16.2628 18.0472 16.2608C18.0506 16.1628 18.0932 16.0695 18.1646 16.0042C18.2352 15.9375 18.3239 15.9002 18.4219 15.9075C18.6179 15.9122 18.7779 16.0775 18.7739 16.2762C18.7739 16.2788 18.7739 16.3782 18.7379 16.5162C19.4699 17.1235 20.5312 17.1215 21.2606 16.5108C21.2339 16.4048 21.2272 16.3208 21.2252 16.2815C21.2232 16.1795 21.2599 16.0875 21.3279 16.0168C21.3952 15.9482 21.4859 15.9088 21.5826 15.9075H21.5892C21.7852 15.9075 21.9479 16.0655 21.9526 16.2622C21.9526 16.2622 21.9626 16.4502 22.1039 16.5435C22.2686 16.6522 22.3159 16.8748 22.2092 17.0408ZM23.7572 12.7948C23.6526 11.9095 23.2606 11.0908 22.6306 10.4575C21.9086 9.73216 20.9539 9.3335 19.9439 9.3335C18.9339 9.3335 17.9806 9.73216 17.2579 10.4582C16.6259 11.0935 16.2326 11.9168 16.1306 12.8075C15.2632 12.9128 14.4612 13.3162 13.8419 13.9655C13.1352 14.7062 12.7466 15.6855 12.7466 16.7235C12.7466 18.8982 14.4692 20.6668 16.5879 20.6668H23.4119C25.5292 20.6668 27.2532 18.8982 27.2532 16.7235C27.2532 14.6682 25.7132 12.9748 23.7572 12.7948Z",fill:"white"}))};_n.d.register({family:"Lato",src:Sn.a}),_n.d.register({family:"Courgette",src:Pn.a}),_n.d.register({family:"PlusJakarta",src:An.a});var Fn=_n.g.create({co2CertificateSVG:{margin:"0 auto 10px"},cozySVG:{margin:"0 auto"},page:{padding:8},content:{display:"flex",justifyContent:"space-between",position:"absolute",top:54,left:40,bottom:50,right:40},title:{whiteSpace:"pre-line",fontFamily:"PlusJakarta",fontSize:24,fontStyle:"normal",textAlign:"center",lineHeight:1.2},subTitle:{textAlign:"center",color:"rgba(29, 33, 42, 0.48)",marginTop:20,fontSize:12,fontStyle:"normal",fontWeight:400},name:{fontFamily:"Courgette",textAlign:"center",color:"#297EF2",fontSize:32,fontStyle:"normal",marginTop:20},divider:{width:"100%",height:1,backgroundColor:"rgba(29, 33, 42, 0.12)",margin:"20px 0"},text:{fontFamily:"Lato",textAlign:"left",color:"rgba(29, 33, 42, 0.90)",fontSize:14,fontStyle:"normal",marginTop:20,lineHeight:1.3}}),In=function(e){var t=e.t,a=e.username,n=e.daysToReach,o=e.sourceIdentity,i=e.year,c=e.lang,l=new Date,s=l.toLocaleDateString(c,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),u=l.toLocaleTimeString(c,{hour12:!1,hour:"2-digit",minute:"2-digit"}).replace(":","h");return r.a.createElement(_n.b,null,r.a.createElement(_n.e,{wrap:!1,style:Fn.page},r.a.createElement(_n.j,null,r.a.createElement(Nn,null)),r.a.createElement(_n.j,{style:Fn.content},r.a.createElement(_n.j,null,r.a.createElement(_n.j,{style:Fn.co2CertificateSVG},r.a.createElement(Ln,null)),r.a.createElement(_n.i,{style:Fn.title},t("PDF.title")),r.a.createElement(_n.i,{style:Fn.subTitle},t("PDF.date",{currentDateFormatted:s,currentTimeFormatted:u})),r.a.createElement(_n.i,{style:Fn.name},a),r.a.createElement(_n.j,{style:Fn.divider}),r.a.createElement(_n.i,{style:Fn.text},t("PDF.recipient",{sourceIdentity:o})),r.a.createElement(_n.i,{style:Fn.text},t("PDF.date",{currentDateFormatted:s,currentTimeFormatted:u})),r.a.createElement(_n.i,{style:Fn.text},t("PDF.paragraph01",{username:a,daysToReach:n,year:i})),r.a.createElement(_n.i,{style:Fn.text},t("PDF.paragraph02")),r.a.createElement(_n.i,{style:Fn.text},t("PDF.paragraph03")),r.a.createElement(_n.i,{style:Fn.text},t("PDF.signature",{username:a}))),r.a.createElement(_n.j,{style:Fn.cozySVG},r.a.createElement(Rn,null)))))},Bn=g.models.folder,Gn=Bn.MAGIC_FOLDERS,zn=Bn.ensureMagicFolder,qn=Bn.getReferencedFolder,Zn="".concat(m.b,"/coachco2"),Un=function(){var e=O()(C.a.mark((function e(t,a){var n,r,o,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qn(t,{_id:Zn,_type:m.b});case 2:if(!(n=e.sent)){e.next=7;break}return e.abrupt("return",n);case 7:return e.next=9,zn(t,Gn.ADMINISTRATIVE,"/".concat(a("folder.administrative")));case 9:return r=e.sent,o=r.path,e.next=13,zn(t,Gn.COACH_CO2,"".concat(o,"/").concat(a("folder.coachco2")));case 13:return i=e.sent,e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Qn=a("0nAg"),Hn=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.t,r=t.pdfDocument,o=t.year,e.prev=1,e.next=4,Object(_n.k)(r).toBlob();case 4:return i=e.sent,e.next=7,Un(a,n);case 7:return c=e.sent,l=c._id,e.next=11,Object(Qn.uploadFileWithConflictStrategy)(a,i,{name:n("PDF.name",{year:o}),contentType:"application/pdf",dirId:l,conflictStrategy:"rename"});case 11:return s=e.sent,u=s.data,e.abrupt("return",u);case 16:return e.prev=16,e.t0=e.catch(1),Mt()("error",e.t0,"savePdfCertificate"),e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),Yn=function(){var e=O()(C.a.mark((function e(t){var a,n,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.collection(m.c),e.next=3,a.findMyself();case 3:return n=e.sent,r=n.data,e.abrupt("return",r[0]);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vn=a("AHiN"),Wn=a("W5TB"),Kn=a("OEPu"),Jn=a("4jS1"),Xn=a("i5f2"),$n=a("dUf/"),er=a("gQXR"),tr=a("9Ub/"),ar=["data"],nr=function(e){var t=e.certificate,a=Object(H.e)(),o=a.t,i=a.lang,l=Object(g.useClient)(),u=Object(ge.b)().isMobile,d=Object(Ce.i)().year,m=Object(Ce.h)(),p=Object(n.useState)(!1),f=s()(p,2),b=f[0],v=f[1],y=R(),h=Object(g.useQuery)(y.definition,y.options),E=h.data,j=c()(h,ar);if(Object(g.isQueryLoading)(j))return null;var x=function(){var e=O()(C.a.mark((function e(){var t,a,n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),t=vn(),a=t.sourceIdentity,e.next=4,Yn(l);case 4:return n=e.sent,c=r.a.createElement(In,{t:o,username:Object(vt.getDisplayName)(n),daysToReach:fn(E),sourceIdentity:a,year:d,lang:i}),e.next=8,Hn({client:l,t:o,pdfDocument:c,year:d});case 8:v(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=o(t?"bikeGoal.certificateGeneration.actions.regenerate":"bikeGoal.certificateGeneration.actions.generate");return r.a.createElement("div",{className:kn.a["CertificateGeneration-root"]},r.a.createElement(xn,u&&{size:"medium"}),r.a.createElement(tr.a,{variant:"h4"},o("bikeGoal.certificateGeneration.title")),r.a.createElement(tr.a,{variant:"body2",className:"u-mv-1"},o("bikeGoal.certificateGeneration.content",{bountyAmount:bn(),year:d})),!!t&&!b&&r.a.createElement(er.a,{onClick:function(){m({pathname:"../certificate/".concat(t._id)})},className:"u-c-pointer"},r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,null,r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:Wn.a,size:32})),r.a.createElement($n.a,{primary:t.name})))),r.a.createElement(U.a,{variant:"text",label:w,className:"u-mt-half u-fz-xsmall",onClick:x,busy:b}))},rr=a("tRUj"),or=a("bQqJ"),ir=["data"],cr=function(){var e=Object(Ce.h)(),t=Object(ge.b)().isMobile,a=Object(H.e)().t,n={definition:Object(g.Q)(m.f).partialIndex({"cozyMetadata.createdByApp":"coachco2",class:"pdf",type:"file",trashed:!1}).indexFields(["cozyMetadata.updatedAt"]).sortBy([{"cozyMetadata.updatedAt":"desc"}]).limitBy(1),options:{as:m.f,fetchPolicy:y.a.fetchPolicies.olderThan(1e8)}},o=Object(g.useQuery)(n.definition,n.options),i=o.data,l=c()(o,ir),s=Object(g.isQueryLoading)(l);return r.a.createElement(rr.a,Ie()({open:!0,background:"var(--paperBackgroundColor) repeat-x url(".concat(Ge.a,")"),content:s?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(nr,{certificate:i[0]})},t?{onBack:function(){return e("..")}}:{onClose:function(){return e("..")}},{actions:r.a.createElement(U.a,{label:a("bikeGoal.certificateGeneration.actions.understood"),onClick:function(){return e("..")}}),actionsLayout:"column"}))},lr=a("lomp"),sr=a.n(lr),ur=a("nOWK"),dr=a.n(ur),mr=new sr.a({id:"pins-path_2d4c69ec9e779e37080be582b17e8596",use:"pins-path_2d4c69ec9e779e37080be582b17e8596-usage",viewBox:"0 0 96 96",content:'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 96 96" id="pins-path_2d4c69ec9e779e37080be582b17e8596"><g clip-path="url(#pins-path_2d4c69ec9e779e37080be582b17e8596_a)"><path stroke="#FFD799" stroke-linecap="round" stroke-width="8" d="M20 46h9.5C35.851 46 41 51.149 41 57.5v0C41 63.851 35.851 69 29.5 69h-14C9.149 69 4 74.149 4 80.5v0C4 86.851 9.149 92 15.5 92H72" /><path fill="#FFB64F" d="M96 48c0 11.267-17.34 32.28-22.542 38.33a1.908 1.908 0 0 1-2.916 0C65.341 80.28 48 59.268 48 48c0-13.255 10.745-24 24-24s24 10.745 24 24ZM35 16c0 7.19-10.594 20.336-14.541 24.984a1.904 1.904 0 0 1-2.918 0C13.594 36.336 3 23.19 3 16 3 7.163 10.163 0 19 0s16 7.163 16 16Z" /><circle cx="72" cy="48" r="8" fill="#F33136" /><circle cx="19" cy="16" r="5.333" fill="#F33136" /></g><defs><clipPath id="pins-path_2d4c69ec9e779e37080be582b17e8596_a"><path fill="#fff" d="M0 0h96v96H0z" /></clipPath></defs></symbol>'}),pr=(dr.a.add(mr),mr),fr=a("uRLs"),br=a.n(fr),vr=a("Jbzi"),gr=a("HCvV"),yr=a("ebeN"),hr=function(e){var t=e.label,a=e.subtitle,n=e.onBack,o=Object(ge.b)().isMobile,i=cozy.bar,c=i.BarCenter,l=i.BarLeft,s="function"==typeof n?n:void 0;return o?r.a.createElement(r.a.Fragment,null,s&&r.a.createElement(l,null,r.a.createElement(gr.a,{className:"u-mr-half",onClick:s,size:"medium"},r.a.createElement(Vn.a,{icon:yr.a,size:16}))),r.a.createElement(c,null,r.a.createElement(ye.a,{className:"u-w-100"},r.a.createElement(vr.a,null,t)))):r.a.createElement("div",{className:br()(d()({},"u-flex u-flex-items-baseline u-ml-2",s))},s&&r.a.createElement(gr.a,{className:"u-mr-half",onClick:s,size:"medium"},r.a.createElement(Vn.a,{icon:yr.a,size:16})),r.a.createElement("div",{className:br()("u-mv-1-half-s u-ml-1-s u-mv-2",d()({},"u-ml-2",!s))},r.a.createElement(tr.a,{variant:"h3"},t),a))};hr.propTypes={label:qe.a.string,subtitle:qe.a.node,onBack:qe.a.func};var Er=hr,Or=a("/5Aj"),jr=function(){var e=Object(H.e)().t,t=Object(ge.b)().isMobile,a=Object(Ce.h)(),n=G().account;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(Er,{label:e("trips.from")+" "+z(n)}),r.a.createElement(Or.a,{icon:pr,title:e("emptyContent.changeAccount.title"),text:e("emptyContent.changeAccount.text"),centered:!0},r.a.createElement(U.a,{className:"u-mt-1",variant:"secondary",label:e("emptyContent.changeAccount.action"),onClick:function(){return a("/settings")}})))},Cr=new sr.a({id:"location-detected_c862fbaed6fc77b32a0bbb165b330a48",use:"location-detected_c862fbaed6fc77b32a0bbb165b330a48-usage",viewBox:"0 0 128 128",content:'<symbol viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="location-detected_c862fbaed6fc77b32a0bbb165b330a48">\n<style>#location-detected_c862fbaed6fc77b32a0bbb165b330a48 .Ellipse_4_512 {\n\tanimation: 2s linear 0s infinite normal forwards running Ellipse_4_512;\n\t\trx: 48px;\n\t\try: 48px;\n\t\topacity: 0.08;\n}\n@keyframes Ellipse_4_512 {\n\t0% {\n\t\trx: 48px;\n\t\try: 48px;\n\t\topacity: 0.08;\n\t}\n\t100% {\n\t\trx: 64px;\n\t\try: 64px;\n\t\topacity: 0;\n\t}\n}#location-detected_c862fbaed6fc77b32a0bbb165b330a48 .Ellipse_3_966 {\n\tanimation: 2s linear 0s infinite normal forwards running Ellipse_3_966;\n\t\trx: 32px;\n\t\try: 32px;\n\t\topacity: 0.32;\n}\n@keyframes Ellipse_3_966 {\n\t0% {\n\t\trx: 32px;\n\t\try: 32px;\n\t\topacity: 0.32;\n\t}\n\t100% {\n\t\trx: 48px;\n\t\try: 48px;\n\t\topacity: 0.08;\n\t}\n}#location-detected_c862fbaed6fc77b32a0bbb165b330a48 .Ellipse_2_820 {\n\tanimation: 2s linear 0s infinite normal forwards running Ellipse_2_820;\n\t\trx: 16px;\n\t\try: 16px;\n\t\topacity: 1;\n}\n@keyframes Ellipse_2_820 {\n\t0% {\n\t\trx: 16px;\n\t\try: 16px;\n\t\topacity: 1;\n\t}\n\t100% {\n\t\trx: 32px;\n\t\try: 32px;\n\t\topacity: 0.32;\n\t}\n}#location-detected_c862fbaed6fc77b32a0bbb165b330a48 .Ellipse_1_774 {\n\tanimation: 2s linear 0s infinite normal forwards running Ellipse_1_774;\n\t\trx: 0px;\n\t\try: 0px;\n\t\topacity: 1;\n}\n@keyframes Ellipse_1_774 {\n\t0% {\n\t\trx: 0px;\n\t\try: 0px;\n\t\topacity: 1;\n\t}\n\t100% {\n\t\trx: 16px;\n\t\try: 16px;\n\t\topacity: 1;\n\t}\n}\n</style>\n<g width="128" height="128" data-name="illustrations/location-detected">\n\t<ellipse opacity="0.03656" fill="#297EF2" data-name="Ellipse 4" class="Ellipse_4_512" transform="translate(64 64)" rx="56.69" ry="56.69" />\n\t<ellipse opacity="0.18968" fill="#297EF2" data-name="Ellipse 3" class="Ellipse_3_966" transform="translate(64 64)" rx="40.69" ry="40.69" />\n\t<ellipse opacity="0.63076" fill="#297EF2" data-name="Ellipse 2" class="Ellipse_2_820" transform="translate(64 64)" rx="24.69" ry="24.69" />\n\t<ellipse fill="#297EF2" data-name="Ellipse 1" class="Ellipse_1_774" transform="translate(64 64)" rx="8.69" ry="8.69" />\n</g>\n</symbol>'}),xr=(dr.a.add(Cr),Cr),wr=function(){var e=Object(H.e)().t,t=Object(ge.b)().isMobile,a=G().account;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(Er,{label:e("trips.from")+" "+z(a)}),r.a.createElement(Or.a,{icon:xr,iconSize:"medium",title:e("emptyContent.GPSStandby.title"),text:e("emptyContent.GPSStandby.text"),centered:!0}))},kr=new sr.a({id:"cozy-cloud_f25eec6fb0f8dac9011726ebcb3b5c2a",use:"cozy-cloud_f25eec6fb0f8dac9011726ebcb3b5c2a-usage",viewBox:"0 0 128 96",content:'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 128 96" id="cozy-cloud_f25eec6fb0f8dac9011726ebcb3b5c2a"><path fill="#BBD9FD" fill-rule="evenodd" d="M38.15 93.955c2.147.763 7.653 1.424 12.09 1.688 12.119.722 29.052.33 36.23-.998 7.231-1.34 7.553-3.364-10.83-4.366-15.654-.854-33.926.363-37.833 2.175-1.049.487-.991 1.028.343 1.5Z" clip-rule="evenodd" /><path fill="#297EF1" fill-rule="evenodd" d="M68.641 13.698 42.583 19.09c-3.788.788-6.22 4.474-5.436 8.242l10.852 51.938c.784 3.773 4.493 6.186 8.278 5.413l26.062-5.413a6.962 6.962 0 0 0 5.432-8.242l-10.848-51.93c-.788-3.769-4.493-6.19-8.282-5.401Z" clip-rule="evenodd" /><path fill="#BBD9FD" fill-rule="evenodd" d="m80.66 62.672-29.485 6.115-8.385-40.122 29.493-6.106 8.377 40.113Zm-10.502 12.15a2.636 2.636 0 0 1-3.638.748 2.6 2.6 0 0 1-.748-3.618 2.72 2.72 0 0 1 3.634-.756 2.607 2.607 0 0 1 .76 3.618l-.008.008Z" clip-rule="evenodd" /><path fill="#fff" d="M97.828 0c-14.083 0-25.5 11.417-25.5 25.5l.003.345a25.496 25.496 0 0 0 13.273 22.04l.18.096.071-.122c-.38.64-.617 1.306-.617 1.967 0 1.424.679 2.62 2.05 3.099l.23.077c2.601.819 4.952.042 7.797-1.95l.217-.155.561.045a25.8 25.8 0 0 0 1.735.058c14.084 0 25.5-11.417 25.5-25.5S111.912 0 97.828 0Z" /><path fill="#BBD9FD" d="M97.828 0c-14.083 0-25.5 11.417-25.5 25.5l.003.345a25.496 25.496 0 0 0 13.273 22.04l.18.096.071-.122c-.38.64-.617 1.306-.617 1.967 0 1.424.679 2.62 2.05 3.099l.23.077c2.601.819 4.952.042 7.797-1.95l.217-.155.561.045a25.8 25.8 0 0 0 1.735.058c14.084 0 25.5-11.417 25.5-25.5S111.912 0 97.828 0Zm0 3c12.427 0 22.5 10.074 22.5 22.5S110.255 48 97.828 48c-.856 0-1.705-.048-2.547-.142l-.579-.066-.893.65c-2.24 1.608-3.823 2.172-5.372 1.703l-.16-.052c-.037-.013-.04-.018-.04-.267 0-.029.068-.218.181-.409l.061-.097a5.366 5.366 0 0 0 .723-1.677l.294-1.2-1.12-.518A22.501 22.501 0 0 1 75.328 25.5c0-12.426 10.074-22.5 22.5-22.5Z" /><path fill="#297EF2" d="M84 22.2c0-3.92 0-5.88.763-7.378a7 7 0 0 1 3.06-3.059C89.318 11 91.28 11 95.2 11h5.6c3.92 0 5.881 0 7.378.763a7 7 0 0 1 3.059 3.06C112 16.318 112 18.28 112 22.2v5.6c0 3.92 0 5.88-.763 7.378a7 7 0 0 1-3.059 3.059C106.681 39 104.72 39 100.8 39h-5.6c-3.92 0-5.88 0-7.378-.763a7 7 0 0 1-3.059-3.06C84 33.682 84 31.72 84 27.8v-5.6Z" /><path fill="#fff" fill-rule="evenodd" d="M101.07 27.836a.515.515 0 0 1-.759.11c-.66.518-1.471.8-2.316.8-.842 0-1.652-.281-2.31-.796l-.052.035a.516.516 0 0 1-.703-.147.507.507 0 0 1 .144-.693c.198-.13.212-.39.212-.393a.514.514 0 0 1 .163-.357.467.467 0 0 1 .358-.134.504.504 0 0 1 .49.512c0 .004-.001.142-.051.333a2.737 2.737 0 0 0 3.506-.007 1.637 1.637 0 0 1-.05-.318.505.505 0 0 1 .497-.52h.009c.273 0 .499.22.505.493 0 0 .015.261.211.39.229.152.294.461.146.692Zm2.151-5.9a5.5 5.5 0 0 0-1.565-3.249 5.237 5.237 0 0 0-7.466.001 5.5 5.5 0 0 0-1.568 3.265 5.26 5.26 0 0 0-3.18 1.609 5.528 5.528 0 0 0-1.522 3.833c0 3.022 2.394 5.48 5.338 5.48h9.483c2.943 0 5.339-2.458 5.339-5.48 0-2.856-2.14-5.21-4.859-5.46Z" clip-rule="evenodd" /></symbol>'}),_r=(dr.a.add(kr),kr),Dr=a("aCpG"),Pr=function(){var e=Object(n.useState)(!1),t=s()(e,2),a=t[0],o=t[1],i=Object(H.e)().t,c=Object(ge.b)().isMobile,l=Object(g.useClient)();return r.a.createElement(r.a.Fragment,null,c&&r.a.createElement(Er,{label:l.appMetadata.slug}),r.a.createElement(Or.a,{icon:_r,title:i("emptyContent.installApp.title"),text:i("emptyContent.installApp.text"),centered:!0},r.a.createElement(U.a,{className:"u-mt-1",label:i("emptyContent.installApp.action"),onClick:function(){return o(!0)}})),a&&r.a.createElement(Dr.a,{onClose:function(){return o(!1)}}))},Tr=a("eCKa"),Sr=function(){var e=Object(H.e)().t,t=Object(ge.b)().isMobile,a=Object(g.useClient)(),n=de().checkPermissionsAndEnableTrackingOrShowDialog;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(Er,{label:a.appMetadata.slug}),r.a.createElement(Or.a,{"data-testid":"EmptyContent",className:t?"u-p-1":"u-flex-justify-start u-p-3",icon:r.a.createElement(Tr.a,{app:"coachco2"}),iconSize:"large",title:e("emptyContent.welcome.title"),text:e("emptyContent.welcome.text"),centered:!0},r.a.createElement(U.a,{className:"u-mt-1",label:e("emptyContent.welcome.action"),onClick:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))})))};function Mr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ar(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Mr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Nr=function(e){return e.map((function(e){return e._id})).reduce((function(e,t){var a,n=(a=t,{definition:Object(g.Q)(m.g).where({"cozyMetadata.sourceAccount":a}).select(["cozyMetadata.sourceAccount"]).limitBy(1),options:{as:"".concat(m.g,"/hasTimeseries/sourceAccount/").concat(a),fetchPolicy:y.a.fetchPolicies.olderThan(3e4)}});return e[t]=Ar(Ar({},n.options),{},{query:n.definition}),e}),{})},Lr=function(e){var t=e.account,a=e.accounts,n=de(),o=n.isGeolocationTrackingAvailable,i=n.isGeolocationTrackingEnabled,c=a.filter((function(e){return e._id!==t._id})),l=Nr(c),s=Object(g.useQueries)(l);return Object(g.isQueriesLoading)(s)?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):Object.values(s).some((function(e){return e.data.length>0}))?r.a.createElement(jr,null):o?i?r.a.createElement(wr,null):r.a.createElement(Sr,null):r.a.createElement(Pr,null)},Rr=function(){var e=Object(H.e)().t,t=Object(ge.b)().isMobile,a=Object(g.useClient)();return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(Er,{label:a.appMetadata.slug}),r.a.createElement(Or.a,{className:t?"u-p-1":"u-flex-justify-start u-p-3",icon:r.a.createElement(Tr.a,{app:"coachco2"}),iconSize:"large",title:e("emptyContent.installKonnector.title"),text:e("emptyContent.installKonnector.text"),centered:!0}))},Fr=function(e){var t=e.account,a=e.accounts,n=e.isAccountLoading,o=e.isTimeseriesLoading,i=e.timeseries;return n||o?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):0===a.length?r.a.createElement(Rr,null):0===i.length?r.a.createElement(Lr,{account:t,accounts:a}):void 0};Fr.propTypes={account:qe.a.object,isAccountLoading:qe.a.bool,isTimeseriesLoading:qe.a.bool,timeseries:qe.a.arrayOf(qe.a.object)};var Ir=Fr,Br=a("eson"),Gr=["days","label","color","isSuccess","body1"],zr=["data"],qr=function(e){return{color:e&&"var(--successColor)"}},Zr=function(e){var t=e.days,a=e.label,n=e.color,o=e.isSuccess,i=e.body1,l=c()(e,Gr),s=Object(H.e)().t,u=R(),d=Object(g.useQuery)(u.definition,u.options),m=d.data,p=c()(d,zr);return Object(g.isQueryLoading)(p)?null:r.a.createElement("div",l,r.a.createElement(Vn.a,{className:"u-mr-half",icon:Br.a,color:n,size:8}),r.a.createElement(tr.a,{display:"inline",variant:i?"body1":"caption",color:"textPrimary",style:qr(o)},s("bikeGoal.goal_progression",{days:t,daysToReach:fn(m)})),r.a.createElement(tr.a,{variant:"caption",style:qr(o)},a))};Zr.defaultProps={color:"#BA5AE8"};var Ur=Zr,Qr=a("xr2j"),Hr=["data"],Yr=function(e){var t=e.className,a=e.timeseries,n=e.body1,o=e.componentsProps,i=Object(H.e)().t,l=R(),s=Object(g.useQuery)(l.definition,l.options),u=s.data,d=c()(s,Hr);return Object(g.isQueryLoading)(d)?null:r.a.createElement("div",{className:"u-flex ".concat(t)},r.a.createElement(Ur,Ie()({},o.BikeGoalSummaryItem,{days:yn(a,u),label:i("bikeGoal.my_progression"),isSuccess:gn(a,u),body1:n})),r.a.createElement(Qr.a,{className:"u-mh-1",style:{marginTop:4},orientation:"vertical",flexItem:!0}),r.a.createElement(Ur,Ie()({},o.BikeGoalSummaryItem,{days:.5,label:i("bikeGoal.average_progression"),color:"#BA5AE83D",body1:n})))};Yr.defaultProps={className:"",componentsProps:{}};var Vr=Yr,Wr=["data"],Kr=function(e){var t=e.timeseriesByYear,a=e.settings;return{whiteSpace:e.preLine&&"pre-line",color:gn(t,a)&&"var(--successColor)"}},Jr=function(e){var t=e.className,a=e.timeseriesByYear,n=e.variant,o=e.preLine,i=Object(H.e)().t,l=R(),s=Object(g.useQuery)(l.definition,l.options),u=s.data,d=c()(s,Wr);return Object(g.isQueryLoading)(d)?null:r.a.createElement(tr.a,{className:t,variant:n,style:Kr({timeseriesByYear:a,settings:u,preLine:o})},i("bikeGoal.yearly_goal_progression",{days:yn(a,u),daysToReach:fn(u)}))},Xr=a("Yb2N"),$r=a("PExr"),eo=["data"],to={BikeGoalSummaryItem:{flex:"1 1 0"}},ao=function(e){var t=e.className,a=e.timeseries,n=e.sendToDACC,o=Object(H.e)().t,i=Object(ge.b)().isMobile,l=Object(Ce.h)(),s=R(),u=Object(g.useQuery)(s.definition,s.options),d=u.data,m=c()(u,eo);if(Object(g.isQueryLoading)(m))return null;return r.a.createElement("div",{className:t},i&&r.a.createElement(tr.a,{className:"u-mb-half",variant:"h3"},o("bikeGoal.title")),n?r.a.createElement(Vr,{className:br()("u-mt-half",{"u-ph-1 u-ta-center":i}),timeseries:a,body1:i,componentsProps:{BikeGoalSummaryItem:to.BikeGoalSummaryItem}}):r.a.createElement(Jr,{className:"u-mt-half",timeseriesByYear:a}),gn(a,d)&&r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(Xr.a,{icon:r.a.createElement(Vn.a,{icon:$r.a,className:"u-ml-half"}),label:o("bikeGoal.achievement_certificate"),color:"success",clickable:!0,onClick:function(){l("certificate/generate")}})))};ao.propTypes={className:qe.a.string,timeseries:qe.a.arrayOf(qe.a.object).isRequired};var no=ao,ro=a("J14j"),oo=a("o1F1"),io=Object(n.forwardRef)((function(e,t){var a=e.label,n=e.onClick;return Object(ge.b)().isMobile?r.a.createElement(ro.a,{textVariant:"h6",onClick:n},a):r.a.createElement(U.a,{ref:t,variant:"secondary",label:a,endIcon:r.a.createElement(Vn.a,{icon:oo.a,size:14}),onClick:n})}));io.displayName="ActionButton",io.propTypes={label:qe.a.string,onClick:qe.a.func};var co=io,lo=a("lAlC"),so=a("/gvb"),uo=a("hAvo"),mo=function(e){var t=e.timeseries,a=Object(Ce.i)().year,o=Object(Ce.h)(),i=Object(n.useRef)(),c=Object(n.useState)(!1),l=s()(c,2),u=l[0],d=l[1],m=Object(n.useMemo)((function(){return function(e){var t=new Date;if(!e||0===e.length)return[t.getFullYear().toString()];var a=new Date(function(e){return e.reduce((function(e,t){return e.startDate<t.startDate?e:t}))}(e).startDate),n=Object(lo.a)(t,a);return Array.from({length:n+1},(function(e,a){return Object(D.a)(t,a).getFullYear().toString()}))}(t)}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(co,{ref:i,label:a,onClick:function(){return d((function(e){return!e}))}}),u&&r.a.createElement(so.a,{anchorElRef:i,autoclose:!0,onClose:function(){return d(!1)},popperOptions:{placement:"bottom-end"}},m.map((function(e,t){return r.a.createElement(uo.a,{key:t,onClick:function(){return o("/bikegoal/".concat(e,"/trips"))}},e)}))))};mo.propTypes={timeseries:qe.a.arrayOf(qe.a.object).isRequired};var po=r.a.memo(mo),fo=Object(n.forwardRef)((function(e,t){var a=e.label,n=e.onClick;return Object(ge.b)().isMobile?r.a.createElement(gr.a,{onClick:n},a):r.a.createElement(U.a,{ref:t,className:"u-miw-auto u-ml-half",variant:"secondary",label:a,onClick:n})}));fo.displayName="ActionButton",fo.propTypes={label:qe.a.node,onClick:qe.a.func};var bo=fo,vo=["data"];function go(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function yo(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?go(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):go(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ho=function(e){var t=Object(g.useClient)(),a=R(),n=Object(g.useQuery)(a.definition,a.options),r=n.data,o=c()(n,vo),i=Object(g.isQueryLoading)(o);return{isLoading:i,value:i?void 0:r&&r[0]?Je()(r[0],e):void 0,save:function(){var a=O()(C.a.mark((function a(n){var o;return C.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=yo(yo({},r[0]),{},{_type:m.j}),nt()(o,e,n),a.next=4,t.save(o);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}},Eo=function(e){var t=e.open,a=e.onClose,o=Object(H.e)().t,i=Object(Ce.h)(),c=ho("bikeGoal.activated"),l=c.isLoading,u=c.save,d=Object(n.useState)(!1),m=s()(d,2),p=m[0],f=m[1];return r.a.createElement(Q.a,{open:t,title:o("bikeGoal.deactivate.title"),content:o("bikeGoal.deactivate.content"),actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{variant:"secondary",label:o("bikeGoal.deactivate.cancel"),onClick:a}),r.a.createElement(U.a,{color:"error",label:o("bikeGoal.deactivate.stop_participate"),busy:p||l,onClick:function(){f(!0),u(!1),i("/trips")}})),onClose:a})};Eo.propTypes={open:qe.a.bool.isRequired,onClose:qe.a.func.isRequired};var Oo=Eo,jo=a("vc9t"),Co=a("jMeN"),xo=a("KsnS"),wo=a("QRbe"),ko=function(){var e=Object(H.e)().t,t=Object(ge.b)().isMobile,a=Object(n.useRef)(),o=Object(Ce.h)(),i=Object(n.useState)(!1),c=s()(i,2),l=c[0],u=c[1],d=Object(n.useState)(!1),m=s()(d,2),p=m[0],f=m[1],b={divider:{borderTop:0,marginLeft:{isMobile:t}.isMobile?"3rem":void 0}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(bo,{ref:a,label:r.a.createElement(Vn.a,{icon:jo.a}),onClick:function(){return u((function(e){return!e}))}}),l&&r.a.createElement(so.a,{anchorElRef:a,autoclose:!0,onClose:function(){return u(!1)},popperOptions:{placement:"bottom-end"}},r.a.createElement(uo.a,{left:r.a.createElement(Vn.a,{icon:wo.a}),onClick:function(){return o("edit")}},e("bikeGoal.edit.modify")),r.a.createElement(uo.a,{left:r.a.createElement(Vn.a,{icon:xo.a}),onClick:function(){return o("about")}},e("bikeGoal.about.title")),r.a.createElement(Qr.a,{style:b.divider}),r.a.createElement(uo.a,{left:r.a.createElement(Vn.a,{icon:Co.a}),onClick:function(){return f(!0)}},e("bikeGoal.deactivate.deactivate"))),r.a.createElement(Oo,{open:p,onClose:function(){return f(!1)}}))};po.propTypes={timeseries:qe.a.arrayOf(qe.a.object).isRequired};var _o=function(e){var t=e.timeseries,a=Object(ge.b)().isMobile,n={actions:{right:{isMobile:a}.isMobile?0:"13rem"}};return r.a.createElement("div",{className:br()("u-flex u-flex-justify-end",{"u-pos-absolute u-top-m":!a}),style:n.actions},r.a.createElement(po,{timeseries:t}),r.a.createElement(ko,null))},Do=a("Ht4I"),Po=a("Qugh"),To=a("kjpz"),So=function(e){var t=e.icon,a=e.color,n=e.faded,o=e.ghost,i=function(e){var t=e.faded,a=e.color;return t?{color:a||"var(--primaryColor)",backgroundColor:"var(--paperBackgroundColor)",border:"1px solid var(--borderMainColor)"}:{backgroundColor:a}}({faded:n,color:a});return r.a.createElement(Po.b,{style:i,icon:t,size:32,ghost:o})},Mo=function(e){var t=e.attribute;return r.a.createElement(So,{icon:ca(t),color:la(t),ghost:t===P.ab})},Ao=function(e){var t=e.attribute,a=e.defaultColor,n=Object(To.a)();return r.a.createElement(So,{icon:ra(t),color:a?n.palette.primary.main:oa(t),faded:!0})},No=a("Mb5X"),Lo=a("MRub"),Ro={co2:{fontWeight:700,whiteSpace:"nowrap",marginRight:"-1rem"},tripIcon:{marginRight:"4px"}},Fo=function(e){var t=e.tripModeIcons,a=e.duration,n=e.distance;return r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return r.a.createElement(Vn.a,{key:t,icon:e,size:10,style:Ro.tripIcon})})),"· ".concat(a," · ").concat(n))},Io=function(e){var t=e.timeserie,a=e.hasDateHeader,o=Object(H.e)().f,i=Object(Ce.g)(),c=Object(Ce.h)(),l=Object(Ce.i)().mode,s=Object(ge.c)().isMobile,u=qa(t),d=en(t),m=function(e){return dt()(e.aggregation.sections.sort((function(e,t){return e.distance>t.distance?-1:1})).map((function(e){return e.mode})).filter(Boolean))}(t),p=tn(t),f=Object(n.useMemo)((function(){return l?sn(t,l):an(t)}),[t,l]),b=Object(n.useMemo)((function(){return m.map((function(e){return ra(e)}))}),[m]);return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement(Lo.a,null,o(Ua(t),"dddd DD MMMM")),r.a.createElement(Jn.b,{button:!0,onClick:function(){c("".concat(i.pathname,"/").concat(t._id))}},r.a.createElement(Xn.a,null,r.a.createElement(Mo,{attribute:u})),r.a.createElement($n.a,{primary:$a(t,s)||Va(t),secondary:r.a.createElement(Fo,{tripModeIcons:b,duration:d,distance:p})}),r.a.createElement(tr.a,{style:Ro.co2,variant:"body2"},f),r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:No.a,color:"var(--secondaryTextColor)"}))),r.a.createElement(Qr.a,null))};Io.propTypes={timeserie:qe.a.object.isRequired,hasDateHeader:qe.a.bool.isRequired};var Bo=r.a.memo(Io,(function(e,t){return e.timeserie._rev===t.timeserie._rev}));Bo.displayName="MemoizedTripItem";var Go=Bo,zo=function(e){var t=e.timeseries,a=e.noHeader,o=Object(ge.b)().isMobile,i=Object(H.e)().t,c=Object(n.useCallback)((function(e,a){return 0===a||!Object(Do.a)(Ua(e),Ua(t[a-1]))}),[t]);return r.a.createElement(r.a.Fragment,null,o&&!a&&r.a.createElement(er.a,{className:"u-ph-1",style:{height:"4rem",display:"flex",alignItems:"center"},square:!0},r.a.createElement(tr.a,{variant:"h5"},i("trips.trips"))),r.a.createElement(Kn.a,null,t.map((function(e,t){return r.a.createElement(Go,{key:"".concat(e.id).concat(t),timeserie:e,hasDateHeader:c(e,t)})}))))};zo.propTypes={timeseries:qe.a.arrayOf(qe.a.object).isRequired,noHeader:qe.a.bool};var qo=zo,Zo=a("13md"),Uo=function(e){var t=e.className,a=e.timeseries,n=e.hasMore,o=e.fetchMore,i=Object(H.e)().t;return r.a.createElement("div",{className:t},r.a.createElement(qo,{timeseries:a,noHeader:!0}),n&&r.a.createElement(Zo.a,{label:i("loadMore"),fetchMore:o}))};Uo.propTypes={className:qe.a.string,timeseries:qe.a.arrayOf(qe.a.object).isRequired,hasMore:qe.a.bool,fetchMore:qe.a.func};var Qo=Uo,Ho=function(e){var t=e.timeseries,a=e.timeseriesQueryLeft,n=e.sendToDACC,o=Object(Ce.h)(),i=Object(Ce.i)().year,c=dn(t,i);return r.a.createElement(rr.a,{open:!0,onClose:function(){return o("/trips")},disableGutters:!0,componentsProps:{dialogTitle:{className:"u-p-0"}},title:r.a.createElement(_o,{timeseries:t}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(xn,{display:"flex",paddingTop:"1.5rem",marginTop:"3rem",timeseries:c,sendToDACC:n}),r.a.createElement(no,{className:"u-flex u-flex-column u-flex-items-center",timeseries:c,sendToDACC:n}),r.a.createElement(Qo,{className:"u-mt-2",timeseries:c,hasMore:a.hasMore,fetchMore:a.fetchMore}))})};Ho.propTypes={timeseries:qe.a.arrayOf(qe.a.object).isRequired,timeseriesQueryLeft:qe.a.object.isRequired};var Yo=Ho,Vo=function(e){var t=e.timeseries,a=e.timeseriesQueryLeft,n=e.sendToDACC,o=Object(H.e)().t,i=Object(Ce.h)(),c=Object(Ce.i)().year,l=dn(t,c);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Er,{label:o("bikeGoal.title"),subtitle:r.a.createElement(no,{timeseries:l,sendToDACC:n}),onBack:function(){return i("/trips")}}),r.a.createElement(_o,{timeseries:t}),r.a.createElement(xn,{display:"flex",position:"absolute",top:"2rem",right:"2rem",timeseries:l,sendToDACC:n}),r.a.createElement(Qo,{className:"u-mt-3",timeseries:l,hasMore:a.hasMore,fetchMore:a.fetchMore}))};Vo.propTypes={timeseries:qe.a.arrayOf(qe.a.object).isRequired,timeseriesQueryLeft:qe.a.object.isRequired};var Wo=Vo,Ko=["data"],Jo=["data"],Xo=function(){var e,t=G(),a=t.account,n=t.accounts,o=t.isAccountLoading,i=Object(ge.b)().isMobile,l=R(),s=Object(g.useQuery)(l.definition,l.options),u=s.data,d=c()(s,Ko),m=Object(g.isQueryLoading)(d),p=N({accountId:null==a?void 0:a._id},Boolean(a)),f=Object(g.useQueryAll)(p.definition,p.options),b=f.data,v=c()(f,Jo),y=Object(g.isQueryLoading)(v)||v.hasMore;if(m||o||!a||y||0===b.length)return r.a.createElement(Ir,{account:a,accounts:n,isAccountLoading:o,isTimeseriesLoading:y,timeseries:b});var h=!(null==u||null===(e=u[0].bikeGoal)||void 0===e||!e.sendToDACC);return i?r.a.createElement(Yo,{timeseries:b,timeseriesQueryLeft:v,sendToDACC:h}):r.a.createElement(Wo,{timeseries:b,timeseriesQueryLeft:v,sendToDACC:h})},$o=function(){var e=Object(H.e)().t,t=Object(Ce.h)(),a=bn(),n={typography:{whiteSpace:"pre-line"}};return r.a.createElement(rr.a,{open:!0,title:e("bikeGoal.about.title"),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{className:"u-mb-1",variant:"h5"},e("bikeGoal.about.intro.title")),r.a.createElement(tr.a,{variant:"body1",style:n.typography},e("bikeGoal.about.intro.content",{bountyAmount:a})),r.a.createElement(tr.a,{className:"u-mt-1-half u-mb-1",variant:"h5"},e("bikeGoal.about.how_trips_detected.title")),r.a.createElement(tr.a,{variant:"body1",style:n.typography},e("bikeGoal.about.how_trips_detected.content")),r.a.createElement(tr.a,{className:"u-mt-1-half u-mb-1",variant:"h5"},e("bikeGoal.about.once_goal_reach.title")),r.a.createElement(tr.a,{variant:"body1",style:n.typography},e("bikeGoal.about.once_goal_reach.content"))),onClose:function(){return t("..")}})},ei=a("UuKj"),ti=function(e){var t=e.itemName,a=e.onClose,o=Object(H.e)().t,i=ho("bikeGoal.".concat(t)),c=i.isLoading,l=i.value,u=i.save,d=Object(n.useState)(l),m=s()(d,2),p=m[0],f=m[1],b=Object(n.useState)(!1),v=s()(b,2),g=v[0],y=v[1],h="daysToReach"===t,E=!p||h&&p<=0,j=!p||h&&p<=0,x=p?h&&j?o("bikeGoal.onboarding.steps.daysToReach.error"):" ":o("bikeGoal.edit.required"),w=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,u(p);case 3:a();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Q.a,{open:!0,title:o("bikeGoal.edit.".concat(t)),content:c?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(ei.a,{variant:"outlined",marging:"normal",type:h?"number":void 0,inputProps:h?{min:"1",step:"1"}:void 0,defaultValue:p,required:!0,fullWidth:!0,error:j,helperText:x,onChange:function(e){return f(e.target.value)}}),actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{variant:"secondary",label:o("bikeGoal.edit.cancel"),onClick:a}),r.a.createElement(U.a,{className:"u-miw-4",label:o("bikeGoal.edit.submit"),busy:g,disabled:E,onClick:w})),onClose:a})};ti.propTypes={itemName:qe.a.string.isRequired,onClose:qe.a.func.isRequired};var ai=ti,ni=a("uiSW"),ri=a("MzjA"),oi=a("EMSc");function ii(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ci(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ii(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ii(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var li=function(){var e=Object(H.e)().t,t=Object(n.useState)(""),a=s()(t,2),o=a[0],i=a[1],c=ho("bikeGoal"),l=c.isLoading,u=c.value,d=c.save,m=function(){d(ci(ci({},u),{},{sendToDACC:!u.sendToDACC}))};return l?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,{button:!0,onClick:function(){return i("lastname")}},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:Yt.a})),r.a.createElement($n.a,{primary:r.a.createElement(tr.a,{variant:"caption"},e("bikeGoal.edit.lastname")),secondary:r.a.createElement(tr.a,{variant:"body1"},u.lastname)})),r.a.createElement(Qr.a,{component:"li",variant:"inset"}),r.a.createElement(Jn.b,{button:!0,onClick:function(){return i("firstname")}},r.a.createElement(Xn.a,null),r.a.createElement($n.a,{primary:r.a.createElement(tr.a,{variant:"caption"},e("bikeGoal.edit.firstname")),secondary:r.a.createElement(tr.a,{variant:"body1"},u.firstname)})),r.a.createElement(Qr.a,{component:"li",variant:"inset"}),r.a.createElement(Jn.b,{button:!0,onClick:function(){return i("daysToReach")}},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:It.a})),r.a.createElement($n.a,{primary:r.a.createElement(tr.a,{variant:"caption"},e("bikeGoal.edit.daysToReach")),secondary:r.a.createElement(tr.a,{variant:"body1"},u.daysToReach)})),r.a.createElement(Qr.a,{component:"li",variant:"inset"}),r.a.createElement(Jn.b,{ellipsis:!1,button:!0,onClick:m},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:ni.a})),r.a.createElement($n.a,{primary:e("bikeGoal.edit.compare_progress")}),r.a.createElement(ri.a,null,r.a.createElement(oi.a,{className:"u-w-auto",color:"primary",checked:u.sendToDACC,onChange:m})))),Boolean(o)&&r.a.createElement(ai,{itemName:o,onClose:function(){return i("")}}))},si=function(){var e=Object(H.e)().t,t=Object(Ce.h)();return r.a.createElement(rr.a,{open:!0,disableGutters:!0,title:e("bikeGoal.edit.title"),content:r.a.createElement(li,null),onClose:function(){return t("..")}})},ui=new sr.a({id:"dacc-permissions_3573ba0684a43d6d3596ae2974a0613d",use:"dacc-permissions_3573ba0684a43d6d3596ae2974a0613d-usage",viewBox:"0 0 106 106",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106" id="dacc-permissions_3573ba0684a43d6d3596ae2974a0613d"><g filter="url(#dacc-permissions_3573ba0684a43d6d3596ae2974a0613d_a)"><path d="M16 48c0-19.882 16.118-36 36-36s36 16.118 36 36-16.118 36-36 36-36-16.118-36-36Z" fill="#fff" /></g><path d="M65.11 37.39C63.962 31.193 58.53 26.5 52 26.5c-6.53 0-11.962 4.693-13.11 10.89C32.693 38.538 28 43.97 28 50.5c0 7.364 5.97 13.333 13.333 13.333H62.667C70.03 63.833 76 57.863 76 50.5c0-6.53-4.693-11.962-10.89-13.11Z" fill="#B3D3FF" /><path d="M49.569 36c.837 0 1.528.63 1.622 1.443l.011.19v10.941a.49.49 0 0 0 .377.477l.113.013h.653c.27 0 .49-.22.49-.49v-9.308l.011-.19a1.633 1.633 0 0 1 3.244 0l.011.19v9.308a.49.49 0 0 0 .377.477l.113.013h.653c.27 0 .49-.22.49-.49v-6.042l.011-.19a1.633 1.633 0 0 1 3.244 0l.011.19v16.33a6.527 6.527 0 0 1-3 5.495V67a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2.615a6.69 6.69 0 0 1-1.022-.78l-8.425-7.824a1.73 1.73 0 0 1-.262-2.226 1.538 1.538 0 0 1 2.075-.463l4.67 2.827V40.9l.012-.19a1.633 1.633 0 0 1 3.244 0l.01.19v7.675a.49.49 0 0 0 .378.477l.112.013h.654c.27 0 .49-.22.49-.49V37.633l.01-.19A1.633 1.633 0 0 1 49.57 36Z" fill="#297EF2" /><g filter="url(#dacc-permissions_3573ba0684a43d6d3596ae2974a0613d_b)"><rect x="58" y="54" width="32" height="32" rx="8" fill="#fff" /><path d="M72.409 77.886c.2-.05.404.072.455.273l.375 1.5c.007.03.011.061.011.091h1.5c0-.03.004-.06.011-.091l.375-1.5a.375.375 0 1 1 .728.182l-.364 1.455v1.454a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1-.75-.75v-1.454l-.364-1.455a.375.375 0 0 1 .273-.455Z" fill="#F33136" /><path d="M72.5 78.25c-.414 0-.765-.351-.988-.7-.408-.64-1.3-1.334-2.346-2.147C66.746 73.523 63.5 71 63.5 67c0-4.97 4.701-9 10.5-9v20.25h-1.5Z" fill="#F33136" /><path d="M74 78.25h-1.286c0-.838-.654-1.73-1.476-2.847C69.855 73.523 68 71 68 67c0-4.97 2.686-9 6-9v20.25Z" fill="#FC7B0E" /><path d="M75.5 78.25c.414 0 .765-.351.988-.7.408-.64 1.3-1.334 2.346-2.147C81.254 73.523 84.5 71 84.5 67c0-4.97-4.701-9-10.5-9v20.25h1.5Z" fill="#FFD799" /><path d="M74 78.25h1.286c0-.838.654-1.73 1.476-2.847C78.145 73.523 80 71 80 67c0-4.97-2.686-9-6-9v20.25Z" fill="#FFB64F" /></g><defs><filter id="dacc-permissions_3573ba0684a43d6d3596ae2974a0613d_a" x="0" y="0" width="104" height="104" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="4"></feOffset><feGaussianBlur stdDeviation="8"></feGaussianBlur><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.06 0"></feColorMatrix><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_754_48957"></feBlend><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="2"></feOffset><feGaussianBlur stdDeviation="2"></feGaussianBlur><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.0793047 0"></feColorMatrix><feBlend in2="effect1_dropShadow_754_48957" result="effect2_dropShadow_754_48957"></feBlend><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feMorphology radius=".5" operator="dilate" in="SourceAlpha" result="effect3_dropShadow_754_48957"></feMorphology><feOffset></feOffset><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"></feColorMatrix><feBlend in2="effect2_dropShadow_754_48957" result="effect3_dropShadow_754_48957"></feBlend><feBlend in="SourceGraphic" in2="effect3_dropShadow_754_48957" result="shape"></feBlend></filter><filter id="dacc-permissions_3573ba0684a43d6d3596ae2974a0613d_b" x="42" y="42" width="64" height="64" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="4"></feOffset><feGaussianBlur stdDeviation="8"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.113725 0 0 0 0 0.129412 0 0 0 0 0.164706 0 0 0 0.06 0"></feColorMatrix><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_754_48957"></feBlend><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="2"></feOffset><feGaussianBlur stdDeviation="2"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.113725 0 0 0 0 0.129412 0 0 0 0 0.164706 0 0 0 0.0793047 0"></feColorMatrix><feBlend in2="effect1_dropShadow_754_48957" result="effect2_dropShadow_754_48957"></feBlend><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feMorphology radius=".5" operator="dilate" in="SourceAlpha" result="effect3_dropShadow_754_48957"></feMorphology><feOffset></feOffset><feColorMatrix values="0 0 0 0 0.113725 0 0 0 0 0.129412 0 0 0 0 0.164706 0 0 0 0.12 0"></feColorMatrix><feBlend in2="effect2_dropShadow_754_48957" result="effect3_dropShadow_754_48957"></feBlend><feBlend in="SourceGraphic" in2="effect3_dropShadow_754_48957" result="shape"></feBlend></filter></defs></symbol>'}),di=(dr.a.add(ui),ui),mi=new sr.a({id:"icon-anonymous_f9180197246a84316517b8157ef006c8",use:"icon-anonymous_f9180197246a84316517b8157ef006c8-usage",viewBox:"0 0 16 16",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-anonymous_f9180197246a84316517b8157ef006c8"><path d="M4.36 1.24 3 6H1a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2h-2l-1.36-4.76A1.7 1.7 0 0 0 9.062.291L8 1 6.938.292a1.7 1.7 0 0 0-2.578.947Z" /><path fill-rule="evenodd" clip-rule="evenodd" d="M6.84 13.549A3.502 3.502 0 0 1 0 12.5a3.5 3.5 0 0 1 6.76-1.274A3.49 3.49 0 0 1 8 11c.436 0 .854.08 1.24.226a3.501 3.501 0 1 1-.08 2.323A1.495 1.495 0 0 0 8 13c-.467 0-.883.212-1.16.549ZM3.5 14a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm9 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" /></symbol>'}),pi=(dr.a.add(mi),mi),fi=new sr.a({id:"icon-export_a08eff636b3b69e5d1cfc230029cdad8",use:"icon-export_a08eff636b3b69e5d1cfc230029cdad8-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-export_a08eff636b3b69e5d1cfc230029cdad8"><path d="M7.165 8.244C7.585 6.01 9.581 4.297 12 4.297s4.415 1.713 4.835 3.947l.143.76.76.14c2.295.418 4.012 2.396 4.012 4.748 0 .555-.096 1.089-.272 1.586l1.704 1.704a6.98 6.98 0 0 0 .818-3.29c0-3.222-2.173-5.925-5.131-6.79C17.984 4.17 15.236 2.047 12 2.047c-3.236 0-5.984 2.123-6.869 5.055C2.173 7.967 0 10.67 0 13.892c0 3.926 3.224 7.08 7.167 7.08H8.25v-2.25H7.167c-2.731 0-4.917-2.177-4.917-4.83 0-2.352 1.717-4.33 4.012-4.749l.76-.139.143-.76Z" fill="#1D212A" fill-opacity=".72" /><path d="M19.499 19.567a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1 0-3h2.368l-4.993-4.993a1.508 1.508 0 0 1 2.018-2.236l.114.104 4.993 4.992v-2.367a1.5 1.5 0 1 1 3 0v6Z" fill="#EA3F3F" /></symbol>'}),bi=(dr.a.add(fi),fi),vi=function(e){var t=e.sharedDataLabel,a=e.open,n=e.onClose,o=e.onRefuse,i=e.onAccept,c=e.showDaccReasonsDialog,l=Object(H.e)().t;return r.a.createElement(ye.a,{variant:"inverted"},r.a.createElement(Q.a,{open:a,onClose:n,content:r.a.createElement("div",{className:"u-ta-center"},r.a.createElement(Vn.a,{icon:di,size:106}),r.a.createElement(tr.a,{variant:"h4"},l("dacc.permissionsDialog.title")),r.a.createElement(tr.a,{className:"u-mt-1"},l("dacc.permissionsDialog.primaryText")),r.a.createElement(ye.a,{variant:"normal"},r.a.createElement(er.a,{className:"u-mt-1-half",elevation:0},r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,{divider:!0},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:bi,size:24})),r.a.createElement($n.a,{primary:r.a.createElement(tr.a,{variant:"h6"},l("dacc.permissionsDialog.export_outside"))})),r.a.createElement(Jn.b,{dense:!0},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:pi,color:"var(--iconTextColor)"})),r.a.createElement($n.a,{primary:r.a.createElement(tr.a,{variant:"body2"},t)}))))),r.a.createElement(tr.a,{className:"u-mt-1-half",style:{textDecoration:"underline"},onClick:c},l("dacc.permissionsDialog.why_asking")),r.a.createElement(tr.a,{className:"u-mt-1-half",variant:"caption",color:"textPrimary"},l("dacc.permissionsDialog.secondaryText"))),actionsLayout:"column",actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{label:l("dacc.permissionsDialog.refuse"),onClick:o}),r.a.createElement(U.a,{label:l("dacc.permissionsDialog.accept"),onClick:i}))}))};vi.propTypes={sharedDataLabel:qe.a.string.isRequired,open:qe.a.bool.isRequired,onClose:qe.a.func.isRequired,onRefuse:qe.a.func.isRequired,onAccept:qe.a.func.isRequired,showDaccReasonsDialog:qe.a.func.isRequired};var gi=vi,yi=function(e){var t=e.open,a=e.onClose,n=Object(H.e)().t;return r.a.createElement(Q.a,{open:t,onClose:a,title:n("dacc.reasonsDialog.title"),content:n("dacc.reasonsDialog.content")})};yi.propTypes={open:qe.a.bool.isRequired,onClose:qe.a.func.isRequired};var hi=yi,Ei=function(e){var t=e.onClose,a=e.onRefuse,o=e.onAccept,i=e.componentProps,c=Object(n.useState)(!1),l=s()(c,2),u=l[0],d=l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(gi,Ie()({open:!0,onClose:t,onRefuse:a,onAccept:o,showDaccReasonsDialog:function(){return d(!0)}},i.DaccPermissionsDialog)),u&&r.a.createElement(hi,{open:!0,onClose:function(){return d(!1)}}))};Ei.propTypes={onClose:qe.a.func.isRequired,onRefuse:qe.a.func.isRequired,onAccept:qe.a.func.isRequired,componentProps:qe.a.shape({DaccPermissionsDialog:qe.a.shape({sharedDataLabel:qe.a.string.isRequired}).isRequired}).isRequired};var Oi=Ei,ji=function(e){var t=e.onClose,a=e.onRefuse,n=e.onAccept,o=Object(H.e)().t;return r.a.createElement(Oi,{onClose:t,onRefuse:a,onAccept:n,componentProps:{DaccPermissionsDialog:{sharedDataLabel:o("dacc.permissionsDialog.anonymized_bikegoal_progression")}}})};ji.propTypes={onClose:qe.a.func.isRequired,onRefuse:qe.a.func.isRequired,onAccept:qe.a.func.isRequired};var Ci=ji,xi=a("VXtb"),wi=a("gHOe"),ki=a("5Q3L"),_i=a("7EAA"),Di=a("lwqu"),Pi=a("BxMJ");function Ti(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Si(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ti(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ti(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Mi=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,o=Object(n.useState)(!1),i=s()(o,2),c=i[0],l=i[1],u=Object(n.useReducer)((function(e){return!e}),!1),d=s()(u,2),m=d[0],p=d[1],f=ho("bikeGoal"),b=f.isLoading,v=f.value,g=void 0===v?{}:v,y=f.save,h=g.onboardingStep,E=void 0===h?0:h,j=g.sendToDACC,x=void 0===j?null:j,w=Object(n.useState)(x),k=s()(w,2),_=k[0],D=k[1],P=vn().sourceIdentity,T={typography:{whiteSpace:"pre-line"}},S=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(),e.next=3,y(Si(Si({},g),{},{onboardingStep:E-1}));case 3:p();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(),e.next=3,y(Si(Si({},g),{},{onboardingStep:E+1,sendToDACC:_}));case 3:p();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Di.a,Ie()({},e,{ref:t}),r.a.createElement(Pi.a,null,a("bikeGoal.edit.compare_progress")),r.a.createElement(_i.a,null,b?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{style:T.typography},a("bikeGoal.onboarding.steps.comparison.comparisonLegend",{source:P})),r.a.createElement(wi.a,{className:"u-mt-1"},r.a.createElement(xi.a,{control:r.a.createElement(ki.a,{checked:!0===_,onClick:function(){return l(!0)}}),label:a("bikeGoal.onboarding.steps.comparison.compare"),className:"u-m-0"}),r.a.createElement(xi.a,{control:r.a.createElement(ki.a,{checked:!1===_,onClick:function(){return D(!1)}}),label:a("bikeGoal.onboarding.steps.comparison.doNotCompare"),className:"u-m-0"})),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(U.a,{onClick:M,label:a("bikeGoal.onboarding.actions.next"),disabled:m||null==_}),r.a.createElement(U.a,{onClick:S,label:a("bikeGoal.onboarding.actions.previous"),disabled:m,variant:"text",className:"u-ml-half"}),m&&r.a.createElement(or.b,{className:"u-ml-half"}))))),c&&r.a.createElement(Ci,{onClose:function(){return l(!1)},onRefuse:function(){l(!1),D(!1)},onAccept:function(){l(!1),D(!0)}}))}));Mi.displayName="BikeGoalOnboardingComparison";var Ai=Mi;function Ni(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Li(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ni(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ni(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ri=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,o=Object(Ce.h)(),i=Object(n.useReducer)((function(e){return!e}),!1),c=s()(i,2),l=c[0],u=c[1],d=ho("bikeGoal"),m=d.isLoading,p=d.value,f=void 0===p?{}:p,b=d.save,v=f.onboardingStep,g=void 0===v?0:v,y={typography:{whiteSpace:"pre-line"}},h=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(),e.next=3,b(Li(Li({},f),{},{onboardingStep:g-1}));case 3:u();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=O()(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(),e.next=3,b(Li(Li({},f),{},{onboarded:!0,activated:!0,showAlert:!1}));case 3:u(),t=(new Date).getFullYear().toString(),o("/bikegoal/".concat(t,"/trips"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Di.a,Ie()({},e,{ref:t}),r.a.createElement(Pi.a,{optional:r.a.createElement(tr.a,{variant:"caption"},a("bikeGoal.about.once_goal_reach.optional"))},a("bikeGoal.about.once_goal_reach.title")),r.a.createElement(_i.a,null,m?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{style:y.typography},a("bikeGoal.about.once_goal_reach.content")),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(U.a,{onClick:E,label:a("bikeGoal.onboarding.actions.finish"),disabled:l}),r.a.createElement(U.a,{onClick:h,label:a("bikeGoal.onboarding.actions.previous"),disabled:l,variant:"text",className:"u-ml-half"}),l&&r.a.createElement(or.b,{className:"u-ml-half"})))))}));Ri.displayName="BikeGoalOnboardingConclusion";var Fi=Ri,Ii=a("0JGJ");function Bi(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Gi(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Bi(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bi(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var zi=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,o=Object(n.useReducer)((function(e){return!e}),!1),i=s()(o,2),c=i[0],l=i[1],u=ho("bikeGoal"),d=u.isLoading,m=u.value,p=void 0===m?{}:m,f=u.save,b=p.onboardingStep,v=void 0===b?0:b,g=p.daysToReach,y=void 0===g?100:g,h=Object(n.useState)(y),E=s()(h,2),j=E[0],x=E[1],w={typography:{whiteSpace:"pre-line"}},k=""===j||j<=0,_=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Gi(Gi({},p),{},{onboardingStep:v-1}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Gi(Gi({},p),{},{onboardingStep:v+1,daysToReach:j}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Di.a,Ie()({},e,{ref:t}),r.a.createElement(Pi.a,null,a("bikeGoal.onboarding.steps.daysToReach.title")),r.a.createElement(_i.a,null,d?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{style:w.typography},a("bikeGoal.onboarding.steps.daysToReach.legend")),r.a.createElement("div",null,r.a.createElement(ei.a,{className:"u-w-5 u-mt-1",variant:"outlined",type:"number",label:a("bikeGoal.goal"),defaultValue:j,error:k,helperText:k?a("bikeGoal.onboarding.steps.daysToReach.error"):" ",inputProps:{min:"1",step:"1"},InputProps:{endAdornment:r.a.createElement(Ii.a,{position:"end"},a("bikeGoal.days"))},onChange:function(e){return x(e.target.value)}})),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(U.a,{onClick:D,label:a("bikeGoal.onboarding.actions.next"),disabled:c||!!k}),r.a.createElement(U.a,{onClick:_,label:a("bikeGoal.onboarding.actions.previous"),disabled:c,variant:"text",className:"u-ml-half"}),c&&r.a.createElement(or.b,{className:"u-ml-half"})))))}));zi.displayName="BikeGoalOnboardingDaysToReach";var qi=zi;function Zi(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ui(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Zi(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zi(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Qi=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,o=Object(n.useReducer)((function(e){return!e}),!1),i=s()(o,2),c=i[0],l=i[1],u=ho("bikeGoal"),d=u.isLoading,m=u.value,p=void 0===m?{}:m,f=u.save,b=p.onboardingStep,v=void 0===b?0:b,g={typography:{whiteSpace:"pre-line"}},y=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Ui(Ui({},p),{},{onboardingStep:v-1}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Ui(Ui({},p),{},{onboardingStep:v+1}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Di.a,Ie()({},e,{ref:t}),r.a.createElement(Pi.a,null,a("bikeGoal.about.how_trips_detected.title")),r.a.createElement(_i.a,null,d?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{style:g.typography},a("bikeGoal.about.how_trips_detected.content")),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(U.a,{onClick:h,label:a("bikeGoal.onboarding.actions.next"),disabled:c}),r.a.createElement(U.a,{onClick:y,label:a("bikeGoal.onboarding.actions.previous"),disabled:c,variant:"text",className:"u-ml-half"}),c&&r.a.createElement(or.b,{className:"u-ml-half"})))))}));Qi.displayName="BikeGoalOnboardingDetection";var Hi=Qi;function Yi(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Vi(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Yi(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Yi(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Wi=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,o=Object(n.useReducer)((function(e){return!e}),!1),i=s()(o,2),c=i[0],l=i[1],u=ho("bikeGoal"),d=u.isLoading,m=u.value,p=void 0===m?{}:m,f=u.save,b=p.onboardingStep,v=void 0===b?0:b,g=bn(),y={typography:{whiteSpace:"pre-line"}},h=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Vi(Vi({},p),{},{onboardingStep:v+1}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Di.a,Ie()({},e,{ref:t}),r.a.createElement(Pi.a,null,a("bikeGoal.about.intro.title")),r.a.createElement(_i.a,null,d?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{style:y.typography},a("bikeGoal.about.intro.content",{bountyAmount:g})),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(U.a,{onClick:h,label:a("bikeGoal.onboarding.actions.next"),disabled:c}),c&&r.a.createElement(or.b,{className:"u-ml-half"})))))}));Wi.displayName="BikeGoalOnboardingIntroduction";var Ki=Wi;function Ji(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Xi(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ji(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ji(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $i=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,o=Object(n.useReducer)((function(e){return!e}),!1),i=s()(o,2),c=i[0],l=i[1],u=ho("bikeGoal"),d=u.isLoading,m=u.value,p=void 0===m?{}:m,f=u.save,b=p.onboardingStep,v=void 0===b?0:b,g=p.lastname,y=void 0===g?"":g,h=p.firstname,E=void 0===h?"":h,j=Object(n.useState)(y),x=s()(j,2),w=x[0],k=x[1],_=Object(n.useState)(E),D=s()(_,2),P=D[0],T=D[1],S=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Xi(Xi({},p),{},{onboardingStep:v-1}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,f(Xi(Xi({},p),{},{onboardingStep:v+1,lastname:w,firstname:P}));case 3:l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Di.a,Ie()({},e,{ref:t}),r.a.createElement(Pi.a,null,a("bikeGoal.onboarding.steps.naming.title")),r.a.createElement(_i.a,null,d?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,null,a("bikeGoal.onboarding.steps.naming.nameLegend")),r.a.createElement("div",null,r.a.createElement(ei.a,{variant:"outlined",label:a("bikeGoal.edit.lastname"),defaultValue:w,onChange:function(e){return k(e.target.value)},className:"u-w-5 u-mt-1"})),r.a.createElement("div",null,r.a.createElement(ei.a,{variant:"outlined",label:a("bikeGoal.edit.firstname"),defaultValue:P,onChange:function(e){return T(e.target.value)},className:"u-w-5 u-mt-1"})),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(U.a,{onClick:M,label:a("bikeGoal.onboarding.actions.next"),disabled:c||""===P||""===w}),r.a.createElement(U.a,{onClick:S,label:a("bikeGoal.onboarding.actions.previous"),disabled:c,variant:"text",className:"u-ml-half"}),c&&r.a.createElement(or.b,{className:"u-ml-half"})))))}));$i.displayName="BikeGoalOnboardingNaming";var ec=$i,tc=a("pFWb"),ac=function(){var e=Object(H.e)().t,t=Object(Ce.h)(),a=ho("bikeGoal.onboardingStep"),n=a.isLoading,o=a.value,i=void 0===o?0:o;return r.a.createElement(rr.a,{open:!0,disableGutters:!0,title:e("bikeGoal.onboarding.title"),content:r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-m-1"}),!n&&r.a.createElement(tc.a,{activeStep:i,orientation:"vertical"},r.a.createElement(Ki,null),r.a.createElement(qi,null),r.a.createElement(ec,null),r.a.createElement(Hi,null),r.a.createElement(Ai,null),r.a.createElement(Fi,null))),onClose:function(){t("..")}})},nc={co2:{fontWeight:700}},rc={modes:Ao,purposes:Mo},oc=function(e){var t=e.type,a=e.sortedTimeserieKey,n=rc[t];return r.a.createElement(n,{attribute:a})},ic=function(e){var t=e.sortedTimeserie,a=e.totalCO2,n=e.type,o=Object(H.e)().t,i=Object(Ce.h)(),c=s()(t,2),l=c[0],u=c[1],d=u.timeseries.length,m=u.totalCO2,p=function(e,t){if(0===t)return"0%";var a=(100*e/t).toFixed(2).split("."),n=s()(a,2),r=n[0],o=n[1];return"00"===o?"".concat(r,"%"):"".concat(r,".").concat(o,"%")}(m,a);return 0===d&&0===m?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(Jn.b,{"data-testid":"ListItem",onClick:function(){return i("/analysis/".concat(n,"/").concat(l))},button:!0},r.a.createElement(Xn.a,null,r.a.createElement(oc,{type:n,sortedTimeserieKey:l})),r.a.createElement($n.a,{primary:o("trips.".concat(n,".").concat(l)),secondary:"".concat(p," · ").concat(o("analysis.travels",d))}),r.a.createElement(tr.a,{style:nc.co2,variant:"body2"},ga(m)),r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:No.a,color:"var(--secondaryTextColor)"}))),r.a.createElement(Qr.a,null))},cc=function(e,t,a){var n=Object.keys(e),r=Object.values(e),o="modes"===t?oa:la,i=r.map((function(e){return e.totalCO2})),c=n.map((function(e){return o(e)}));return{data:{labels:n.map((function(e){return a("trips.".concat(t,".").concat(e))})),datasets:[{id:1,data:i,backgroundColor:c}]},options:{plugins:{tooltip:{displayColors:!1,callbacks:{label:function(e){return"".concat(e.label," ").concat(ga(e.raw))}}}}}}},lc=a("kTYB"),sc=function(e){var t=e.timeseries,a=Object(Ce.i)().mode,o=Object(H.e)().t,i=Object(ge.b)().isMobile,c=Object(n.useMemo)((function(){return za(t)}),[t]),l=Ba(t),s=Object(n.useMemo)((function(){return cc(c,"modes",o)}),[o,c]),u=s.data,d=s.options,m=Object(n.useMemo)((function(){return a?c[a].timeseries.sort((function(e,t){return t.startDate.localeCompare(e.startDate)})):[]}),[a,c]);return a?r.a.createElement("div",{className:"u-mt-2"},r.a.createElement(qo,{timeseries:m})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:br()("u-flex",{"u-flex-justify-end u-pos-absolute u-top-m u-right-xl":!i,"u-flex-justify-center u-mv-1":i})},r.a.createElement(lc.a,{data:u,options:d,primaryText:ga(l),secondaryText:o("analysis.emittedCO2")})),r.a.createElement(we.a,{marginTop:i?void 0:"6rem"},r.a.createElement(Kn.a,null,Object.entries(c).map((function(e,t){return r.a.createElement(ic,{key:t,type:"modes",totalCO2:l,sortedTimeserie:e})})))))},uc=["data"],dc=function(){var e=G().account,t=fe().selectedDate,a=A(t,null==e?void 0:e._id),n=Object(g.useQueryAll)(a.definition,a.options),o=n.data,i=c()(n,uc);return Object(g.isQueryLoading)(i)||i.hasMore?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(sc,{timeseries:o})},mc=a("XfNG"),pc=a("GXf6"),fc=["/analysis/modes","/analysis/purposes"],bc=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},vc=function(){var e=Object(Ce.h)(),t=Object(Ce.g)().pathname,a=Object(H.e)().t,n=fc.indexOf(fc.find((function(e){return t.includes(e)})));return r.a.createElement(er.a,null,r.a.createElement(mc.a,{value:n,onChange:function(t,a){e(fc[a])}},r.a.createElement(pc.a,Ie()({label:a("nav.modes")},bc(0))),r.a.createElement(pc.a,Ie()({label:a("nav.purposes")},bc(1)))))},gc=a("K4g+"),yc=a("/ENz"),hc=Object(yc.a)((function(e){return{paper:{display:"inline-flex",width:264,borderRadius:1e3},iconButton:{color:e.palette.text.icon,boxShadow:e.shadows[2]}}})),Ec=function(e){var t=e.className,a=hc();return r.a.createElement(we.a,{display:"flex",className:t},r.a.createElement(er.a,{className:a.paper,elevation:2}),r.a.createElement(we.a,{className:"u-ml-half",display:"inline-flex"},r.a.createElement(gr.a,{className:a.iconButton,disabled:!0,size:"medium"},r.a.createElement(Vn.a,{icon:gc.a})),r.a.createElement(gr.a,{className:br()(a.iconButton,"u-ml-half"),disabled:!0,size:"medium"},r.a.createElement(Vn.a,{icon:No.a}))))},Oc=a("7u78"),jc=["children","className","spaceBetween"],Cc=Object(yc.a)((function(){return{button:{padding:"0 1rem",justifyContent:function(e){return e.spaceBetween?"space-between":"left"}},typography:{textTransform:"capitalize"}}})),xc=function(e){var t=e.children,a=e.className,n=e.spaceBetween,o=c()(e,jc),i=Cc({spaceBetween:n});return r.a.createElement(Oc.a,Ie()({className:br()(i.button,a),endIcon:r.a.createElement(Vn.a,{icon:oo.a,size:10})},o),r.a.createElement(tr.a,{className:i.typography},t))},wc=a("gtDA"),kc=a("1Crc"),_c=["className","type","options","selectedIndex","disabledIndexes","onclick"],Dc=Object(yc.a)((function(){return{paper:{textTransform:"capitalize",width:function(e){var t=e.anchorEl;return t?window.getComputedStyle(t).width:void 0},marginTop:2}}})),Pc=function(e){var t=e.className,a=e.type,o=e.options,i=e.selectedIndex,l=e.disabledIndexes,u=e.onclick,d=c()(e,_c),m=Object(n.useState)(null),p=s()(m,2),f=p[0],b=p[1],v=Object(n.useState)(i||0),g=s()(v,2),y=g[0],h=g[1],E=Dc({anchorEl:f}).paper,O=function(e){return function(){b(null),h(e),u&&u(a,o[e])}};return Object(n.useEffect)((function(){void 0!==i&&h(i)}),[i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(xc,Ie()({"data-testid":"dropdown-button",className:t,onClick:function(e){b(e.currentTarget)}},d),o[y]),r.a.createElement(wc.a,{"data-testid":"dropdown-menu",classes:{paper:E},anchorEl:f,getContentAnchorEl:null,keepMounted:!0,open:Boolean(f),onClose:function(){b(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},elevation:2},o.map((function(e,t){return r.a.createElement(kc.a,{"data-testid":"dropdown-menuItem-".concat(t),key:t,onClick:O(t),selected:t===y,disabled:l&&l.includes(t)},e)}))))};Pc.proptypes={className:qe.a.string,type:qe.a.oneOfType([qe.a.string,qe.a.number]),options:qe.a.array.isRequired,selectedIndex:qe.a.number,disabledIndexes:qe.a.array,onclick:qe.a.func};var Tc=Pc,Sc=function(e){return Array(12).fill().map((function(t,a){return new Intl.DateTimeFormat("".concat(e,"-").concat(e.toUpperCase()),{month:"long"}).format(new Date(0,a))}))},Mc=function(e){return new Date(Math.min.apply(null,e))},Ac=function(e){return new Date(Math.max.apply(null,e))},Nc=function(e,t){return e.map((function(e,a){return t.includes(e)?null:a})).filter((function(e){return null!==e}))},Lc=function(e,t){var a=function(e){var t=Ac(e).getFullYear(),a=Mc(e).getFullYear(),n=Number(a);return Array(t-a+1).fill().map((function(){return n++})).sort().reverse()}(e),n=function(e){return Ue()(new Set(e.map((function(e){return e.getFullYear()}))))}(e),r=a.indexOf(t.getFullYear());return{years:a,yearSelectedIndex:r,disabledYearsIndexes:Nc(a,n)}},Rc=xa()((function(e){var t=e.dates,a=e.selectedDate,n=e.lang,r=Sc(n),o=Mc(t),i=Ac(t),c=a.getFullYear(),l=c===i.getFullYear(),s=c===o.getFullYear(),u=12;l?u=i.getMonth()+1:s&&(u=12-o.getMonth());var d,m=function(e){var t=e.monthCount,a=e.allMonthsName,n=e.endToStart;return a.slice(n?a.length-t:0,n?a.length:t)}({monthCount:u,allMonthsName:r,endToStart:s}),p=m.indexOf(r[a.getMonth()]);-1===p&&(l?d=i:s&&(d=o),p=m.indexOf(r[d.getMonth()]));var f=function(e){var t=e.dates,a=e.year,n=e.allMonthsName;return Ue()(new Set(t.map((function(e){return e.getFullYear()===a?n[e.getMonth()]:null})).filter((function(e){return null!==e}))))}({dates:t,year:c,allMonthsName:r});return{months:m,monthSelectedIndex:p,disabledMonthsIndexes:Nc(m,f)}})),Fc=xa()((function(e){var t=e.oldDate,a=e.lang,n=e.value,r=e.type,o=e.dates,i=Sc(a);if("year"===r){var c=new Date(new Date(t).setFullYear(n)),l=Rc({dates:o,selectedDate:c,lang:a}),s=l.months,u=l.monthSelectedIndex,d=i.indexOf(s[u]);return new Date(new Date(c).setMonth(d))}if("month"===r){var m=i.indexOf(n);return new Date(new Date(t).setMonth(m))}return t})),Ic=Object(yc.a)((function(e){return{paper:{display:"inline-flex",width:264,borderRadius:1e3},leftDropdownButton:{borderTopLeftRadius:1e3,borderBottomLeftRadius:1e3,paddingRight:"2.5rem"},rightDropdownButton:{borderTopRightRadius:1e3,borderBottomRightRadius:1e3,paddingRight:"1.2rem"},divider:{margin:"0.6rem 0"},iconButton:{color:e.palette.text.icon,boxShadow:e.shadows[2],backgroundColor:e.palette.background.paper}}})),Bc=function(e){var t=e.className,a=e.options,o=e.selectedDate,i=e.setSelectedDate,c=Ic(),l=Object(H.e)().lang,s=Object(n.useMemo)((function(){return Rc({dates:a,selectedDate:o,lang:l})}),[a,o,l]),u=s.months,d=s.monthSelectedIndex,m=s.disabledMonthsIndexes,p=Object(n.useMemo)((function(){return Lc(a,o)}),[a,o]),f=p.years,b=p.yearSelectedIndex,v=p.disabledYearsIndexes,g=function(e,t){var n=Fc({oldDate:o,lang:l,value:t,type:e,dates:a});i(n)},y=function(e){return function(){i((function(t){return new Date(t.setMonth(t.getMonth()+e))}))}},h=function(e){return function(e){var t=e.type,a=e.selectedDate,n=e.options,r=new Date(a.getFullYear(),a.getMonth());if("previous"===t){var o=Mc(n);return new Date(o.getFullYear(),o.getMonth()).getTime()===r.getTime()}if("next"===t){var i=Ac(n);return new Date(i.getFullYear(),i.getMonth()).getTime()===r.getTime()}return!1}({type:e,selectedDate:o,options:a})};return r.a.createElement(we.a,{display:"flex",className:t},r.a.createElement(er.a,{className:c.paper,elevation:2},r.a.createElement(Tc,{"data-testid":"dropdown-button-year",type:"year",className:c.leftDropdownButton,options:f,onclick:g,selectedIndex:b,disabledIndexes:v}),r.a.createElement(Qr.a,{className:c.divider,orientation:"vertical",flexItem:!0}),r.a.createElement(Tc,{"data-testid":"dropdown-button-month",type:"month",className:c.rightDropdownButton,fullWidth:!0,spaceBetween:!0,options:u,onclick:g,selectedIndex:d,disabledIndexes:m})),r.a.createElement(we.a,{className:"u-ml-half",display:"inline-flex"},r.a.createElement(gr.a,{"data-testid":"previous-button",className:c.iconButton,onClick:y(-1),disabled:h("previous"),size:"medium"},r.a.createElement(Vn.a,{icon:gc.a})),r.a.createElement(gr.a,{"data-testid":"next-button",className:br()(c.iconButton,"u-ml-half"),onClick:y(1),disabled:h("next"),size:"medium"},r.a.createElement(Vn.a,{icon:No.a}))))};Bc.proptypes={className:qe.a.string,options:qe.a.array.isRequired,selectedDate:qe.a.number.isRequired,setSelectedDate:qe.a.func.isRequired};var Gc=Bc,zc=function(e){var t=e.className,a=e.options,n=e.isLoading,o=e.selectedDate,i=e.setSelectedDate;return n?r.a.createElement(Ec,{className:t}):r.a.createElement(Gc,{className:t,options:a,selectedDate:o,setSelectedDate:i})},qc=["data"];function Zc(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Uc(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Zc(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zc(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Qc=function(){var e=fe(),t=e.selectedDate,a=e.setSelectedDate,o=G().account,i=M({accountId:null==o?void 0:o._id,limitBy:1e3}),l=Object(g.useQueryAll)(i.definition,Uc(Uc({},i.options),{},{enabled:Boolean(o)})),s=l.data,u=c()(l,qc),d=!o||Object(g.isQueryLoading)(u)||u.hasMore,m=Object(n.useMemo)((function(){return function(e,t){return e?null:t.map((function(e){return new Date(e.startDate)}))}(d,s)}),[d,s]);return Object(n.useEffect)((function(){m&&null===t&&a(Ac(m))}),[m,t,a]),Object(n.useEffect)((function(){return function(){a(null)}}),[]),r.a.createElement(zc,{className:"u-mt-1-s u-ml-0-s u-flex-justify-center-s u-flex u-ml-2",isLoading:d||null===t,options:m,selectedDate:t,setSelectedDate:a})},Hc=function(){var e=Object(H.e)().t,t=Object(Ce.h)(),a=Object(Ce.i)().mode,n=Object(ge.b)().isMobile,o=e(a?"trips.modes.".concat(a.toUpperCase()):"analysis.mode"),i=a?function(){return t("/analysis/modes")}:void 0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Er,{label:o,onBack:i}),n&&r.a.createElement(vc,null),r.a.createElement(Qc,null),r.a.createElement(dc,null))},Yc=function(e){var t=e.timeseries,a=Object(Ce.i)().purpose,o=Object(H.e)().t,i=Object(ge.b)().isMobile,c=Object(n.useMemo)((function(){return Za(t)}),[t]),l=Ba(t),s=Object(n.useMemo)((function(){return cc(c,"purposes",o)}),[o,c]),u=s.data,d=s.options,m=Object(n.useMemo)((function(){return a?c[a].timeseries.sort((function(e,t){return t.startDate.localeCompare(e.startDate)})):[]}),[a,c]);return a?r.a.createElement("div",{className:"u-mt-2"},r.a.createElement(qo,{timeseries:m})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:br()("u-flex",{"u-flex-justify-end u-pos-absolute u-top-m u-right-xl":!i,"u-flex-justify-center u-mv-1":i})},r.a.createElement(lc.a,{data:u,options:d,primaryText:ga(l),secondaryText:o("analysis.emittedCO2")})),r.a.createElement(we.a,{marginTop:i?void 0:"6rem"},r.a.createElement(Kn.a,null,Object.entries(c).map((function(e,t){return r.a.createElement(ic,{key:t,type:"purposes",totalCO2:l,sortedTimeserie:e})})))))},Vc=["data"],Wc=function(){var e=G().account,t=fe().selectedDate,a=A(t,null==e?void 0:e._id),n=Object(g.useQueryAll)(a.definition,a.options),o=n.data,i=c()(n,Vc);return Object(g.isQueryLoading)(i)||i.hasMore?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(Yc,{timeseries:o})},Kc=function(){var e=Object(H.e)().t,t=Object(Ce.h)(),a=Object(Ce.i)().purpose,n=Object(ge.b)().isMobile,o=e(a?"trips.purposes.".concat(a.toUpperCase()):"analysis.purpose"),i=a?function(){return t("/analysis/purposes")}:void 0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Er,{label:o,onBack:i}),n&&r.a.createElement(vc,null),r.a.createElement(Qc,null),r.a.createElement(Wc,null))},Jc=a("8kh3"),Xc=a("bS3/"),$c=function(e){var t=Object(H.e)().t,a=G(),n=a.accounts,o=a.account,i=a.setAccount,c=n.map((function(e){return{label:z(e),value:e._id}})),l={label:z(o),value:o._id};return r.a.createElement("div",e,r.a.createElement(Jc.a,null,t("devices.label")),r.a.createElement(Xc.a,{options:c,value:l,label:t("devices.label"),placeholder:t("devices.select"),onChange:function(e){var t=e.value;return i(n.find((function(e){return e._id===t})))}}))},el=a("5z4W"),tl=a.n(el),al=function(){var e=Object(ge.b)().isMobile;return r.a.createElement(we.a,{color:"var(--infoColor)",position:"fixed",right:"1rem",bottom:"calc(1rem + ".concat(e?"var(--sidebarHeight)":"0rem",")")},el.version)},nl=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),rl=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=nl(),i=ho("CO2Emission.showAlert"),c=i.isLoading,l=i.value,s=void 0===l||l,u=i.save;return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:r.a.createElement(tr.a,{style:{color:"var(--infoColor)"}},a("dacc.settings.showAlerter")),labelPlacement:n?"start":"end",checked:s,disabled:c,onChange:function(e){u(e.target.checked)},control:r.a.createElement(oi.a,{color:"primary"})}))},ol=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),il=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=ol(),i=ho("CO2Emission.sendToDACC"),c=i.isLoading,l=i.value,s=void 0!==l&&l,u=i.save;return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:a("dacc.settings.anonymous_participation"),labelPlacement:n?"start":"end",checked:s,disabled:c,onChange:function(e){u(e.target.checked)},control:r.a.createElement(oi.a,{color:"primary"})}))},cl=a("ro7u");function ll(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function sl(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ll(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ll(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ul=g.models.file.uploadFileWithConflictStrategy,dl=function(e,t){return t("export.filename",{today:Object(cl.a)(new Date,"yyyy MM dd"),accountLabel:e})},ml=function(e){return[Object.keys(e[0])].concat(Ue()(e)).map((function(e){return Object.values(e).map((function(e){return e?'"'.concat(e,'"'):" "})).toString()})).join("\n")},pl=function(){var e=O()(C.a.mark((function e(t,a){var n,r,o,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchQueryAndGetFromState(R());case 2:return n=e.sent,r=n.data,o=(null==r?void 0:r[0])||{},i=a.flatMap((function(e){return Ta(e,o).map((function(t){var a,n,r=(a={},d()(a,P.x.sectionStartDate,t.startDate),d()(a,P.x.sectionEndDate,t.endDate),d()(a,P.x.sectionDuration,t.duration),d()(a,P.x.sectionDistance,t.distance),d()(a,P.x.sectionMode,t.mode),d()(a,P.x.sectionCoordinates,t.coordinates),d()(a,P.x.sectionDistances,t.distances),d()(a,P.x.sectionTimestamps,t.timestamps),d()(a,P.x.sectionSpeeds,t.speeds),a);return sl(sl({},(n={},d()(n,P.x.tripId,e.id),d()(n,P.x.tripStartDate,Sa(e)),d()(n,P.x.tripEndDate,Ma(e)),d()(n,P.x.tripStartDisplayName,_a(e)),d()(n,P.x.tripArrivalDisplayName,Da(e)),d()(n,P.x.tripPurpose,wa(e)),n)),r)}))})),e.abrupt("return",ot()(i,P.x.tripId));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),fl=function(){var e=O()(C.a.mark((function e(t){var a,n,r,o,i,c,l,s,u,d,m;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.t,r=t.timeseries,o=t.accountName,e.prev=1,i=Fa(r),e.next=5,pl(a,i);case 5:return c=e.sent,l=ml(c),s=dl(o,n),e.next=10,Un(a,n);case 10:return u=e.sent,e.next=13,ul(a,l,{name:s,contentType:"text/csv",dirId:u._id,conflictStrategy:"rename"});case 13:return d=e.sent,m=d.data,e.abrupt("return",{appDir:u,fileCreated:m,isLoading:!1});case 18:return e.prev=18,e.t0=e.catch(1),Mt()("error",e.t0),e.abrupt("return",{appDir:null,fileCreated:null,isLoading:!0});case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),bl=["data"],vl=function(){var e,t,a,r,o=Object(H.e)().t,i=Object(g.useClient)(),l=G().account,u=Object(n.useState)(!1),d=s()(u,2),p=d[0],f=d[1],b=Object(n.useState)({appDir:null,fileCreated:null,isLoading:!0}),v=s()(b,2),h=v[0],E=h.appDir,j=h.fileCreated,x=h.isLoading,w=v[1],k=(e={accountId:null==l?void 0:l._id,limitBy:1e3},t=e.accountId,a=e.date,r=void 0===a?null:a,{definition:Object(g.Q)(m.g).where({"cozyMetadata.sourceAccount":t,startDate:{$gt:r}}).indexFields(["cozyMetadata.sourceAccount","startDate"]).sortBy([{"cozyMetadata.sourceAccount":"desc"},{startDate:"desc"}]).limitBy(1e3),options:{as:"".concat(m.g,"/sourceAccount/").concat(t),fetchPolicy:y.a.fetchPolicies.olderThan(3e4)}}),_=Object(g.useQueryAll)(k.definition,k.options),D=_.data,P=c()(_,bl),T=Object(g.isQueryLoading)(P)||P.hasMore;return Object(n.useEffect)((function(){T||p||E||function(){var e=O()(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,fl({client:i,t:o,timeseries:D,accountName:z(l)});case 3:t=e.sent,w(t),f(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[l,E,i,p,T,o,D]),{isLoading:x,appDir:E,file:j}},gl=function(e){var t=e.onClose,a=Object(H.e)().t,n=Object(g.useClient)(),o=vl(),i=o.file,c=o.appDir;if(o.isLoading)return r.a.createElement(Q.a,{open:!0,title:a("export.modal.title"),content:r.a.createElement(tr.a,{color:"textPrimary"},a("export.modal.content.progress"))});var l=Object(g.generateWebLink)({slug:"drive",cozyUrl:n.getStackClient().uri,subDomainType:n.getInstanceOptions().subdomain,pathname:"/",hash:"folder/".concat(c._id)});return r.a.createElement(Q.a,{open:!0,onClose:t,title:a("export.modal.title"),content:r.a.createElement(tr.a,{color:"textPrimary"},a("export.modal.content.done",{filename:i.name,pathAppDir:c.path})),actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{variant:"secondary",onClick:t,label:a("export.modal.button.close")}),r.a.createElement(U.a,{href:l,target:"_blank",label:a("export.modal.button.viewInDrive")}))})},yl=["accountName"],hl=function(e){var t=e.accountName,a=c()(e,yl),o=Object(H.e)().t,i=Object(n.useState)(!1),l=s()(i,2),u=l[0],d=l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",a,r.a.createElement(Jc.a,null,o("export.label")),r.a.createElement(U.a,{busy:!1,variant:"secondary",label:o("export.button"),onClick:function(){return d(!0)}})),u&&r.a.createElement(gl,{onClose:function(){return d(!1)},accountName:t}))},El=Object(n.memo)(hl),Ol=a("MN1e"),jl=function(){var e=de().getGeolocationTrackingId,t=Object(H.e)().t,a=Object(le.useWebviewIntent)(),n=function(){var t=O()(C.a.mark((function t(){var a;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:(a=t.sent)&&Object(Ol.a)(a);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"u-mt-1"},r.a.createElement("div",{className:"u-flex u-flex-column"},r.a.createElement("div",null,r.a.createElement(U.a,{label:t("geolocationTracking.settings.sendLogs"),variant:"secondary",onClick:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.call("sendGeolocationTrackingLogs");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),className:"u-mb-1"})),r.a.createElement("div",null,r.a.createElement(U.a,{label:t("geolocationTracking.settings.forceUploadData"),variant:"secondary",onClick:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.call("forceUploadGeolocationTrackingData");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),className:"u-mb-1"})),r.a.createElement("div",null,r.a.createElement(U.a,{label:t("geolocationTracking.settings.copyIdentifier"),variant:"secondary",onClick:n,className:"u-mb-1"}))))},Cl=Object(yc.a)({root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}),xl=function(e){var t=e.className,a=de(),n=a.disableGeolocationTracking,o=a.checkPermissionsAndEnableTrackingOrShowDialog,i=a.isGeolocationTrackingEnabled,c=Object(ge.b)().isMobile,l=Object(H.e)().t,s=Cl(),u=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=4;break}return e.next=3,n();case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,o();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:s,label:l("geolocationTracking.settings.enable"),labelPlacement:c?"start":"end",checked:i,onChange:function(){return u()},control:r.a.createElement(oi.a,{color:"primary"})}))},wl=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),kl=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=wl(),i=ho("bikeGoal.showAlertSuccess"),c=i.isLoading,l=i.value,s=i.save;return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:r.a.createElement(tr.a,{style:{color:"var(--infoColor)"}},a("bikeGoal.settings.showAlerterSuccess")),labelPlacement:n?"start":"end",checked:l,disabled:c,onChange:function(e){s(e.target.checked)},control:r.a.createElement(oi.a,{color:"primary"})}))},_l=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),Dl=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=_l(),i=ho("bikeGoal.showAlert"),c=i.isLoading,l=i.value,s=void 0===l||l,u=i.save;return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:r.a.createElement(tr.a,{style:{color:"var(--infoColor)"}},a("bikeGoal.settings.showAlerter")),labelPlacement:n?"start":"end",checked:s,disabled:c,onChange:function(e){u(e.target.checked)},control:r.a.createElement(oi.a,{color:"primary"})}))},Pl=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),Tl=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=Pl(),i=ho("bikeGoal.sendToDACC"),c=i.isLoading,l=i.value,s=i.save;return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:r.a.createElement(tr.a,{style:{color:"var(--infoColor)"}},a("bikeGoal.settings.sendToDACC")),labelPlacement:n?"start":"end",checked:!!l,disabled:c,onChange:function(e){s(e.target.checked)},control:r.a.createElement(oi.a,{color:"primary"})}))},Sl=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),Ml=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=Sl(),i=ho("bikeGoal.onboarded"),c=i.isLoading,l=i.value,s=void 0!==l&&l,u=i.save,d=ho("bikeGoal.activated"),m=d.isLoading,p=d.value,f=void 0!==p&&p,b=d.save,v=s||f,g=c||m,y=function(){var e=O()(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=3;break}return e.next=3,b(t.target.checked);case 3:return e.next=5,u(t.target.checked);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:r.a.createElement(tr.a,{style:{color:"var(--infoColor)"}},a("bikeGoal.settings.hideOnboarding")),labelPlacement:n?"start":"end",checked:v,disabled:g,onChange:y,control:r.a.createElement(oi.a,{color:"primary"})}))},Al=Object(yc.a)((function(){return{root:{marginLeft:0},labelPlacementStart:{display:"flex",justifyContent:"space-between"}}})),Nl=function(e){var t=e.className,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=Al(),i=Object(Ce.h)(),c=ho("bikeGoal.onboarded"),l=c.isLoading,s=c.value,u=void 0!==s&&s,d=ho("bikeGoal.activated"),m=d.isLoading,p=d.value,f=void 0!==p&&p,b=d.save,v=u&&f,g=l||m,y=function(){var e=O()(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=5;break}return e.next=3,b(t.target.checked);case 3:e.next=6;break;case 5:i("bikegoalonboarding");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:t},r.a.createElement(xi.a,{classes:o,label:a("bikeGoal.settings.participation"),labelPlacement:n?"start":"end",checked:v,disabled:g,onChange:y,control:r.a.createElement(oi.a,{color:"primary"})}))},Ll=function(){var e=Object(H.e)().t,t=de().isGeolocationTrackingAvailable,a=G().account;return a?r.a.createElement(r.a.Fragment,null,r.a.createElement(Er,{label:e("nav.settings")}),r.a.createElement("div",{className:"u-mh-1 u-mb-1"},r.a.createElement($c,{className:"u-mt-1"}),r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(Jc.a,null,e("settings.services")),t&&r.a.createElement(xl,{className:"u-mt-half-s"}),r.a.createElement(il,{className:"u-mt-half-s"}),K()("coachco2.bikegoal.enabled")&&r.a.createElement(Nl,{className:"u-mt-1-half-s"})),r.a.createElement(El,{className:"u-mt-1",accountName:z(a)}),K()("coachco2.admin-mode")&&r.a.createElement("div",{className:"u-mt-1"},r.a.createElement(Jc.a,null,e("settings.debug")),r.a.createElement(r.a.Fragment,null,r.a.createElement(rl,{className:"u-mt-1-half-s"}),K()("coachco2.bikegoal.enabled")&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Dl,{className:"u-mt-1-half-s"}),r.a.createElement(Ml,{className:"u-mt-1-half-s"}),r.a.createElement(kl,{className:"u-mt-1-half-s"}),r.a.createElement(Tl,{className:"u-mt-1-half-s"})))),t&&K()("coachco2.admin-mode")&&r.a.createElement(jl,null),K()("coachco2.admin-mode")&&r.a.createElement(al,null))):r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"})},Rl=a("13ub"),Fl=a.n(Rl),Il=r.a.createContext(),Bl=function(){var e=Object(n.useContext)(Il);if(!e)throw new Error("useTrip must be used within a TripProvider");return e},Gl=function(e){var t=e.timeserie,a=e.children,o=Object(n.useMemo)((function(){return{timeserie:v(t)}}),[t]);return r.a.createElement(Il.Provider,{value:o},a)},zl=r.a.memo(Gl),ql=a("whoR"),Zl=a("JaZj"),Ul=function(){var e=Object(n.useState)(!1),t=s()(e,2),a=t[0],o=t[1],i=_s(),c=i.type,l=i.isSameContact,u=i.contact,d=i.setType,m=i.label,p=i.category,f=Object(H.e)().t,b=Bl().timeserie,v=Object(g.useClient)(),y=Object(ve.b)().showAlert,h=function(){return d()},E=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return",o(!0));case 2:return y(f("contactToPlace.addSuccess"),"success"),"start"!==c||xt(b,"end")?h():d("end"),e.next=6,Tt({client:v,type:c,timeserie:b,contact:u,label:m,isSameContact:l,category:p,t:f});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){return o(!1)},x=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(f("contactToPlace.removeSuccess"),"success"),h(),e.next=4,kt({client:v,timeserie:b,type:c,t:f,contact:u});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(U.a,{variant:"secondary",label:f("contactToPlace.delete"),color:"error",onClick:x}):r.a.createElement(U.a,{variant:"secondary",label:f("contactToPlace.dismiss"),onClick:h}),r.a.createElement(U.a,{label:f("contactToPlace.submit"),onClick:E}),r.a.createElement(Zl.a,{open:a,onClose:j},r.a.createElement(ql.a,{variant:"filled",elevation:6,severity:"error",onClose:j},f("contactToPlace.error"))))},Ql=a("DPrj"),Hl=function(){var e=Object(n.useState)(!1),t=s()(e,2),a=t[0],o=t[1],i=Object(H.e)().t,c=_s(),l=c.contact,u=c.setContact,d=c.setLabel,m=c.setCategory;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Jn.b,{button:!0,gutters:"disabled",onClick:function(){return o(!0)}},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:Yt.a})),r.a.createElement($n.a,Ie()({primary:l?Object(vt.getDisplayName)(l):i("contactToPlace.contact")},!l&&{primaryTypographyProps:{color:"textSecondary"}})),r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:oo.a}))),a&&r.a.createElement(Ql.a,{dismissAction:function(){return o(!1)},onItemClick:function(e){u(e),d(i("contactToPlace.home")),m(P.G)}}))},Yl=(a("2nE9"),a("SdDE")),Vl=a("MWqS"),Wl=a("/rN/"),Kl=a("vZHb"),Jl=new sr.a({id:"location_5cb8a90cd75b6b5e8e203a5e2d5f9e35",use:"location_5cb8a90cd75b6b5e8e203a5e2d5f9e35-usage",viewBox:"0 0 32 33",content:'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 32 33" id="location_5cb8a90cd75b6b5e8e203a5e2d5f9e35"><path fill="#97ECA1" d="M26 10c0 5.764-6.78 17.628-9.174 21.64a.955.955 0 0 1-1.652 0C12.78 27.628 6 15.763 6 10 6 4.477 10.477 0 16 0s10 4.477 10 10Z" /><circle cx="16" cy="10" r="4" fill="#09AE1C" /></symbol>'}),Xl=(dr.a.add(Jl),Jl),$l=[51.505,-.09],es={height:128,borderRadius:8},ts=Object(yc.a)({icon:{filter:"drop-shadow(0 5px 8px rgba(29,33,42,0.12))"}}),as=function(){var e=Object(n.useState)(),t=s()(e,2),a=t[0],o=t[1],i=Object(n.useState)({x:0,y:0}),c=s()(i,2),l=c[0],u=c[1],d=Bl().timeserie,m=_s().type,p=Object(Yl.a)(),f=ts();return Object(n.useEffect)((function(){!function(e){var t=e.map,a=e.timeserie,n=e.type,r=e.setBounds,o=e.setSVGPositions,i=Ue()(Xa(a).properties["".concat(n,"_loc")].coordinates).reverse();t.setView(i);var c=t.getBounds(),l=t.getSize(),s=l.x,u=l.y;r(c),o({x:s/2-24,y:u/2-48})}({map:p,timeserie:d,type:m,setBounds:o,setSVGPositions:u})}),[d,p,m]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Vl.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),a&&r.a.createElement(Wl.a,{bounds:a},r.a.createElement(Vn.a,{className:f.icon,icon:Xl,size:48,x:l.x,y:l.y})))},ns=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Kl.a,{style:es,center:$l,zoom:17,zoomControl:!1,doubleClickZoom:!1,boxZoom:!1,scrollWheelZoom:!1},r.a.createElement(as,null)))},rs=function(e){var t=e.onClose,a=Object(n.useState)(),o=s()(a,2),i=o[0],c=o[1],l=Object(H.e)().t,u=_s(),d=u.setLabel,m=u.setCategory;return r.a.createElement(Q.a,{open:!0,title:l("contactToPlace.customLabel"),content:r.a.createElement(ei.a,{className:"u-mt-half",variant:"outlined",fullWidth:!0,autoFocus:!0,onChange:function(e){return c(e.target.value)}}),actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{variant:"secondary",label:l("contactToPlace.cancel"),onClick:t}),r.a.createElement(U.a,{label:l("contactToPlace.submit"),onClick:function(){d(i),m(),t()}})),onClose:t})},os=a("INxB"),is=function(e){var t=e.showCustomLabelModal,a=Object(n.forwardRef)((function(e,t){var a=Object(H.e)().t,n=_s().label,o=![a("contactToPlace.work"),a("contactToPlace.home"),void 0].includes(n);return r.a.createElement(os.a,Ie()({},e,{ref:t}),r.a.createElement(Xn.a,null,r.a.createElement(ki.a,{checked:o})),r.a.createElement($n.a,{primary:a("contactToPlace.custom")}))}));return a.displayName="CustomLabelActionComponent",{name:"customLabel",action:function(){t()},Component:a}},cs=["onClick"],ls=function(){var e=Object(n.forwardRef)((function(e,t){var a=e.onClick,n=c()(e,cs),o=Object(H.e)().t,i=_s(),l=i.label,s=i.setLabel,u=i.setCategory,d=o("contactToPlace.home");return r.a.createElement(os.a,Ie()({},n,{ref:t,onClick:function(){return a({compLabel:d,setLabel:s,setCategory:u})}}),r.a.createElement(Xn.a,null,r.a.createElement(ki.a,{checked:l===d})),r.a.createElement($n.a,{primary:d}))}));return e.displayName="HomeComponent",{name:P.G,action:function(e,t){var a=t.compLabel,n=t.setLabel,r=t.setCategory;n(a),r(P.G)},Component:e}},ss=["onClick"],us=function(){var e=Object(n.forwardRef)((function(e,t){var a=e.onClick,n=c()(e,ss),o=Object(H.e)().t,i=_s(),l=i.label,s=i.setLabel,u=i.setCategory;return r.a.createElement(os.a,Ie()({},n,{ref:t,onClick:function(){return a({setLabel:s,setCategory:u})}}),r.a.createElement(Xn.a,null,r.a.createElement(ki.a,{checked:void 0===l})),r.a.createElement($n.a,{primary:o("contactToPlace.noLabel")}))}));return e.displayName="NoLabelActionComponent",{name:"noLabel",action:function(e,t){var a=t.setLabel,n=t.setCategory;a(),n()},Component:e}},ds=["onClick"],ms=function(){var e=Object(n.forwardRef)((function(e,t){var a=e.onClick,n=c()(e,ds),o=Object(H.e)().t,i=_s(),l=i.label,s=i.setLabel,u=i.setCategory,d=o("contactToPlace.work");return r.a.createElement(os.a,Ie()({},n,{ref:t,onClick:function(){return a({compLabel:d,setLabel:s,setCategory:u})}}),r.a.createElement(Xn.a,null,r.a.createElement(ki.a,{checked:l===d})),r.a.createElement($n.a,{primary:d}))}));return e.displayName="WorkActionComponent",{name:P.Bb,action:function(e,t){var a=t.compLabel,n=t.setLabel,r=t.setCategory;n(a),r(P.Bb)},Component:e}},ps=a("zLZg"),fs=a("ZpM7"),bs=a("4aAG"),vs=a("Nvei"),gs=function(){var e=Object(n.useState)(!1),t=s()(e,2),a=t[0],o=t[1],i=Object(n.useState)(!1),c=s()(i,2),l=c[0],u=c[1],d=Object(n.useRef)(null),m=Object(H.e)().t,p=_s().label,f=Object(fs.c)([us,ls,ms,is],{showCustomLabelModal:function(){return o(!0)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Jn.b,{ref:d,"aria-controls":"simple-menu","aria-haspopup":"true",button:!0,gutters:"disabled",onClick:function(){return u(!0)}},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:vs.a})),r.a.createElement($n.a,{primary:p||m("contactToPlace.noLabel")}),r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:oo.a}))),r.a.createElement(ps.a,{ref:d,open:l,actions:f,onClose:function(){return u(!1)}},r.a.createElement(bs.a,null,r.a.createElement($n.a,{primary:m("contactToPlace.label"),primaryTypographyProps:{variant:"h6",align:"center"}}))),a&&r.a.createElement(rs,{onClose:function(){return o(!1)}}))},ys=a("nUfk"),hs=a("LFaT"),Es=function(){var e=Bl().timeserie,t=_s(),a=t.type,n=t.contact,o=Object(ys.a)().t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ns,null),r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,{gutters:"disabled"},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:hs.a})),r.a.createElement($n.a,{primary:Wa(e,a),secondary:Ja({timeserie:e,type:a,t:o})})),r.a.createElement(Qr.a,{className:"u-ml-3"}),r.a.createElement(Hl,null),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Qr.a,{className:"u-ml-3"}),r.a.createElement(gs,null))))},Os=a("uol1"),js=a("0pj4"),Cs=a("aoYa"),xs=function(e){var t=e.isLoading,a=Object(n.useState)(!1),o=s()(a,2),i=o[0],c=o[1],l=_s(),u=l.type,d=l.setType,m=Object(H.e)().t;return r.a.createElement(Q.a,{open:!0,title:r.a.createElement(r.a.Fragment,null,m("contactToPlace.save".concat(Fl()(u),"Place")),r.a.createElement(Os.a,{onClickAway:function(){return c(!1)}},r.a.createElement(Cs.a,{onClose:function(){return c(!1)},open:i,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,title:m("contactToPlace.tooltip"),placement:"top-end",arrow:!0},r.a.createElement(Xn.a,null,r.a.createElement(gr.a,{onClick:function(){return c((function(e){return!e}))}},r.a.createElement(Vn.a,{icon:js.a})))))),content:t?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(Es,null),actions:r.a.createElement(Ul,null),onClose:function(){return d()}})},ws=["data"],ks=r.a.createContext(),_s=function(){var e=Object(n.useContext)(ks);if(!e)throw new Error("useContactToPlace must be used within a ContactToPlaceProvider");return e},Ds=function(e){var t,a,o=e.children,i=Object(n.useState)(),l=s()(i,2),u=l[0],d=l[1],p=Object(n.useState)(),f=s()(p,2),b=f[0],v=f[1],h=Object(n.useState)(),E=s()(h,2),O=E[0],j=E[1],C=Object(n.useState)(),x=s()(C,2),w=x[0],k=x[1],_=Bl().timeserie,D=function(e){return{definition:Object(g.Q)(m.c).getById(e),options:{as:"".concat(m.c,"/").concat(e),fetchPolicy:y.a.fetchPolicies.olderThan(3e4),singleDocData:!0}}}((null===(t=Ct(_,u))||void 0===t||null===(a=t.data)||void 0===a?void 0:a._id)||(null==b?void 0:b._id)||" "),P=Object(g.useQuery)(D.definition,D.options),T=P.data,S=c()(P,ws),M=Object(g.isQueryLoading)(S),A=Object(n.useMemo)((function(){return T&&T._id===(null==b?void 0:b._id)}),[b,T]),N=Object(n.useMemo)((function(){return{type:u,setType:d,contact:b,setContact:v,label:O,setLabel:j,isSameContact:A,category:w,setCategory:k}}),[u,b,O,A,w]);return Object(n.useEffect)((function(){v(T),j(jt({contact:T,timeserie:_,type:u})),k(Ot({contact:T,timeserie:_,type:u}))}),[u,null==T?void 0:T._rev,null==T?void 0:T._id,null==_?void 0:_._id]),r.a.createElement(ks.Provider,{value:N},o,!!u&&r.a.createElement(xs,{isLoading:M}))},Ps=r.a.memo(Ds),Ts=a("IW7p"),Ss=a.n(Ts),Ms=function(e){var t=e.timeserie,a=e.selectedPurpose,n=e.setContactToPlaceType,r=e.onClose;a===P.y&&(xt(t,"start")?xt(t,"end")||n("end"):n("start")),r()},As=a("PG+o");function Ns(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ls(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ns(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ns(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Rs=function(){var e=O()(C.a.mark((function e(){var t,a,n,r,o,i,c=arguments;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},a=t.client,n=t.timeserie,r=t.purpose,o=t.isRecurringTrip,i=Ls({},n),o&&(i=on(i,r)),i=cn(i,r,{isRecurringTrip:o}),e.next=6,a.save(i);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fs=function(){var e=O()(C.a.mark((function e(t){var a,n,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,n=t.timeserie,r=t.purpose,e.next=3,Rs({client:a,timeserie:n,purpose:r,isRecurringTrip:!1});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Is=function(){var e=O()(C.a.mark((function e(){var t,a,n,r,o,i=arguments;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.client,n=t.timeserie,r=t.purpose,o=t.oldPurpose,e.next=3,Rs({client:a,timeserie:n,purpose:r,isRecurringTrip:!0});case 3:Object(As.a)(a,P.hb,{fields:{docId:n._id,oldPurpose:o}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Bs=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.icon,r=a.withDescription,o=a.withInfo,i=a.action,c=a.children,l=a.defaultModes,s=void 0===l?{}:l,u=Object.values(s).some((function(e){return e===t})),d=u?"".concat(e("trips.modes.".concat(t))," (").concat(e("trips.modes.default"),")"):e("trips.modes.".concat(t));return Ls(Ls(Ls(Ls({id:t,title:d,isChecked:!1,icon:Ao({attribute:n||t,defaultColor:!0})},r&&{description:da(t)}),o&&{info:da(t)}),i&&{action:i}),c&&{children:c})},Gs=a("IW7r"),zs=a("/dlN"),qs=function(e){return{children:ia.map((function(t){return{id:t,title:e("trips.purposes.".concat(t)),icon:r.a.createElement(Mo,{attribute:t})}}))}},Zs=function(e){var t=e.onClose,a=Object(n.useState)(!1),o=s()(a,2),i=o[0],c=o[1],l=Object(n.useState)(null),u=s()(l,2),d=u[0],m=u[1],p=Object(H.e)().t,f=Object(g.useClient)(),b=Bl().timeserie,v=_s(),y=v.type,h=v.setType,E=function(){var e=O()(C.a.mark((function e(a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(a.id),(n=qa(b))===P.ab){e.next=6;break}c(!0),e.next=9;break;case 6:return e.next=8,Is({client:f,timeserie:b,purpose:a.id,oldPurpose:n});case 8:Ms({timeserie:b,selectedPurpose:a.id,setContactToPlaceType:h,onClose:t});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=Object(n.useMemo)((function(){return function(e){var t=qa(b);return t?e.id===t:e.id===P.ab}}),[b]);return i?r.a.createElement(Q.a,{open:!0,title:p("recurring.confirmDialog.title"),content:p("recurring.confirmDialog.content"),actions:r.a.createElement(r.a.Fragment,null,r.a.createElement(zs.a,{theme:"secondary",label:p("recurring.confirmDialog.decline"),onClick:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs({client:f,timeserie:b,purpose:d});case 2:Ms({timeserie:b,selectedPurpose:d,setContactToPlaceType:h,onClose:t});case 3:case"end":return e.stop()}}),e)})))}),r.a.createElement(zs.a,{theme:"primary",label:p("recurring.confirmDialog.confirm"),onClick:O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Is({client:f,timeserie:b,purpose:d,oldPurpose:qa(b)});case 2:Ms({timeserie:b,selectedPurpose:d,setContactToPlaceType:h,onClose:t});case 3:case"end":return e.stop()}}),e)})))})),onClose:t}):y?r.a.createElement(xs,{onClose:t}):r.a.createElement(Gs.a,{title:p("tripEdit.selectPurpose"),onClose:t,onSelect:E,isSelected:j,options:qs(p)})},Us=r.a.memo(Zs),Qs=function(e){var t=e.recurring,a=e.setRecurring,n=Object(H.e)().t;return r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,{button:!0,onClick:function(){return a(!1)}},r.a.createElement(Xn.a,null,r.a.createElement(ki.a,{value:"no",checked:!t})),r.a.createElement($n.a,{primary:n("recurring.occasionalTrip")})),r.a.createElement(Jn.b,{button:!0,onClick:function(){return a(!0)}},r.a.createElement(Xn.a,null,r.a.createElement(ki.a,{value:"yes",checked:t})),r.a.createElement($n.a,{primary:n("recurring.recurringTrip")})))},Hs=function(){var e=Object(H.e)().t,t=Object(ge.b)().isMobile,a=r.a.useState(!1),n=s()(a,2),o=n[0],i=n[1],c=function(){i(!1)};return t?r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,{className:"u-mb-half u-pl-1-half",style:{minHeight:"3rem"}},r.a.createElement($n.a,{className:"u-pv-0",primary:e("recurring.title"),primaryTypographyProps:{variant:"h6"}}),r.a.createElement(ri.a,null,r.a.createElement(Os.a,{onClickAway:c},r.a.createElement(Cs.a,{onClose:c,open:o,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,title:e("recurring.tooltip"),placement:"top-end",arrow:!0},r.a.createElement(gr.a,{onClick:function(){i(!o)}},r.a.createElement(Vn.a,{icon:js.a}))))))):r.a.createElement("div",{className:"u-pt-1"},e("recurring.title"),r.a.createElement(Cs.a,{title:e("recurring.tooltip"),placement:"top",arrow:!0},r.a.createElement(gr.a,null,r.a.createElement(Vn.a,{icon:js.a}))))},Ys=a("/h+6"),Vs=a("epof"),Ws=function(e){var t,a,n=e.onClose,o=Object(ge.b)().isMobile,i=Bl().timeserie,c=Object(g.useClient)(),l=qa(i),s=null!==(t=null==i||null===(a=i.aggregation)||void 0===a?void 0:a.recurring)&&void 0!==t&&t,u=function(){var e=O()(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,Is({client:c,timeserie:i,purpose:l,oldPurpose:l});case 3:e.next=7;break;case 5:return e.next=7,Fs({client:c,timeserie:i,purpose:l});case 7:n();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o?r.a.createElement(Ys.a,{onClose:n,backdrop:!0},r.a.createElement(Vs.a,{disableGutters:!0,disableElevation:!0},r.a.createElement(Hs,null),r.a.createElement(Qr.a,null),r.a.createElement(Qs,{recurring:s,setRecurring:u}))):r.a.createElement(Q.a,{open:!0,onClose:n,disableGutters:!0,title:r.a.createElement(Hs,null),content:r.a.createElement(Qs,{recurring:s,setRecurring:u})})},Ks=a("bnOl"),Js=a("ee3C"),Xs=a("Vc4F"),$s=a("ksij"),eu=a("86gN"),tu=Object(yc.a)((function(e){return{dotStart:{marginTop:"9px"},dot:{marginBottom:"-1px"},connector:{width:"6px",backgroundColor:e.palette.primary.main},item:{marginTop:"-9px",paddingLeft:"11px","&::before":{padding:0,flexGrow:0},cursor:function(e){return e.isCommute?"pointer":void 0}},contentWrapper:{display:"flex",marginLeft:"11px"},endLabel:{fontWeight:700}}})),au=function(e){var t,a=e.type,o=Object(H.e)(),i=o.t,c=o.f,l=o.lang,s=_s().setType,u=Bl().timeserie,m=qa(u)===P.y,p=tu({isCommute:m}),f=Object(n.useMemo)((function(){return"end"!==a}),[a]),b=Object(n.useMemo)((function(){return"start"===a}),[a]),v=wt({timeserie:u,type:a,t:i}),g=v||Wa(u,a),y=v?Wa(u,a):null;return r.a.createElement($s.a,{className:p.item,onClick:m?function(){return s(a)}:void 0},r.a.createElement(eu.a,null,r.a.createElement(Xs.a,{className:br()((t={},d()(t,p.dot,f),d()(t,p.dotStart,b),t)),color:"primary",variant:"outlined"}),f&&r.a.createElement(Ks.a,{className:p.connector})),r.a.createElement(Js.a,null,r.a.createElement("div",{className:p.contentWrapper},r.a.createElement("div",{className:"u-flex-grow-1"},r.a.createElement(tr.a,null,g),y&&r.a.createElement(tr.a,{variant:"caption"},y)),r.a.createElement(tr.a,{className:p.endLabel,variant:"body2",component:"div"},ha({f:c,lang:l,date:Ha(u,a)})))))},nu=r.a.memo(au),ru=a("2Kpg");function ou(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function iu(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ou(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ou(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var cu=function(e){var t,a=e.item,o=e.onClose,i=e.onConfirm,c=Object(n.useState)(!1),l=s()(c,2),u=l[0],m=l[1],p=Object(n.useState)(!1),f=s()(p,2),b=f[0],v=f[1],y=Object(n.useState)(!1),h=s()(y,2),E=h[0],j=h[1],x=Object(ge.b)().isDesktop,w=Object(H.e)().t,k=Object(g.useClient)(),_=R(),D=Object(g.useQuery)(_.definition,_.options).data,P=null===(t=D[0])||void 0===t?void 0:t.defaultTransportModeByGroup,T=null==P?void 0:P[pa(a.id)];Object(n.useEffect)((function(){m(T===a.id)}),[P,T,a.id]),Object(n.useEffect)((function(){var e=T&&T===a.id;v(u===!e)}),[T,u,a.id]);var S=function(){var e=O()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,k.save(iu(iu({},D[0]),{},{defaultTransportModeByGroup:iu(iu({},P),{},d()({},pa(a.id),u?a.id:""))}));case 3:i();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(rr.a,{open:!0,title:a.title,size:"large",disableGutters:!0,content:r.a.createElement(Kn.a,null,r.a.createElement(Jn.b,{ellipsis:!1,button:!0,onClick:function(){m((function(e){return!e}))}},r.a.createElement(Xn.a,null,r.a.createElement(ru.a,{checked:u})),r.a.createElement($n.a,{primary:w("Modes.DefaultDialog.primary"),secondary:w("Modes.DefaultDialog.secondary")}))),onClose:o,actions:r.a.createElement("div",{className:br()("u-flex",{"u-w-100 u-ph-1":!x,"u-p-1":x}),style:{gap:"1rem"}},r.a.createElement(U.a,{label:w("Modes.DefaultDialog.actions.cancel"),variant:"secondary",onClick:o}),r.a.createElement(U.a,{label:w("Modes.DefaultDialog.actions.save"),busy:E,onClick:S,disabled:!b}))})},lu=function(e){var t=e.timeserie,a=e.sectionId,n=e.mode,r=e.t,o=t.series.flatMap((function(e,t){return e.features.flatMap((function(e,n){if(e.features)return e.features.flatMap((function(e,r){if(e.id===a)return{feature:e,serieIndex:t,firstIndex:n,secondIndex:r}}))}))})).find((function(e){return e}));if(o){var i=o.feature,c=o.serieIndex,l=o.firstIndex,s=o.secondIndex,u=nt()(Ss()(i),"properties.manual_mode",n);return function(e){var t=e.timeseries,a=e.makeSections,n=e.t;return t.map((function(e){var t=e.series[0],r=0,o=0,i=0,c=0,l=[],s=a(e).map((function(e){var t={startDate:e.startDate,endDate:e.endDate,CO2:Oa(e),calories:ja(e),avgSpeed:e.avgSpeed,duration:e.duration,distance:e.distance,mode:e.mode,id:e.id};return r+=t.CO2,o+=t.distance,i+=t.duration,c+=t.calories,l.push(t.mode),t}));return Na(Na({},e),{},{aggregation:{automaticTitle:Ia(e,n),totalCO2:r,totalDistance:o,totalDuration:i,totalCalories:c,startPlaceDisplayName:Ya(e),endPlaceDisplayName:Va(e),coordinates:{startPoint:mn(e),endPoint:pn(e)},purpose:wa(t)||ka(t),modes:l,sections:s}})}))}({timeseries:[nt()(Ss()(t),"series[".concat(c,"].features[").concat(l,"].features[").concat(s,"]"),u)],makeSections:function(e){return function(e){var t=e.timeserie,a=e.sectionId,n=e.mode,r=t.aggregation.sections,o=r.find((function(e){return e.id===a})),i=Object.assign({},o,{mode:n});return r.map((function(e){return e.id===a?i:e}))}({timeserie:e,sectionId:a,mode:n})},t:r})[0]}return t},su=function(e){var t=e.item,a=e.onClick;return r.a.createElement(ri.a,null,r.a.createElement(gr.a,{onClick:function(){return a({item:t})}},r.a.createElement(Vn.a,{icon:De.a})))},uu=function(e){var t=e.section,a=e.onClose,o=Object(n.useState)(null),i=s()(o,2),c=i[0],l=i[1],u=Object(n.useState)(!1),d=s()(u,2),m=d[0],p=d[1],f=Object(H.e)().t,b=Object(g.useClient)(),v=Bl().timeserie,y=R(),h=Object(g.useQuery)(y.definition,y.options).data,E=Object(n.useMemo)((function(){return(null==h?void 0:h[0])||{}}),[h]),j=null==E?void 0:E.defaultTransportModeByGroup,x=Object(n.useCallback)(function(){var e=O()(C.a.mark((function e(n){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=lu({timeserie:v,sectionId:t.id,mode:n.id,t:f}),e.next=3,b.save(r);case 3:a();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[b,v,a,t.id,f]),w=Object(n.useMemo)((function(){return function(e){return e.id===t.mode}}),[t.mode]),k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.defaultModes,n=t.action;return{children:[Bs(e,P.Ab,{withInfo:!0}),Bs(e,"categories.".concat(P.h.name),{icon:P.k,children:P.h.modes.map((function(t){return Bs(e,t,{withDescription:!0,action:n,defaultModes:a})}))}),Bs(e,"categories.".concat(P.t.name),{icon:P.w,children:P.t.modes.map((function(t){return Bs(e,t,{withDescription:!0,action:n,defaultModes:a})}))}),Bs(e,"categories.".concat(P.gb.name),{icon:P.n,children:P.gb.modes.map((function(t){return Bs(e,t,{withDescription:!0})}))}),Bs(e,P.a,{withInfo:!0}),Bs(e,P.yb,{withInfo:!0})]}}(f,{defaultModes:j,action:{Component:su,props:{onClick:function(e){var t=e.item;l(t)}}}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Gs.a,{title:r.a.createElement(r.a.Fragment,null,f("tripEdit.selectMode"),r.a.createElement(Os.a,{onClickAway:function(){return p(!1)}},r.a.createElement(Cs.a,{open:m,title:f("tripEdit.modeTooltip"),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,placement:"top-end",arrow:!0,onClose:function(){return p(!1)}},r.a.createElement(gr.a,{onClick:function(){return p((function(e){return!e}))}},r.a.createElement(Vn.a,{icon:js.a}))))),onClose:a,onSelect:x,isSelected:w,options:k,ellipsis:!1}),!!c&&r.a.createElement(cu,{item:c,onClose:function(){return l(null)},onConfirm:a}))},du=r.a.memo(uu),mu=Object(yc.a)((function(e){return{iconItem:{marginTop:"-14px",cursor:"pointer","&::before":{padding:0,flexGrow:0}},iconDot:{backgroundColor:e.palette.background.paper,borderWidth:"1px",borderColor:e.palette.border.main,margin:0,padding:0,boxShadow:"none"},icon:{color:e.palette.primary.main,backgroundColor:e.palette.background.paper},connector:{width:"6px",backgroundColor:e.palette.primary.main}}})),pu=function(e){var t=e.icon,a=e.label,n=e.endLabel,o=e.onClick,i=mu();return r.a.createElement($s.a,{className:i.iconItem,onClick:o},r.a.createElement(eu.a,null,r.a.createElement(Xs.a,{className:i.iconDot},r.a.createElement(Po.b,{icon:t,className:i.icon,size:32})),r.a.createElement(Ks.a,{className:i.connector})),r.a.createElement(Js.a,{className:"u-flex"},r.a.createElement(tr.a,{className:"u-flex-grow-1",variant:"body2",color:"textSecondary"},a),r.a.createElement(tr.a,{className:i.endLabel,variant:"body2",component:"div"},n)))},fu=r.a.memo(pu),bu=function(){var e=Bl().timeserie,t=Object(H.e)(),a=t.t,o=t.f,i=t.lang,c=Object(n.useState)(!1),l=s()(c,2),u=l[0],d=l[1],m=Object(n.useState)(null),p=s()(m,2),f=p[0],b=p[1],v=Object(n.useCallback)((function(e){return function(){b(e),d(!0)}}),[]),g=Object(n.useCallback)((function(){return d(!1)}),[]);return r.a.createElement(r.a.Fragment,null,e.aggregation.sections.map((function(e,t){return r.a.createElement(fu,{key:t,label:"".concat(a("trips.modes.".concat(e.mode))," - ").concat(ya(e.duration)," - ").concat(va(e.distance)," - ").concat((n=e.avgSpeed,"".concat(Math.round(n)," km/h"))),endLabel:ha({f:o,lang:i,date:new Date(e.endDate)}),icon:ra(e.mode),onClick:v(e)});var n})),u&&r.a.createElement(du,{section:f,onClose:g}))},vu=r.a.memo(bu),gu=function(e){var t=e.purpose,a=e.onClick,n=Object(H.e)().t;return r.a.createElement(Jn.b,{button:!0,onClick:a},r.a.createElement(Xn.a,null,r.a.createElement(Mo,{attribute:t})),r.a.createElement($n.a,{primary:n("purpose"),primaryTypographyProps:{variant:"caption"},secondary:n("trips.purposes.".concat(t)),secondaryTypographyProps:{variant:"body1",color:"textPrimary"}}))};gu.defaultProps={purpose:P.ab};var yu=r.a.memo(gu),hu=a("JKPP"),Eu=a("UR0v"),Ou=function(e){var t=e.isRecurringTrip,a=e.purpose,n=e.onClick,o=Object(H.e)().t;return a===P.ab?null:r.a.createElement(Jn.b,{button:!0,onClick:n},r.a.createElement(Xn.a,null,r.a.createElement(Vn.a,{icon:Eu.a})),r.a.createElement($n.a,{primary:o("recurring.title"),primaryTypographyProps:{variant:"caption"},secondary:o("recurring.".concat(t?"recurringTrip":"occasionalTrip")),secondaryTypographyProps:{variant:"body1",color:"textPrimary"}}))},ju={divider:{margin:"-10px -32px 10px"}},Cu=function(){var e,t=Bl().timeserie,a=Object(ge.b)().isDesktop,o=Object(n.useState)(!1),i=s()(o,2),c=i[0],l=i[1],u=Object(n.useState)(!1),d=s()(u,2),m=d[0],p=d[1],f=qa(t),b=null==t||null===(e=t.aggregation)||void 0===e?void 0:e.recurring;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Vs.a,{disableGutters:!0,disableElevation:!0},r.a.createElement(hu.a,{className:"u-pb-0 u-mb-0"},r.a.createElement(nu,{type:"start"}),r.a.createElement(vu,null),r.a.createElement(nu,{type:"end"}))),a&&r.a.createElement(Qr.a,{style:ju.divider}),r.a.createElement(Vs.a,{disableGutters:!0,disableElevation:!0},r.a.createElement(Kn.a,{className:"u-pv-half"},r.a.createElement(yu,{purpose:f,onClick:function(){return l(!0)}}),c&&r.a.createElement(Us,{onClose:function(){return l(!1)}}),r.a.createElement(Qr.a,{variant:"inset",component:"li"}),r.a.createElement(Ou,{isRecurringTrip:b,purpose:f,onClick:function(){return p(!0)}}),m&&r.a.createElement(Ws,{onClose:function(){return p(!1)}}))))},xu=r.a.memo(Cu);function wu(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ku(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wu(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wu(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _u=function(e){var t=e.title,a=e.value,o=e.highlighted,i=Object(n.useMemo)((function(){return function(e){var t=e.highlighted;return{infoBlock:{backgroundColor:t?"var(--primaryColor)":"none",flex:"1 1 0"},typography:ku({},t&&{color:"var(--primaryContrastTextColor)"})}}({highlighted:o})}),[o]);return r.a.createElement("div",{style:i.infoBlock,className:"u-h-100 u-flex u-flex-column u-flex-items-center u-flex-justify-center u-ta-center u-bdrs-4"},r.a.createElement(tr.a,{style:i.typography,variant:"caption"},t),r.a.createElement(tr.a,{style:i.typography,variant:o?"h6":"body1"},a))},Du=r.a.memo(_u),Pu=function(){var e=Bl().timeserie,t=Object(H.e)().t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Du,{title:t("trips.duration"),value:en(e)}),r.a.createElement(Du,{title:t("trips.distance"),value:tn(e)}),r.a.createElement(Du,{title:t("trips.calories"),value:nn(e)}),r.a.createElement(Du,{title:t("trips.co2"),value:an(e),highlighted:!0}))},Tu=r.a.memo(Pu),Su=a("bOJc"),Mu=a("l149"),Au={mediumHeightRatio:.66},Nu=Object(yc.a)({mapContainer:{height:function(e){var t=e.toolbarHeight;return"calc(100vh - ".concat(t,"px - var(--sidebarHeight) - env(safe-area-inset-bottom))")}},bottomSheetHeader:{gap:"0.5rem"}}),Lu=function(e){var t=e.titleRef,a=Object(n.useState)(0),o=s()(a,2),i=o[0],c=o[1],l=Nu({toolbarHeight:i}),u=Object(n.useMemo)((function(){return{height:i}}),[i]);return Object(n.useEffect)((function(){null!=t&&t.current&&c(t.current.offsetHeight)}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"u-w-100 u-pos-fixed ".concat(l.mapContainer)},r.a.createElement(qu,null)),r.a.createElement(Ys.a,{settings:Au,toolbarProps:u},r.a.createElement(Mu.a,{className:"u-h-3 u-pb-half u-ph-half ".concat(l.bottomSheetHeader)},r.a.createElement(Tu,null)),r.a.createElement(xu,null)))},Ru=r.a.memo(Lu),Fu=a("CUq/"),Iu=a("8IOV"),Bu=a.n(Iu),Gu=function(){var e=Object(n.useRef)(),t=Object(ge.b)().isMobile,a=Object(To.a)(),o=Bl().timeserie,i=Object(Yl.a)(),c=Object(n.useMemo)((function(){return function(e){return{style:function(t){return{weight:"section"===t.properties.feature_type?5:2,color:e.palette.primary.main}},pointToLayer:function(e,t){return Fu.f.marker(t,{icon:Fu.f.divIcon({html:"<div></div>",iconSize:[12,12],className:"".concat(Bu.a["cozy-leaflet-markers"]," ").concat("end_place"===e.properties.feature_type?"".concat(Bu.a["cozy-leaflet-markers-end"]):"".concat(Bu.a["cozy-leaflet-markers-start"]))})})},markerIcon:function(e,t){return Fu.f.marker(e,{icon:Fu.f.divIcon({html:"".concat(t())})})}}}(a)}),[a]),l=c.pointToLayer,s=c.style,u=Object(n.useMemo)((function(){return t?Au.mediumHeightRatio:0}),[t]);return Object(n.useEffect)((function(){var t=e.current.getBounds(),a=[16,16],n=[16,16+i.getSize().y*u];i.fitBounds(t,{paddingTopLeft:a,paddingBottomRight:n})}),[i,u]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Vl.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),r.a.createElement(Su.a,{ref:e,data:Xa(o),pointToLayer:l,style:s}))},zu=[51.505,-.09],qu=function(){return r.a.createElement(Kl.a,{className:"u-h-100",center:zu,zoom:13},r.a.createElement(Gu,null))},Zu={map:{height:"400px",margin:"-24px -32px 0"},divider:{margin:"10px -32px 25px"},bottomSheetHeader:{gap:"0.5rem"}},Uu=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:Zu.map},r.a.createElement(qu,null)),r.a.createElement("div",{style:Zu.bottomSheetHeader,className:"u-mt-1 u-h-3 u-flex u-flex-items-center u-pb-half"},r.a.createElement(Tu,null)),r.a.createElement(Qr.a,{style:Zu.divider}),r.a.createElement(xu,null))},Qu=function(){var e=Object(H.e)().f,t=Object(ge.c)().isMobile,a=Object(Ce.i)().timeserieId,o=Bl().timeserie,i=Object(Ce.g)().pathname,c=Object(Ce.h)(),l=Object(n.useRef)(null);return r.a.createElement(rr.a,{open:!0,size:t?void 0:"large",transitionDuration:t?0:void 0,disableGutters:t,title:r.a.createElement(r.a.Fragment,null,$a(o,t)||Va(o),r.a.createElement(tr.a,{className:"u-mt-half",variant:"caption",align:t?"center":void 0},rn(o,e))),titleRef:l,content:t?r.a.createElement(Ru,{titleRef:l}):r.a.createElement(Uu,null),onClose:function(){return c(i.split("/".concat(a))[0])}})},Hu=r.a.memo(Qu),Yu=["data"],Vu=function(){var e=Object(Ce.g)().pathname,t=function(e){return{definition:Object(g.Q)(m.g).getById(e).include(["startPlaceContact","endPlaceContact"]),options:{as:"".concat(m.g,"/").concat(e),fetchPolicy:y.a.fetchPolicies.olderThan(3e4),singleDocData:!0}}}(Object(n.useMemo)((function(){return e.split("/").pop()}),[e])),a=Object(g.useQuery)(t.definition,t.options),o=a.data,i=c()(a,Yu);return Object(g.isQueryLoading)(i)?r.a.createElement(or.b,{size:"xxlarge",className:"u-flex u-flex-justify-center u-mt-1"}):r.a.createElement(zl,{timeserie:o},r.a.createElement(Ps,null,r.a.createElement(Hu,null)))},Wu=r.a.memo(Vu),Ku=a("PKog"),Ju={minHeight:"48px",display:"flex",alignItems:"center"},Xu=function(){var e=Object(H.e)().t,t=Object(To.a)();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Qr.a,null),r.a.createElement(er.a,{style:Ju,className:"u-ph-1-s u-ph-2",square:!0,elevation:0},r.a.createElement(Vn.a,{className:"u-mr-half",icon:Br.a,color:"var(--primaryColor)",size:8}),r.a.createElement(tr.a,{className:"u-mr-1",display:"inline",variant:"caption",color:"textPrimary"},e("vericalBarChart.legend.yours")),r.a.createElement(Vn.a,{className:"u-mr-half",icon:Br.a,color:Object(Ku.a)(t.palette.primary.main,.24),size:8}),r.a.createElement(tr.a,{display:"inline",variant:"caption",color:"textPrimary"},e("vericalBarChart.legend.average"))))},$u=a("HO4k"),ed=a("DmLS");$u.f.register($u.e,$u.i,$u.c,$u.n),$u.f.defaults.font={family:"Lato, sans-serif",size:"11",weight:"700"};var td=function(e){var t=e.className,a=e.title,n=e.data,o=e.options,i=e.width,c=e.height,l=e.children;return r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{className:"u-mt-1 u-ml-1",variant:"h5"},a),r.a.createElement("div",{style:{width:i,height:c}},r.a.createElement(ed.a,{className:t,width:i,height:c,options:o,data:n})),l)},ad=function(e){var t=e.theme,a=e.isMobile,n=e.oneYearOldTimeseries,r=e.sendToDACC,o=e.globalAverages,i=e.f,c=e.t,l=function(e,t){var a=new Date,n=Array.from({length:12},(function(e,t){return Object(k.a)(Object(Ye.a)(a,t))})).reverse();return{months:n.map((function(e){return t(e,"MMM").toUpperCase()})),CO2s:n.map((function(t,a){var r=a===n.length-1,o=e.filter((function(e){return new Date(e.startDate)>=t&&(!!r||new Date(e.startDate)<n[a+1])})),i=ct()(o,"aggregation.totalCO2");return Math.round(100*i)/100}))}}(n,i),s=l.months,u=l.CO2s,d={labels:s,datasets:[{label:c("vericalBarChart.legend.yours"),backgroundColor:t.palette.primary.main,borderRadius:a?8:4,barThickness:a?r?6:8:24,data:u}]};return r&&d.datasets.push({label:c("vericalBarChart.legend.average"),backgroundColor:Object(Ku.a)(t.palette.primary.main,.24),borderRadius:a?8:4,barPercentage:a?.55:.85,data:K()("coachco2.fake-dacc-datas.enabled")?u:o}),d};a("NhwE"),a("8tKC");g.models.dacc.sendMeasureToDACC;var nd=function(){return!0===K()("coachco2.dacc-dev_v2")?m.e:m.d};var rd=g.models.dacc.fetchAggregatesFromDACC,od=function(){var e=O()(C.a.mark((function e(t){var a,n,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=nd(),n=Object(cl.a)(Object(k.a)(Object(Ye.a)(Date.now(),11)),"yyyy-MM-dd"),e.next=5,rd(t,a,{measureName:P.B,startDate:n});case 5:return r=e.sent,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),Mt()("error","Error while retrieving data from remote-doctype: ".concat(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),id=function(e){var t=Object(g.useClient)(),a=Object(n.useState)(!1),r=s()(a,2),o=r[0],i=r[1],c=Object(n.useState)(null),l=s()(c,2),u=l[0],d=l[1];return Object(n.useEffect)((function(){e&&function(){var e=O()(C.a.mark((function e(){var a,n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,od(t);case 3:a=e.sent,n=(null==a?void 0:a.length)>0?a.map((function(e){return e.avg})):null,i(!1),d(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,e]),{isLoading:o,data:u}},cd=["data"];function ld(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function sd(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ld(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ld(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ud=function(){var e,t,a=Object(H.e)(),n=a.t,o=a.f,i=Object(To.a)(),l=Object(ge.b)().isMobile,s=G().account,u=ho("CO2Emission.sendToDACC"),d=u.isLoading,p=u.value,f=void 0!==p&&p,b=(e=null==s?void 0:s._id,t=Object(k.a)(Object(D.a)(new Date,1)),{definition:Object(g.Q)(m.g).where({"cozyMetadata.sourceAccount":e,startDate:{$gte:t.toISOString()}}).partialIndex({aggregation:{$exists:!0}}).select(["startDate","endDate","aggregation","cozyMetadata.sourceAccount"]).indexFields(["cozyMetadata.sourceAccount","startDate"]).sortBy([{"cozyMetadata.sourceAccount":"asc"},{startDate:"asc"}]).limitBy(1e3),options:{as:"".concat(m.g,"/sourceAccount/").concat(e,"/withAggregation/fromDate/").concat(t.getFullYear(),"-").concat(t.getMonth()),fetchPolicy:y.a.fetchPolicies.olderThan(3e4)}}),v=Object(g.useQueryAll)(b.definition,sd(sd({},b.options),{},{enabled:Boolean(s)})),h=v.data,E=c()(v,cd),O=id(f).data;if(!s||Object(g.isQueryLoading)(E)||E.hasMore||0===h.length)return null;var j=!d&&f,C=function(e){return{maintainAspectRatio:!1,scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{color:e.palette.text.secondary}},y:{grid:{color:e.palette.border.main,drawBorder:!1},ticks:{color:e.palette.text.secondary,callback:function(e,t){return t%2==0?"".concat(e," kg"):""}}}},plugins:{tooltip:{displayColors:!1}}}}(i),x=ad({theme:i,isMobile:l,oneYearOldTimeseries:h,sendToDACC:f,globalAverages:O,f:o,t:n});return r.a.createElement(td,{className:"u-mt-1 u-ph-half-s u-ph-2",title:n("vericalBarChart.title"),height:"190px",data:x,options:C},j&&r.a.createElement(Xu,null))},dd=a("33AU"),md=a("N0Ji"),pd=function(e){var t=e.onDiscard,a=e.onAccept,n=Object(H.e)().t;return r.a.createElement(dd.a,{className:"u-mh-half-s u-mh-2 u-mb-half-s u-mb-1 u-mt-0-s u-mt-1 u-bdrs-4 u-pv-half u-pr-half",text:n("dacc.tripsCard.label"),icon:r.a.createElement(Vn.a,{className:"u-ml-1",style:{marginTop:12,color:"var(--primaryColor)"},icon:md.a,size:16}),buttonOne:r.a.createElement(U.a,{variant:"text",label:n("dacc.tripsCard.discard"),onClick:t}),buttonTwo:r.a.createElement(U.a,{variant:"text",label:n("dacc.tripsCard.accept"),onClick:a}),bgcolor:"#EAF3FF",disableIconStyles:!0})};pd.propTypes={onDiscard:qe.a.func.isRequired,onAccept:qe.a.func.isRequired};var fd=pd,bd=new sr.a({id:"dacc-compare_095afa7eb600270496978dbb605e6b2d",use:"dacc-compare_095afa7eb600270496978dbb605e6b2d-usage",viewBox:"0 0 200 136",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 136" id="dacc-compare_095afa7eb600270496978dbb605e6b2d"><path fill="#fff" d="M0 0h200v136H0z" /><path d="M161 14.592c-1.888.222-7.568-.664-15.182-5.982-9.518-6.647-13.847-8.724-22.434-4.183C115 8.86 115.227 23.012 115 27M165.844 92c5.431-3.51 16.097-12.334 15.315-19.554-.977-9.025-12.708-11.282-22.81-10.78-10.101.501-17.596 4.512-28.349 1.504M23.495 72c-.329 4.729-2.425 21.765 5.479 27.308 9.88 6.928 23.668-1.244 30.831-5.203C66.97 90.146 79.072 83.217 85 85.527" stroke="#B2D3FF" stroke-width="4" stroke-linecap="round" /><path fill-rule="evenodd" clip-rule="evenodd" d="M62 118a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm.968-10.899c1.777.371 3.182 1.857 3.472 3.649a4.507 4.507 0 0 1-2.828 4.953l-.112.039V117h-3v-2.5a1.5 1.5 0 0 1 1.356-1.493L62 113a1.5 1.5 0 1 0-1.493-1.645l-.007.145h-3a4.506 4.506 0 0 1 5.468-4.399Z" fill="#38D1D3" /><circle cx="100" cy="64" fill="#297EF2" r="48" /><path fill-rule="evenodd" clip-rule="evenodd" d="M120.91 37.605a2.166 2.166 0 0 1 .235 3.055l-13 15.167a2.166 2.166 0 0 1-2.33.645L93.96 52.52 81.887 62.581a2.167 2.167 0 0 1-2.774-3.329l13-10.833a2.167 2.167 0 0 1 2.072-.391l11.618 3.873 12.052-14.061a2.166 2.166 0 0 1 3.055-.235Z" fill="#38D1D3" /><path fill-rule="evenodd" clip-rule="evenodd" d="M119.5 42.5a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5Zm-26 10.833a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5Zm-13 10.834a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5Zm29.25-9.75a3.25 3.25 0 1 1-6.5 0 3.25 3.25 0 0 1 6.5 0ZM117.167 53.333a2 2 0 0 0-2 2V86a2 2 0 0 0 2 2h4.666a2 2 0 0 0 2-2V55.333a2 2 0 0 0-2-2h-4.666Zm-26 10.834a2 2 0 0 0-2 2V86a2 2 0 0 0 2 2h4.666a2 2 0 0 0 2-2V66.167a2 2 0 0 0-2-2h-4.666ZM78.167 75a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h4.666a2 2 0 0 0 2-2v-9a2 2 0 0 0-2-2h-4.666Zm24-4.5a2 2 0 0 1 2-2h4.666a2 2 0 0 1 2 2V86a2 2 0 0 1-2 2h-4.666a2 2 0 0 1-2-2V70.5Z" fill="#fff" /><path fill-rule="evenodd" clip-rule="evenodd" d="M43 21a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5Zm1.452-16.349c2.666.557 4.773 2.786 5.208 5.474a6.76 6.76 0 0 1-4.242 7.43l-.168.058V19.5h-4.5v-3.75c0-1.17.893-2.13 2.034-2.24L43 13.5a2.25 2.25 0 1 0-2.24-2.468l-.01.218h-4.5a6.758 6.758 0 0 1 8.202-6.599Z" fill="#72E7E9" /><path fill-rule="evenodd" clip-rule="evenodd" d="M69 19a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.249 2.249 0 0 1 1.736 1.825 2.253 2.253 0 0 1-1.414 2.476l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L69 16.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5c0-1.4 1.28-2.503 2.734-2.2Z" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M46 42a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.249 2.249 0 0 1 1.736 1.825 2.253 2.253 0 0 1-1.414 2.476l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L46 39.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5c0-1.4 1.28-2.503 2.734-2.2ZM20 14a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.249 2.249 0 0 1 1.736 1.825 2.253 2.253 0 0 1-1.414 2.476l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L20 11.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5c0-1.4 1.28-2.503 2.734-2.2Z" fill="#D3FEFF" /><path fill-rule="evenodd" clip-rule="evenodd" d="M26 33a1.125 1.125 0 1 1 0 2.25A1.125 1.125 0 0 1 26 33Zm.726-8.174c1.333.278 2.387 1.392 2.604 2.736a3.38 3.38 0 0 1-2.12 3.715l-.085.03v.943h-2.25v-1.875c0-.584.447-1.065 1.017-1.12L26 29.25a1.125 1.125 0 1 0-1.12-1.234l-.005.109h-2.25a3.38 3.38 0 0 1 4.101-3.3Z" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M39 116.5a.938.938 0 1 1 0 1.876.938.938 0 0 1 0-1.876Zm.605-6.812a2.811 2.811 0 0 1 2.17 2.281 2.816 2.816 0 0 1-1.767 3.095l-.07.025v.786h-1.875v-1.563c0-.487.372-.887.847-.933l.09-.004a.937.937 0 1 0-.933-1.028l-.004.09h-1.875c0-1.75 1.6-3.128 3.417-2.749Z" fill="#9EEEF0" /><path fill-rule="evenodd" clip-rule="evenodd" d="M46 90a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.249 2.249 0 0 1 1.736 1.825 2.253 2.253 0 0 1-1.414 2.476l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L46 87.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5c0-1.4 1.28-2.503 2.734-2.2Z" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M184 99a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm.968-10.9c1.777.372 3.182 1.858 3.472 3.65a4.507 4.507 0 0 1-2.828 4.953l-.112.039V98h-3v-2.5a1.5 1.5 0 0 1 1.356-1.493L184 94a1.5 1.5 0 1 0-1.493-1.645l-.007.145h-3a4.506 4.506 0 0 1 5.468-4.4Z" fill="#9EEEF0" /><path fill-rule="evenodd" clip-rule="evenodd" d="M191 64a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25Zm.726-8.174c1.333.278 2.387 1.392 2.604 2.736a3.38 3.38 0 0 1-2.121 3.715l-.084.03v.943h-2.25v-1.875c0-.584.447-1.065 1.017-1.12l.108-.005a1.125 1.125 0 1 0-1.12-1.234l-.005.109h-2.25a3.38 3.38 0 0 1 4.101-3.3Z" fill="#D3FEFF" /><path fill-rule="evenodd" clip-rule="evenodd" d="M134 18a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25Zm.726-8.174c1.333.278 2.387 1.392 2.604 2.736a3.38 3.38 0 0 1-2.121 3.715l-.084.03v.943h-2.25v-1.875c0-.585.447-1.065 1.017-1.12l.108-.005a1.125 1.125 0 1 0-1.12-1.234l-.005.109h-2.25a3.38 3.38 0 0 1 4.101-3.3Z" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M118 119a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.252 2.252 0 0 1 .322 4.301l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747l.072-.003a.75.75 0 1 0-.746-.823l-.004.073h-1.5a2.253 2.253 0 0 1 2.734-2.2ZM153 55a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.253 2.253 0 0 1 .322 4.301l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L153 52.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5c0-1.4 1.28-2.503 2.734-2.2Z" fill="#D3FEFF" /><path fill-rule="evenodd" clip-rule="evenodd" d="M81 118a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.25 2.25 0 0 1 .322 4.301l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L81 115.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5a2.253 2.253 0 0 1 2.734-2.2Z" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M177 124a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.252 2.252 0 0 1 .322 4.301l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747l.072-.003a.75.75 0 1 0-.746-.823l-.004.073h-1.5a2.253 2.253 0 0 1 2.734-2.2Z" fill="#D3FEFF" /><path fill-rule="evenodd" clip-rule="evenodd" d="M164 75a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Zm.484-5.45a2.253 2.253 0 0 1 .322 4.301l-.056.02v.629h-1.5v-1.25c0-.39.298-.71.678-.747L164 72.5a.75.75 0 1 0-.746-.823l-.004.073h-1.5c0-1.4 1.28-2.503 2.734-2.2Z" fill="#38D1D3" /><path fill-rule="evenodd" clip-rule="evenodd" d="M92 8.5a.937.937 0 1 1 0 1.875.937.937 0 0 1 0-1.875Zm.605-6.812a2.81 2.81 0 0 1 2.17 2.28 2.817 2.817 0 0 1-1.767 3.096l-.07.025v.786h-1.875V6.312c0-.487.372-.887.847-.933l.09-.004a.937.937 0 1 0-.933-1.028l-.004.09h-1.875c0-1.75 1.6-3.128 3.417-2.749Z" fill="#72E7E9" /><circle cx="148" cy="104" r="24" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M148 106c-4.418 0-8-4.029-8-9 0-4.97 3.582-9 8-9s8 4.03 8 9c0 4.971-3.582 9-8 9Zm-16 10c0-2 4-8 8-8s2 2 8 2 4-2 8-2 8 6 8 8 0 4-2 4h-28c-2 0-2-2-2-4Z" fill="#38D1D3" /><path fill-rule="evenodd" clip-rule="evenodd" d="M148 101a1.5 1.5 0 1 1-.001 3.001A1.5 1.5 0 0 1 148 101Zm.968-10.9c1.777.372 3.182 1.858 3.472 3.65a4.507 4.507 0 0 1-2.828 4.953l-.112.039V100h-3v-2.5a1.5 1.5 0 0 1 1.356-1.493L148 96a1.5 1.5 0 1 0-1.493-1.645l-.007.145h-3a4.506 4.506 0 0 1 5.468-4.4Z" fill="#fff" /><circle cx="148" cy="104" r="20" stroke="#B9F6F7" stroke-width="8" /><circle cx="24" cy="65" r="24" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M24 67c-4.418 0-8-4.03-8-9s3.582-9 8-9 8 4.03 8 9-3.582 9-8 9ZM8 77c0-2 4-8 8-8s2 2 8 2 4-2 8-2 8 6 8 8 0 4-2 4H10c-2 0-2-2-2-4Z" fill="#38D1D3" /><path fill-rule="evenodd" clip-rule="evenodd" d="M24 62a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm.968-10.9c1.777.372 3.182 1.858 3.472 3.65a4.507 4.507 0 0 1-2.828 4.953l-.112.039V61h-3v-2.5a1.5 1.5 0 0 1 1.356-1.493L24 57a1.5 1.5 0 1 0-1.493-1.645l-.007.145h-3a4.506 4.506 0 0 1 5.468-4.4Z" fill="#fff" /><circle cx="24" cy="65" r="20" stroke="#B9F6F7" stroke-width="8" /><circle cx="172" cy="28" r="24" fill="#B9F6F7" /><path fill-rule="evenodd" clip-rule="evenodd" d="M172 30c-4.418 0-8-4.03-8-9s3.582-9 8-9 8 4.03 8 9-3.582 9-8 9Zm-16 10c0-2 4-8 8-8s2 2 8 2 4-2 8-2 8 6 8 8 0 4-2 4h-28c-2 0-2-2-2-4Z" fill="#38D1D3" /><path fill-rule="evenodd" clip-rule="evenodd" d="M172 25a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm.968-10.9c1.777.372 3.182 1.858 3.472 3.65a4.507 4.507 0 0 1-2.828 4.953l-.112.039V24h-3v-2.5a1.5 1.5 0 0 1 1.356-1.493L172 20a1.5 1.5 0 1 0-1.493-1.645l-.007.145h-3a4.506 4.506 0 0 1 5.468-4.4Z" fill="#fff" /><circle cx="172" cy="28" r="20" stroke="#B9F6F7" stroke-width="8" /><path d="M66.418 133.29a81.818 81.818 0 0 0 16.142 2.244c16.166.948 38.758.424 48.325-1.346 9.567-1.771 10.083-4.465-14.448-5.812-20.925-1.147-45.26.474-50.362 2.894-1.52.648-1.447 1.371.343 2.02Z" fill="#BBD9FD" /></symbol>'}),vd=(dr.a.add(bd),bd),gd=function(e){var t=e.open,a=e.onClose,n=e.showDaccPermissionsDialog,o=Object(H.e)().t;return r.a.createElement(Q.a,{open:t,onClose:a,content:r.a.createElement("div",{className:"u-ta-center"},r.a.createElement(Vn.a,{className:"u-mv-1",icon:vd,width:200,height:136}),r.a.createElement(tr.a,{variant:"h3"},o("dacc.compareDialog.title")),r.a.createElement(tr.a,{className:"u-mt-1"},o("dacc.compareDialog.primaryText")),r.a.createElement(tr.a,{className:"u-mt-1"},o("dacc.compareDialog.secondaryText"))),actions:r.a.createElement(U.a,{label:o("dacc.compareDialog.action"),onClick:n})})};gd.propTypes={open:qe.a.bool.isRequired,onClose:qe.a.func.isRequired,showDaccPermissionsDialog:qe.a.func.isRequired};var yd=gd;function hd(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ed(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?hd(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):hd(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Od=function(){var e=Object(H.e)().t,t=Object(n.useState)(!1),a=s()(t,2),o=a[0],i=a[1],c=Object(n.useState)(!1),l=s()(c,2),u=l[0],d=l[1],m=ho("CO2Emission"),p=m.isLoading,f=m.value,b=void 0===f?{}:f,v=m.save;if(p)return null;var g=b.showAlert,y=void 0===g||g,h=b.sendToDACC,E=void 0!==h&&h;return r.a.createElement(r.a.Fragment,null,y&&!E&&r.a.createElement(fd,{onDiscard:function(){v(Ed(Ed({},b),{},{showAlert:!1}))},onAccept:function(){return i(!0)}}),r.a.createElement(yd,{open:o,onClose:function(){return i(!1)},showDaccPermissionsDialog:function(){i(!1),d(!0)}}),u&&r.a.createElement(Oi,{onClose:function(){return d(!1)},onRefuse:function(){return d(!1)},onAccept:function(){v(Ed(Ed({},b),{},{showAlert:!1,sendToDACC:!0})),d(!1)},componentProps:{DaccPermissionsDialog:{sharedDataLabel:e("dacc.permissionsDialog.anonymized_emissions")}}}))};Od.propTypes={};var jd=Od,Cd=a("IJzH"),xd=function(e){var t=e.onDiscard,a=e.onParticipate,n=Object(H.e)().t;return r.a.createElement(ql.a,{className:"u-mh-1-s u-mh-2 u-mb-1 u-flex-items-start",block:!0,icon:r.a.createElement(Vn.a,{icon:md.a}),action:r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{variant:"text",label:n("bikeGoal.alert.actions.discard"),onClick:t}),r.a.createElement(U.a,{variant:"text",label:n("bikeGoal.alert.actions.participate"),onClick:a}))},r.a.createElement(Cd.a,null,n("bikeGoal.alert.title")),n("bikeGoal.alert.text"))};xd.propTypes={onDiscard:qe.a.func,onParticipate:qe.a.func};var wd=xd,kd=function(){var e=Object(Ce.h)(),t=ho("bikeGoal.showAlert"),a=t.isLoading,n=t.value,o=void 0===n||n,i=t.save;return a||o?r.a.createElement(wd,{onParticipate:function(){e("bikegoalonboarding")},onDiscard:function(){i(!1)}}):null},_d=function(){var e=Object(H.e)().t,t=Object(Ce.h)(),a=ho("bikeGoal.showAlertSuccess").save;return r.a.createElement(ql.a,{className:"u-mh-1-s u-mh-2 u-mb-1 u-flex-items-start",block:!0,severity:"success",action:r.a.createElement(U.a,{variant:"text",color:"success",label:e("bikeGoal.alert.success.action",{bountyAmount:bn()}),onClick:function(){a(!1);var e=(new Date).getFullYear().toString();t("".concat(e,"/certificate/generate"))}})},e("bikeGoal.alert.success.text"))},Dd=["data"],Pd=["data"],Td={paper:{gap:"1rem"},div:{height:65}},Sd=function(){var e,t=Object(H.e)().t,a=Object(Ce.h)(),n=G(),o=n.account,i=n.isAccountLoading,l=R(),s=Object(g.useQuery)(l.definition,l.options),u=s.data,d=c()(s,Dd),m=Object(g.isQueryLoading)(d),p=N({accountId:null==o?void 0:o._id},Boolean(o)),f=Object(g.useQueryAll)(p.definition,p.options),b=f.data,v=c()(f,Pd),y=Object(g.isQueryLoading)(v)||v.hasMore;if(i||y||m)return r.a.createElement(er.a,{elevation:2,className:"u-flex u-flex-items-center u-mh-1-s u-mh-2 u-mb-1 u-flex-items-start"},r.a.createElement(or.b,{size:"xlarge",className:"u-m-1"}));var h=(new Date).getFullYear().toString(),E=dn(b,h),O=!(null==u||null===(e=u[0].bikeGoal)||void 0===e||!e.sendToDACC);return r.a.createElement(r.a.Fragment,null,r.a.createElement(er.a,{elevation:2,className:"u-flex u-flex-items-start-s u-flex-items-center u-mh-1-s u-mh-2 u-mb-1 u-p-1 u-c-pointer",style:Td.paper,onClick:function(){return a("/bikegoal/".concat(h,"/trips"))}},r.a.createElement("div",{style:Td.div},r.a.createElement(xn,{timeseries:E,sendToDACC:O,size:"small"})),r.a.createElement("div",null,r.a.createElement(tr.a,{variant:"h6"},t("bikeGoal.title")),O?r.a.createElement(Vr,{timeseries:E}):r.a.createElement(Jr,{timeseriesByYear:E,variant:"caption",preLine:!0}))))},Md=["data"],Ad=["data"],Nd={divider:{height:"12px",backgroundColor:"var(--defaultBackgroundColor)"}},Ld=function(){var e,t,a=Object(H.e)().t,n=Object(ge.b)().isMobile,o=G(),i=o.account,l=o.isAccountLoading,s=R(),u=Object(g.useQuery)(s.definition,s.options),d=u.data,m=c()(u,Md),p=N({accountId:null==i?void 0:i._id},Boolean(i)),f=Object(g.useQueryAll)(p.definition,p.options),b=f.data,v=c()(f,Ad),y=Object(g.isQueryLoading)(v)||v.hasMore;if(Object(g.isQueryLoading)(m)||(l||y))return null;var h=(new Date).getFullYear().toString(),E=dn(b,h),O=null!==(e=null==d||null===(t=d[0])||void 0===t?void 0:t.bikeGoal)&&void 0!==e?e:{},j=O.activated,C=void 0!==j&&j,x=O.showAlert,w=void 0===x||x,k=O.showAlertSuccess,_=void 0===k?gn(E,d):k;return C||w?r.a.createElement(r.a.Fragment,null,r.a.createElement(tr.a,{className:"u-mb-1-s u-mt-1 u-mb-1-s u-mb-2 u-ml-1",variant:"h5"},a("bikeGoal.goals")),w&&r.a.createElement(kd,null),C&&r.a.createElement(r.a.Fragment,null,_&&r.a.createElement(_d,null),r.a.createElement(Sd,null)),n&&r.a.createElement(Qr.a,{style:Nd.divider})):null},Rd=["data"];function Fd(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Id(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fd(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fd(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Bd={divider:{height:"12px",backgroundColor:"var(--defaultBackgroundColor)"}},Gd=function(){var e=G(),t=e.account,a=e.accounts,n=e.isAccountLoading,o=Object(H.e)().t,i=Object(ge.b)().isMobile,l=M({accountId:null==t?void 0:t._id,limitBy:50}),s=Object(g.useQuery)(l.definition,Id(Id({},l.options),{},{enabled:Boolean(t)})),u=s.data,d=c()(s,Rd),m=Object(g.isQueryLoading)(d)&&!Object(g.hasQueryBeenLoaded)(d);return n||!t||m||0===u.length?r.a.createElement(Ir,{account:t,accounts:a,isAccountLoading:n,isTimeseriesLoading:m,timeseries:u}):r.a.createElement(r.a.Fragment,null,r.a.createElement(Er,{label:o("trips.from")+" "+z(t)}),K()("coachco2.bikegoal.enabled")&&r.a.createElement(Ld,null),r.a.createElement(ud,null),r.a.createElement(jd,null),i&&r.a.createElement(Qr.a,{style:Bd.divider}),r.a.createElement(qo,{timeseries:u}),d.hasMore&&r.a.createElement(Zo.a,{label:o("loadMore"),fetchMore:d.fetchMore}))},zd=a("mJLf"),qd=(a("cRRo"),a("R34t")),Zd=a("Qy9h"),Ud=a("BkYy"),Qd=a("hXCt"),Hd=a("yKoJ"),Yd=a("pJCX"),Vd=function(){var e=Object(Ce.i)().fileId,t=Object(Ce.h)(),a=Object(g.useClient)(),n=function(e){return{definition:function(){return Object(g.Q)(m.f).getById(e)},options:{as:"".concat(m.f,"/").concat(e),fetchPolicy:y.a.fetchPolicies.olderThan(1e8)}}}(null!=e?e:null),o=Object(g.useQuery)(n.definition,n.options);return Object(g.hasQueryBeenLoaded)(o)?r.a.createElement(zd.a,{client:a,doctype:m.f,documentType:"Files"},r.a.createElement(Ud.a,{files:o.data,currentIndex:0,onCloseRequest:function(){return t("..")}},r.a.createElement(Qd.a,null,r.a.createElement(Yd.a,null),r.a.createElement(Hd.a,null)))):r.a.createElement(Zd.a,{open:!0},r.a.createElement(qd.a,{open:!0},r.a.createElement(or.b,{size:"xxlarge",middle:!0,noMargin:!0,color:"var(--primaryContrastTextColor)"})))},Wd=function(e){var t=e.Component;return r.a.createElement(r.a.Fragment,null,r.a.createElement(t,null),r.a.createElement(Ce.b,null))},Kd=function(){var e=(new Date).getFullYear();return r.a.createElement(xe.a,null,r.a.createElement(Ce.e,null,r.a.createElement(Ce.c,{path:"/",element:r.a.createElement(Re,null)},r.a.createElement(Ce.c,{path:"trips",element:r.a.createElement(Wd,{Component:Gd})},r.a.createElement(Ce.c,{path:"certificate/:fileId",element:r.a.createElement(Vd,null)}),r.a.createElement(Ce.c,{path:":year/certificate/generate",element:r.a.createElement(cr,null)}),r.a.createElement(Ce.c,{path:":timeserieId",element:r.a.createElement(Wu,null)}),K()("coachco2.bikegoal.enabled")&&r.a.createElement(Ce.c,{path:"bikegoalonboarding",element:r.a.createElement(ac,null)})),r.a.createElement(Ce.c,{path:"settings",element:r.a.createElement(Wd,{Component:Ll})},K()("coachco2.bikegoal.enabled")&&r.a.createElement(Ce.c,{path:"bikegoalonboarding",element:r.a.createElement(ac,null)})),r.a.createElement(Ce.c,{path:"analysis/modes",element:r.a.createElement(Wd,{Component:Hc})}),r.a.createElement(Ce.c,{path:"analysis/modes/:mode",element:r.a.createElement(Wd,{Component:Hc})},r.a.createElement(Ce.c,{path:":timeserieId",element:r.a.createElement(Wu,null)})),r.a.createElement(Ce.c,{path:"analysis/purposes",element:r.a.createElement(Wd,{Component:Kc})}),r.a.createElement(Ce.c,{path:"analysis/purposes/:purpose",element:r.a.createElement(Wd,{Component:Kc})},r.a.createElement(Ce.c,{path:":timeserieId",element:r.a.createElement(Wu,null)})),K()("coachco2.bikegoal.enabled")&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce.c,{path:"bikegoal/:year/trips",element:r.a.createElement(Wd,{Component:Xo})},r.a.createElement(Ce.c,{path:"certificate/:fileId",element:r.a.createElement(Vd,null)}),r.a.createElement(Ce.c,{path:":timeserieId",element:r.a.createElement(Wu,null)}),r.a.createElement(Ce.c,{path:"edit",element:r.a.createElement(si,null)}),r.a.createElement(Ce.c,{path:"about",element:r.a.createElement($o,null)}),r.a.createElement(Ce.c,{path:"certificate/generate",element:r.a.createElement(cr,null)}))),r.a.createElement(Ce.c,{path:"analysis",element:r.a.createElement(Ce.a,{replace:!0,to:"/analysis/modes"})}),K()("coachco2.bikegoal.enabled")&&r.a.createElement(Ce.c,{path:"bikegoal",element:r.a.createElement(Ce.a,{replace:!0,to:"/bikegoal/".concat(e,"/trips")})}),r.a.createElement(Ce.c,{path:"/",element:r.a.createElement(Ce.a,{replace:!0,to:"/trips"})}),r.a.createElement(Ce.c,{path:"*",element:r.a.createElement(Ce.a,{replace:!0,to:"/trips"})}))))},Jd=a("8Bbg"),Xd=function(e,t){return/^\{\{\..*\}\}$/.test(e)?t:e},$d=function(e){var t=e.app,n=e.locale,r={appIconDefault:a("J3iu"),appNamePrefixDefault:tl.a.name_prefix,appNameDefault:tl.a.name,appLocaleDefault:"en"};return{appName:Xd(t.name,r.appNameDefault),appNamePrefix:Xd(t.prefix,r.appNamePrefixDefault),iconPath:Xd(t.icon,r.appIconDefault),lang:Xd(n,r.appLocaleDefault)}},em=a("+s1f"),tm=a("8XZk"),am=xa()((function(){var e,t,n,r,o=document.querySelector("[role=application]"),i=$d(JSON.parse(o.dataset.cozy)),c=i.lang,l=i.appName,s=Object(tm.a)(c,(function(e){return a("eUFy")("./".concat(e))})),u=(e=document.querySelector("[role=application]"),t=JSON.parse(e.dataset.cozy),n=window.location.protocol,r="".concat(n,"//").concat(t.domain),new y.a({uri:r,token:t.token,appMetadata:{slug:tl.a.name,version:tl.a.version},schema:m.k,store:!1}));return u.registerPlugin(K.a.plugin),u.registerPlugin(em.RealtimePlugin),function(e){var t=e.client,a=e.container,n=e.lang,r=e.appName,o=$d(JSON.parse(a.dataset.cozy)),i=o.appNamePrefix,c=o.iconPath;cozy.bar.init({appName:r,appNamePrefix:i,cozyClient:t,iconPath:c,lang:n,replaceTitleOnMobile:!1})}({client:u,container:o,lang:c,appName:l}),{container:o,client:u,lang:c,polyglot:s}}));Object(Jd.a)(),document.addEventListener("DOMContentLoaded",(function(){var e,t,a,n,i;e=am(),t=e.container,a=e.client,n=e.lang,i=e.polyglot,Object(o.createRoot)(t).render(r.a.createElement(je,{client:a,lang:n,polyglot:i},r.a.createElement(Kd,null)))}))},"v5t+":function(e,t,a){e.exports=a.p+"PlusJakartaSans.ttf"},vVt6:function(e,t,a){e.exports=a.p+"Lato.ttf"}});